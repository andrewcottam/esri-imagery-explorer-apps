"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[4274],{74274:function(e,t,n){n.d(t,{EG:function(){return d},Ll:function(){return T},R3:function(){return $},UH:function(){return a},aM:function(){return h},fs:function(){return m},i0:function(){return w}});var r=n(50189),i=n(46227),o=(n(6183),n(68717)),s=n(82506),u=n(23375);const a=",",f={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},c=new Set(["integer","small-integer"]);let l=null;function m(e){return(0,i.vE)(e)||(0,i.zD)(e)||(0,i.Ah)(e)}async function d(e){const{field:t,field2:n,field3:r,normalizationField:i,valueExpression:s}=e;let u=[];if(s){if(!l){const{arcadeUtils:e}=await(0,o.l)();l=e}u=l.extractFieldNames(s)}return t&&u.push(t),n&&u.push(n),r&&u.push(r),i&&u.push(i),u}function p(e){return String(e).padStart(2,"0")}function g(e,t,n){let r;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),r=`TIMESTAMP'${n?e.getFullYear():e.getUTCFullYear()}-${p((n?e.getMonth():e.getUTCMonth())+1)}-${p(n?e.getDate():e.getUTCDate())} ${p(n?e.getHours():e.getUTCHours())}:${p(n?e.getMinutes():e.getUTCMinutes())}:${p(n?e.getSeconds():e.getUTCSeconds())}'`):r=e,r}function h(e,t,n,r){const{hasQueryEngine:i}=e,o=`(${g(n,y(e,n),i)} - ${g(t,y(e,t),i)})`;let s=f[r],u="/";return s<1&&(s=1/s,u="*"),{sqlExpression:1===s?o:`(${o} ${u} ${s})`,sqlWhere:null}}function y(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,i.vE)(n))return"field"}}function $(e,t){const n=t&&e.getField(t);return!!n&&c.has(n.type)}function T(e){return`cast(${e} as float)`}function w(e,t){const{format:n,timeZoneOptions:i,fieldType:o}=t??{};let a,f;if(i&&({timeZone:a,timeZoneName:f}=(0,u.hv)(i.layerTimeZone,i.datesInUnknownTimezone,i.viewTimeZone,(0,r.J2)(n||"short-date-short-time"),o)),"string"==typeof e&&isNaN(Date.parse("time-only"===o?`1970-01-01T${e}Z`:e)))return e;switch(o){case"date-only":{const t=(0,r.J2)(n||"short-date");return"string"==typeof e?(0,r.iS)(e,{...t}):(0,r.Yq)(e,{...t,timeZone:s.n$})}case"time-only":{const t=(0,r.J2)(n||"short-time");return"string"==typeof e?(0,r.F8)(e,t):(0,r.Yq)(e,{...t,timeZone:s.n$})}case"timestamp-offset":{if(!a&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=n||i?(0,r.J2)(n||"short-date-short-time"):void 0,o=t?{...t,timeZone:a,timeZoneName:f}:void 0;return"string"==typeof e?(0,r.Ey)(e,o):(0,r.Yq)(e,o)}default:{const t=n||i?(0,r.J2)(n||"short-date-short-time"):void 0;return(0,r.Yq)("string"==typeof e?new Date(e):e,t?{...t,timeZone:a,timeZoneName:f}:void 0)}}}}}]);