"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[5837],{11631:function(t,n,r){r.d(n,{Rc:function(){return I},J8:function(){return p},oG:function(){return l},rq:function(){return h},Km:function(){return M}});r(6273);var e=r(71709),o=r(79441),u=r(26110),i=r(19165),c=r(56560),s=r(19913),a=r(76982);class f{constructor(t){this._create=t,this._items=new Array,this._itemsPtr=0}get(){return 0===this._itemsPtr&&(0,e.d)((()=>this._reset())),this._itemsPtr>=this._items.length&&this._items.push(this._create()),this._items[this._itemsPtr++]}_reset(){const t=2*this._itemsPtr;this._items.length>t&&(this._items.length=t),this._itemsPtr=0}static createVec2f64(){return new f(c.vt)}static createVec3f64(){return new f(s.vt)}static createVec4f64(){return new f(a.vt)}static createMat3f64(){return new f(o.vt)}static createMat4f64(){return new f(u.vt)}static createQuatf64(){return new f(i.vt)}get test(){}}const l=f.createVec2f64(),h=f.createVec3f64(),M=f.createVec4f64(),I=(f.createMat3f64(),f.createMat4f64()),p=f.createQuatf64()},19165:function(t,n,r){function e(){return[0,0,0,1]}function o(t){return[t[0],t[1],t[2],t[3]]}r.d(n,{o8:function(){return o},vt:function(){return e},zK:function(){return u}});const u=[0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:u,clone:o,create:e,fromValues:function(t,n,r,e){return[t,n,r,e]}},Symbol.toStringTag,{value:"Module"}))},26110:function(t,n,r){function e(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function o(t){return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15]]}function u(t,n,r,e,o,u,i,c,s,a,f,l,h,M,I,p){return[t,n,r,e,o,u,i,c,s,a,f,l,h,M,I,p]}r.d(n,{fA:function(){return u},o8:function(){return o},vt:function(){return e},zK:function(){return i}});const i=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];Object.freeze(Object.defineProperty({__proto__:null,IDENTITY:i,clone:o,create:e,fromValues:u},Symbol.toStringTag,{value:"Module"}))},31262:function(t,n,r){r.d(n,{Z:function(){return u},z:function(){return o}});var e=r(25336);function o(t,n,r){const e=Math.sin(t),o=Math.cos(t),u=Math.sin(n),i=Math.cos(n),c=r;return c[0]=-e,c[4]=-u*o,c[8]=i*o,c[12]=0,c[1]=o,c[5]=-u*e,c[9]=i*e,c[13]=0,c[2]=0,c[6]=i,c[10]=u,c[14]=0,c[3]=0,c[7]=0,c[11]=0,c[15]=1,c}function u(t,n,r){return o(t,n,r),(0,e.mg)(r,r),r}},31753:function(t,n,r){r.d(n,{A6:function(){return g},B8:function(){return M},Xd:function(){return f},Xr:function(){return I},Yc:function(){return b},hZ:function(){return N},lw:function(){return l},t2:function(){return O},x8:function(){return a}});var e=r(79441),o=r(19165),u=r(19913),i=r(78115),c=r(80347),s=r(74772);function a(t,n,r){r*=.5;const e=Math.sin(r);return t[0]=e*n[0],t[1]=e*n[1],t[2]=e*n[2],t[3]=Math.cos(r),t}function f(t,n){const r=2*Math.acos(n[3]),e=Math.sin(r/2);return e>(0,i.FD)()?(t[0]=n[0]/e,t[1]=n[1]/e,t[2]=n[2]/e):(t[0]=1,t[1]=0,t[2]=0),r}function l(t,n,r){const e=n[0],o=n[1],u=n[2],i=n[3],c=r[0],s=r[1],a=r[2],f=r[3];return t[0]=e*f+i*c+o*a-u*s,t[1]=o*f+i*s+u*c-e*a,t[2]=u*f+i*a+e*s-o*c,t[3]=i*f-e*c-o*s-u*a,t}function h(t,n,r,e){const o=n[0],u=n[1],c=n[2],s=n[3];let a,f,l,h,M,I=r[0],p=r[1],g=r[2],E=r[3];return f=o*I+u*p+c*g+s*E,f<0&&(f=-f,I=-I,p=-p,g=-g,E=-E),1-f>(0,i.FD)()?(a=Math.acos(f),l=Math.sin(a),h=Math.sin((1-e)*a)/l,M=Math.sin(e*a)/l):(h=1-e,M=e),t[0]=h*o+M*I,t[1]=h*u+M*p,t[2]=h*c+M*g,t[3]=h*s+M*E,t}function M(t,n){const r=n[0],e=n[1],o=n[2],u=n[3],i=r*r+e*e+o*o+u*u,c=i?1/i:0;return t[0]=-r*c,t[1]=-e*c,t[2]=-o*c,t[3]=u*c,t}function I(t,n){return t[0]=-n[0],t[1]=-n[1],t[2]=-n[2],t[3]=n[3],t}function p(t,n){const r=n[0]+n[4]+n[8];let e;if(r>0)e=Math.sqrt(r+1),t[3]=.5*e,e=.5/e,t[0]=(n[5]-n[7])*e,t[1]=(n[6]-n[2])*e,t[2]=(n[1]-n[3])*e;else{let r=0;n[4]>n[0]&&(r=1),n[8]>n[3*r+r]&&(r=2);const o=(r+1)%3,u=(r+2)%3;e=Math.sqrt(n[3*r+r]-n[3*o+o]-n[3*u+u]+1),t[r]=.5*e,e=.5/e,t[3]=(n[3*o+u]-n[3*u+o])*e,t[o]=(n[3*o+r]+n[3*r+o])*e,t[u]=(n[3*u+r]+n[3*r+u])*e}return t}function g(t,n,r,e){const o=.5*Math.PI/180;n*=o,r*=o,e*=o;const u=Math.sin(n),i=Math.cos(n),c=Math.sin(r),s=Math.cos(r),a=Math.sin(e),f=Math.cos(e);return t[0]=u*s*f-i*c*a,t[1]=i*c*f+u*s*a,t[2]=i*s*a-u*c*f,t[3]=i*s*f+u*c*a,t}const E=s.c,N=s.s,_=s.g,v=l,d=s.d,m=s.h,A=s.l,T=s.j,S=T,y=s.b,w=y,C=s.n,O=s.a,P=s.e;function b(t,n,r){const e=(0,c.e)(n,r);return e<-.999999?((0,c.h)(D,x,n),(0,c.H)(D)<1e-6&&(0,c.h)(D,R,n),(0,c.n)(D,D),a(t,D,Math.PI),t):e>.999999?(t[0]=0,t[1]=0,t[2]=0,t[3]=1,t):((0,c.h)(D,n,r),t[0]=D[0],t[1]=D[1],t[2]=D[2],t[3]=1+e,C(t,t))}const D=(0,u.vt)(),x=(0,u.fA)(1,0,0),R=(0,u.fA)(0,1,0);const q=(0,o.vt)(),L=(0,o.vt)();const z=(0,e.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:_,calculateW:function(t,n){const r=n[0],e=n[1],o=n[2];return t[0]=r,t[1]=e,t[2]=o,t[3]=Math.sqrt(Math.abs(1-r*r-e*e-o*o)),t},conjugate:I,copy:E,dot:m,equals:P,exactEquals:O,fromEuler:g,fromMat3:p,getAxisAngle:f,identity:function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},invert:M,len:S,length:T,lerp:A,mul:v,multiply:l,normalize:C,random:function(t){const n=i.Ov,r=n(),e=n(),o=n(),u=Math.sqrt(1-r),c=Math.sqrt(r);return t[0]=u*Math.sin(2*Math.PI*e),t[1]=u*Math.cos(2*Math.PI*e),t[2]=c*Math.sin(2*Math.PI*o),t[3]=c*Math.cos(2*Math.PI*o),t},rotateX:function(t,n,r){r*=.5;const e=n[0],o=n[1],u=n[2],i=n[3],c=Math.sin(r),s=Math.cos(r);return t[0]=e*s+i*c,t[1]=o*s+u*c,t[2]=u*s-o*c,t[3]=i*s-e*c,t},rotateY:function(t,n,r){r*=.5;const e=n[0],o=n[1],u=n[2],i=n[3],c=Math.sin(r),s=Math.cos(r);return t[0]=e*s-u*c,t[1]=o*s+i*c,t[2]=u*s+e*c,t[3]=i*s-o*c,t},rotateZ:function(t,n,r){r*=.5;const e=n[0],o=n[1],u=n[2],i=n[3],c=Math.sin(r),s=Math.cos(r);return t[0]=e*s+o*c,t[1]=o*s-e*c,t[2]=u*s+i*c,t[3]=i*s-u*c,t},rotationTo:b,scale:d,set:N,setAxes:function(t,n,r,e){const o=z;return o[0]=r[0],o[3]=r[1],o[6]=r[2],o[1]=e[0],o[4]=e[1],o[7]=e[2],o[2]=-n[0],o[5]=-n[1],o[8]=-n[2],C(t,p(t,o))},setAxisAngle:a,slerp:h,sqlerp:function(t,n,r,e,o,u){return h(q,n,o,u),h(L,r,e,u),h(t,q,L,2*u*(1-u)),t},sqrLen:w,squaredLength:y,str:function(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}},Symbol.toStringTag,{value:"Module"}))},32159:function(t,n,r){r.d(n,{Y0:function(){return a},lO:function(){return f}});var e=r(34670),o=r(44153),u=r(67488);const i=new o.A(e.fv),c=new o.A(e.FY),s=new o.A(e.LJ),a=new o.A(e.Ro);function f(t){const n=l.get(t);if(n)return n;let r=i;if(t)if(t===c)r=c;else if(t===s)r=s;else{const n=t.wkid,e=t.latestWkid;if(null!=n||null!=e)(0,u.tl)(n)||(0,u.tl)(e)?r=c:((0,u.ZL)(n)||(0,u.ZL)(e))&&(r=s);else{const n=t.wkt2??t.wkt;if(n){const t=n.toUpperCase();t===h?r=c:t===M&&(r=s)}}}return l.set(t,r),r}const l=new Map,h=c.wkt.toUpperCase(),M=s.wkt.toUpperCase()},43785:function(t,n,r){r.d(n,{$I:function(){return E},AU:function(){return I},Cr:function(){return l},g7:function(){return g},i4:function(){return f},ui:function(){return h},up:function(){return _},vt:function(){return a},yo:function(){return p}});var e=r(4506),o=r(25336),u=r(31753),i=r(19165),c=r(80347),s=r(19913);function a(t=_){return[t[0],t[1],t[2],t[3]]}function f(t,n,r=a()){return(0,c.c)(r,t),r[3]=n,r}function l(t,n,r){return(0,c.h)(r,t,n),(0,c.n)(r,r),r[3]=-(0,c.p)(t,n),r}function h(t,n=a()){const r=(0,o.l)(v,t);return N(n,(0,e.KJ)((0,u.Xd)(n,r))),n}function M(t,n,r=a()){return(0,u.x8)(v,t,E(t)),(0,u.x8)(d,n,E(n)),(0,u.lw)(v,d,v),N(r,(0,e.KJ)((0,u.Xd)(r,v)))}function I(t,n,r,e=a()){return f(s.Cw,t,m),f(s.JP,n,A),f(s.Cb,r,T),M(m,A,m),M(m,T,e),e}function p(t){return t}function g(t){return t[3]}function E(t){return(0,e.kU)(t[3])}function N(t,n){return t[3]=n,t}const _=[0,0,1,0],v=(0,i.vt)(),d=(0,i.vt)(),m=(a(),a()),A=a(),T=a()},45773:function(t,n,r){r.d(n,{VV:function(){return c},hG:function(){return u},wp:function(){return i}});r(4506);var e=r(80347),o=r(19913);function u(t){const n=t[0]*t[0]+t[4]*t[4]+t[8]*t[8],r=t[1]*t[1]+t[5]*t[5]+t[9]*t[9],e=t[2]*t[2]+t[6]*t[6]+t[10]*t[10];return Math.sqrt(Math.max(n,r,e))}function i(t,n){const r=Math.sqrt(n[0]*n[0]+n[4]*n[4]+n[8]*n[8]),o=Math.sqrt(n[1]*n[1]+n[5]*n[5]+n[9]*n[9]),u=Math.sqrt(n[2]*n[2]+n[6]*n[6]+n[10]*n[10]);return(0,e.i)(t,r,o,u),t}function c(t,n,r){Math.abs(t[0])>Math.abs(t[1])?(0,e.i)(n,0,1,0):(0,e.i)(n,1,0,0),(0,e.h)(r,t,n),(0,e.h)(n,r,t),(0,e.n)(r,r),(0,e.n)(n,n)}(0,o.vt)(),(0,o.vt)(),(0,o.vt)(),(0,o.vt)(),(0,o.vt)()},63540:function(t,n,r){r.d(n,{l:function(){return a}});var e=r(4506),o=r(25336),u=r(19913),i=r(31262),c=r(99269),s=r(67488);function a(t,n,r,e){const u=(0,c.Tp)(t,e);if(null==u)return!1;const a=u.source.spatialReferenceId,I=u.dest.spatialReferenceId;if(a===I&&!f(I)&&(a!==c.rz.UNKNOWN||(0,s.aI)(t,e)))return(0,o.kN)(r,n),!0;if(f(I)){const t=c.w5[a][c.rz.LON_LAT],e=c.w5[c.rz.LON_LAT][I];return null!=t&&null!=e&&(t(n,0,h,0),e(h,0,M,0),(0,i.z)(l*h[0],l*h[1],r),r[12]=M[0],r[13]=M[1],r[14]=M[2],!0)}const p=f(a);if((I===c.rz.WEB_MERCATOR||I===c.rz.PLATE_CARREE||I===c.rz.WGS84||I===c.rz.CGCS2000)&&(a===c.rz.WGS84||p||a===c.rz.WEB_MERCATOR||a===c.rz.CGCS2000)){const t=c.w5[a][c.rz.LON_LAT],e=c.w5[c.rz.LON_LAT][I];return null!=t&&null!=e&&(t(n,0,h,0),e(h,0,M,0),p?(0,i.Z)(l*h[0],l*h[1],r):(0,o.D_)(r),r[12]=M[0],r[13]=M[1],r[14]=M[2],!0)}return!1}function f(t){return t===c.rz.SPHERICAL_ECEF||t===c.rz.SPHERICAL_MARS_PCPF||t===c.rz.SPHERICAL_MOON_PCPF||t===c.rz.WGS84_ECEF}const l=(0,e.kU)(1),h=(0,u.vt)(),M=(0,u.vt)()},64159:function(t,n,r){r.d(n,{W:function(){return c},g:function(){return i}});var e=r(19913),o=r(34008),u=r(88133);function i(t,n,r,e){if((0,o.canProjectWithoutEngine)(t.spatialReference,r)){s[0]=t.x,s[1]=t.y;const o=t.z;return s[2]=o??e??0,(0,u.projectBuffer)(s,t.spatialReference,0,n,r,0)}const i=(0,o.tryProjectWithZConversion)(t,r);return!!i&&(n[0]=i?.x,n[1]=i?.y,n[2]=i?.z??e??0,!0)}async function c(t,n,r,e,u){return await(0,o.initializeProjection)(t.spatialReference,r,null,u),i(t,n,r,e)}const s=(0,e.vt)()},74108:function(t,n,r){r.d(n,{V:function(){return u},f:function(){return i}});var e=r(1912),o=r(77873);function u(t,n,r=c){return new e.A({x:t[r.originX],y:t[r.originY],z:t[r.originZ],spatialReference:n})}function i(t,n=c){return new o.A({translation:[t[n.translationX],-t[n.translationZ],t[n.translationY]],rotationAxis:[t[n.rotationX],-t[n.rotationZ],t[n.rotationY]],rotationAngle:t[n.rotationDeg],scale:[t[n.scaleX],t[n.scaleZ],t[n.scaleY]]})}const c={originX:"originX",originY:"originY",originZ:"originZ",translationX:"translationX",translationY:"translationY",translationZ:"translationZ",scaleX:"scaleX",scaleY:"scaleY",scaleZ:"scaleZ",rotationX:"rotationX",rotationY:"rotationY",rotationZ:"rotationZ",rotationDeg:"rotationDeg"}},74695:function(t,n,r){r.d(n,{EJ:function(){return a},_I:function(){return i},g7:function(){return s},gr:function(){return c}});var e=r(4506),o=r(80347),u=r(19913);function i(t,n,r){const e=(0,o.e)(t,n)/(0,o.e)(t,t);return(0,o.g)(r,t,e)}function c(t,n){return(0,o.e)(t,n)/(0,o.l)(t)}function s(t,n){const r=(0,o.e)(t,n)/((0,o.l)(t)*(0,o.l)(n));return-(0,e.XM)(r)}function a(t,n,r){(0,o.n)(f,t),(0,o.n)(l,n);const u=(0,o.e)(f,l),i=(0,e.XM)(u),c=(0,o.h)(f,f,l);return(0,o.e)(c,r)<0?2*Math.PI-i:i}const f=(0,u.vt)(),l=(0,u.vt)()},77873:function(t,n,r){r.d(n,{A:function(){return I}});var e,o=r(82392),u=r(84977),i=r(81482),c=(r(6273),r(80861),r(67498),r(26325)),s=r(25336),a=r(26110),f=r(31753),l=r(19165),h=r(19913),M=r(43785);let I=class extends u.A{static{e=this}constructor(t){super(t),this.translation=(0,h.vt)(),this.rotationAxis=(0,h.ci)(M.up),this.rotationAngle=0,this.scale=(0,h.fA)(1,1,1)}get rotation(){return(0,M.i4)(this.rotationAxis,this.rotationAngle)}set rotation(t){this.rotationAxis=(0,h.o8)((0,M.yo)(t)),this.rotationAngle=(0,M.g7)(t)}get localMatrix(){const t=(0,a.vt)();return(0,f.x8)(p,(0,M.yo)(this.rotation),(0,M.$I)(this.rotation)),(0,s.o1)(t,p,this.translation,this.scale),t}get localMatrixInverse(){return(0,s.B8)((0,a.vt)(),this.localMatrix)}equals(t){return this===t||null!=t&&(0,s.t2)(this.localMatrix,t.localMatrix)}clone(){const t={translation:(0,h.o8)(this.translation),rotationAxis:(0,h.o8)(this.rotationAxis),rotationAngle:this.rotationAngle,scale:(0,h.o8)(this.scale)};return new e(t)}};(0,o._)([(0,i.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],I.prototype,"translation",void 0),(0,o._)([(0,i.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],I.prototype,"rotationAxis",void 0),(0,o._)([(0,i.MZ)({type:Number,nonNullable:!0,json:{write:!0}})],I.prototype,"rotationAngle",void 0),(0,o._)([(0,i.MZ)({type:[Number],nonNullable:!0,json:{write:!0}})],I.prototype,"scale",void 0),(0,o._)([(0,i.MZ)()],I.prototype,"rotation",null),(0,o._)([(0,i.MZ)()],I.prototype,"localMatrix",null),(0,o._)([(0,i.MZ)()],I.prototype,"localMatrixInverse",null),I=e=(0,o._)([(0,c.$)("esri.geometry.support.MeshTransform")],I);const p=(0,l.vt)()},78621:function(t,n,r){r.r(n),r.d(n,{assetMapFromAssetMapsJSON:function(){return N},extractMesh:function(){return p},meshFeatureSetFromJSON:function(){return I}});var e=r(20857),o=r(80861),u=r(80294),i=r(8e3),c=r(62884),s=r(44153),a=r(28936),f=r(52360),l=r(74704),h=r(74108);const M=()=>o.A.getLogger("esri.rest.support.meshFeatureSet");function I(t,n,r){const o=r.features;r.features=[],delete r.geometryType;const u=l.A.fromJSON(r);if(u.geometryType="mesh",!r.assetMaps)return u;const i=N(n,r.assetMaps),c=t.sourceSpatialReference??s.A.WGS84,a=r.globalIdFieldName,{outFields:f}=t,h=null!=f&&f.length>0?(M=f.includes("*")?null:new Set(f),({attributes:t})=>{if(!t)return{};if(!M)return t;for(const n in t)M.has(n)||delete t[n];return t}):()=>({});var M;for(const t of o){const r=p(t,a,c,n,i);u.features.push(new e.A({geometry:r,attributes:h(t)}))}return u}function p(t,n,r,e,o){const u=t.attributes[n],s=o.get(u);if(null==s||!t.geometry)return null;const f=(0,h.V)(t.attributes,r,e.transformFieldRoles),l=i.A.fromJSON(t.geometry);l.spatialReference=r;const M=(0,h.f)(t.attributes,e.transformFieldRoles),I=r.isGeographic?"local":"georeferenced",p=function(t){const n=Array.from(t.files.values()),r=new Array;for(const t of n){if(t.status!==g.COMPLETED)return null;const n=new Array;for(const r of t.parts){if(!r)return null;n.push(new a.Bq(r.url,r.hash))}r.push(new a.Qp(t.name,t.mimeType,n))}return{type:"service",assets:r}}(s);return p?c.default.createWithExternalSource(f,p,{extent:l,transform:M,vertexSpace:I,unitConversionDisabled:!0}):c.default.createIncomplete(f,{extent:l,transform:M,vertexSpace:I})}var g,E;function N(t,n){const r=new Map;for(const e of n){const n=e.parentGlobalId;if(null==n)continue;const o=e.assetName,i=e.assetType,c=e.assetHash,s=e.assetURL,a=e.conversionStatus,l=e.seqNo,h=(0,f.Fm)(i,t.supportedFormats);if(!h){M().error("mesh-feature-set:unknown-format",`Service returned an asset of type ${i}, but it does not list it as a supported type`);continue}const I=(0,u.tE)(r,n,(()=>({files:new Map})));(0,u.tE)(I.files,o,(()=>({name:o,type:i,mimeType:h,status:_(a),parts:[]}))).parts[l]={hash:c,url:s}}return r}function _(t){switch(t){case"COMPLETED":case"SUBMITTED":return g.COMPLETED;case"INPROGRESS":return g.PENDING;default:return g.FAILED}}(E=g||(g={}))[E.FAILED=0]="FAILED",E[E.PENDING=1]="PENDING",E[E.COMPLETED=2]="COMPLETED"},87368:function(t,n,r){r.d(n,{$Q:function(){return x},C:function(){return h},Cr:function(){return g},Io:function(){return z},LV:function(){return l},O_:function(){return p},Qj:function(){return M},T7:function(){return P},Tj:function(){return D},U5:function(){return C},Ui:function(){return O},Z1:function(){return L},_I:function(){return q},b6:function(){return R},ci:function(){return N},fA:function(){return I},gv:function(){return b},lU:function(){return E},mN:function(){return F},mP:function(){return S},mR:function(){return w},vt:function(){return f},ze:function(){return y}});var e=r(4506),o=r(80347),u=r(19913),i=r(74772),c=r(74695),s=r(11631),a=r(45773);function f(t=Y){return[t[0],t[1],t[2],t[3]]}i.a,i.e;function l(t=Y[0],n=Y[1],r=Y[2],e=Y[3]){return I(t,n,r,e,s.Km.get())}function h(t,n){return I(n[0],n[1],n[2],n[3],t)}function M(t){return t}function I(t,n,r,e,o=f()){return o[0]=t,o[1]=n,o[2]=r,o[3]=e,o}function p(t,n,r){const e=n[0]*n[0]+n[1]*n[1]+n[2]*n[2],o=Math.abs(e-1)>1e-5&&e>1e-12?1/Math.sqrt(e):1;return r[0]=n[0]*o,r[1]=n[1]*o,r[2]=n[2]*o,r[3]=-(r[0]*t[0]+r[1]*t[1]+r[2]*t[2]),r}function g(t,n,r,e=f()){const o=r[0]-n[0],u=r[1]-n[1],i=r[2]-n[2],c=t[0]-n[0],s=t[1]-n[1],a=t[2]-n[2],l=u*a-i*s,h=i*c-o*a,M=o*s-u*c,I=l*l+h*h+M*M,p=Math.abs(I-1)>1e-5&&I>1e-12?1/Math.sqrt(I):1;return e[0]=l*p,e[1]=h*p,e[2]=M*p,e[3]=-(e[0]*t[0]+e[1]*t[1]+e[2]*t[2]),e}function E(t,n,r,e=0,u=Math.floor(r*(1/3)),i=Math.floor(r*(2/3))){if(r<3)return!1;n(v,e);let c=u,s=!1;for(;c<r-1&&!s;)n(d,c),c++,s=!(0,o.q)(v,d);if(!s)return!1;for(c=Math.max(c,i),s=!1;c<r&&!s;)n(m,c),c++,(0,o.d)(A,v,d),(0,o.n)(A,A),(0,o.d)(T,d,m),(0,o.n)(T,T),s=!(0,o.q)(v,m)&&!(0,o.q)(d,m)&&Math.abs((0,o.e)(A,T))<_;return s?(g(v,d,m,t),!0):(0!==e||1!==u||2!==i)&&E(t,n,r,0,1,2)}function N(t,n,r=!0){const e=n.length/3;return E(t,((t,r)=>(0,o.i)(t,n[3*r+0],n[3*r+1],n[3*r+2])),r?e-1:e)}const _=.99619469809,v=(0,u.vt)(),d=(0,u.vt)(),m=(0,u.vt)(),A=(0,u.vt)(),T=(0,u.vt)();function S(t,n,r){return n!==t&&h(t,n),t[3]=-(0,o.e)(t,r),t}function y(t,n){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n[3]=-t[3],n}function w(t,n,r,e){return(0,o.h)(m,n,t),p(r,m,e)}function C(t,n,r,e){return X(j(t,n,(0,o.d)(s.rq.get(),r,n),k,e))}function O(t,n,r){return null!=n&&X(j(t,n.origin,n.direction,G,r))}function P(t,n,r){return X(j(t,n.origin,n.vector,V.NONE,r))}function b(t,n,r){return X(j(t,n.origin,n.vector,V.CLAMP,r))}function D(t,n){return F(t,n)>=0}function x(t,n){const r=(0,o.e)(t,n.ray.direction),e=-F(t,n.ray.origin);if(e<0&&r>=0)return!1;if(r>-1e-6&&r<1e-6)return e>0;if((e<0||r<0)&&!(e<0&&r<0))return!0;const u=e/r;return r>0?u<n.c1&&(n.c1=u):u>n.c0&&(n.c0=u),n.c0<=n.c1}function R(t,n){const r=(0,o.e)(t,n.ray.direction),e=-F(t,n.ray.origin);if(r>-1e-6&&r<1e-6)return e>0;const u=e/r;return r>0?u<n.c1&&(n.c1=u):u>n.c0&&(n.c0=u),n.c0<=n.c1}function q(t,n,r){const e=(0,o.g)(s.rq.get(),t,-t[3]),u=function(t,n,r){const e=(0,o.g)(s.rq.get(),t,(0,o.e)(t,n));return(0,o.d)(r,n,e),r}(t,(0,o.d)(s.rq.get(),n,e),s.rq.get());return(0,o.f)(r,u,e),r}function L(t,n,r,e){const u=t,i=s.rq.get(),f=s.rq.get();(0,a.VV)(u,i,f);const l=(0,o.d)(s.rq.get(),r,n),h=(0,c.gr)(i,l),M=(0,c.gr)(f,l),I=(0,c.gr)(u,l);return(0,o.i)(e,h,M,I)}function z(t,n){return Math.abs(F(t,n))}function F(t,n){return(0,o.e)(t,n)+t[3]}var Z,U;function X(t){return t===Z.INTERSECTS_INSIDE_OUT||t===Z.INTERSECTS_OUTSIDE_IN}function j(t,n,r,u,i){const c=(0,o.e)(t,r),s=F(t,n);if(0===c)return s>=0?Z.INSIDE:Z.OUTSIDE;let a=-s/c;return u&V.CLAMP&&(a=(0,e.qE)(a,0,1)),!(u&V.INFINITE_MIN)&&a<0||!(u&V.INFINITE_MAX)&&a>1?s>=0?Z.INSIDE:Z.OUTSIDE:((0,o.f)(i,n,(0,o.g)(i,r,a)),s>=0?Z.INTERSECTS_INSIDE_OUT:Z.INTERSECTS_OUTSIDE_IN)}(U=Z||(Z={}))[U.INTERSECTS_INSIDE_OUT=0]="INTERSECTS_INSIDE_OUT",U[U.INTERSECTS_OUTSIDE_IN=1]="INTERSECTS_OUTSIDE_IN",U[U.INSIDE=2]="INSIDE",U[U.OUTSIDE=3]="OUTSIDE";const Y=[0,0,1,0];var V;!function(t){t[t.NONE=0]="NONE",t[t.CLAMP=1]="CLAMP",t[t.INFINITE_MIN=4]="INFINITE_MIN",t[t.INFINITE_MAX=8]="INFINITE_MAX"}(V||(V={}));const k=V.INFINITE_MIN|V.INFINITE_MAX,G=V.INFINITE_MAX}}]);