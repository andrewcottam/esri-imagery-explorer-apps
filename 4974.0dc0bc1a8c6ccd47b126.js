"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[2549,4974,9427],{9427:function(e,t,r){r.d(t,{OverrideHelper:function(){return u}});var i=r(93814),n=r(60861),s=r(15565),o=r(51387),a=r(46279),l=r(77234),c=r(43996);const h=e=>{if(!e)return[0,0,0,0];const{r:t,g:r,b:i,a:n}=e;return[t,r,i,255*n]};class u{static findApplicableOverrides(e,t,r){if(e&&t){if(e.primitiveName){let i=!1;for(const t of r)if(t.primitiveName===e.primitiveName){i=!0;break}if(!i)for(const i of t)i.primitiveName===e.primitiveName&&r.push(i)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const i of e.effects)u.findApplicableOverrides(i,t,r);if(e.symbolLayers)for(const i of e.symbolLayers)u.findApplicableOverrides(i,t,r);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMPictureStroke":case"CIMGradientStroke":case"CIMSolidFill":case"CIMPictureFill":case"CIMHatchFill":case"CIMGradientFill":case"CIMVectorMarker":case"CIMCharacterMarker":case"CIMPictureMarker":if(e.effects)for(const i of e.effects)u.findApplicableOverrides(i,t,r);if(e.markerPlacement&&u.findApplicableOverrides(e.markerPlacement,t,r),"CIMVectorMarker"===e.type){if(e.markerGraphics)for(const i of e.markerGraphics)u.findApplicableOverrides(i,t,r),u.findApplicableOverrides(i.symbol,t,r)}else"CIMCharacterMarker"===e.type?u.findApplicableOverrides(e.symbol,t,r):"CIMHatchFill"===e.type?u.findApplicableOverrides(e.lineSymbol,t,r):"CIMPictureMarker"===e.type&&u.findApplicableOverrides(e.animatedSymbolProperties,t,r)}}}static findEffectOverrides(e,t){if(!e)return null;if("CIMGeometricEffectDashes"===e.type&&(0,l.FH)(e),!t||!e.primitiveName)return{type:"cim-effect-param",effect:e,overrides:[]};const r=(0,l.rB)(e),i=e.primitiveName,n=[];for(const e of t)e.primitiveName===i&&n.push((0,l.rB)(e));return{type:"cim-effect-param",effect:r,overrides:(0,l.pk)(n)}}static async resolveSymbolOverrides(e,t,r,i,n,a,c){if(!e?.symbol)return null;let{symbol:h,primitiveOverrides:f}=e;const p=!!f;if(!p&&!i)return h;h=(0,s.o8)(h),f=(0,s.o8)(f);let m=!0;if(t||(t={attributes:{}},m=!1),p){if(m||(f=f.filter((e=>!e.valueExpressionInfo?.expression.includes("$feature")))),c||(f=f.filter((e=>!e.valueExpressionInfo?.expression.includes("$view")))),f.length>0){const e=(0,l.O2)(t.attributes),i={spatialReference:r,fields:e,geometryType:n};await u.createRenderExpressions(f,i),u.evaluateOverrides(f,t,n??"esriGeometryPoint",a,c,new o.A(e))}u.applyOverrides(h,f)}return i&&u.applyDictionaryTextOverrides(h,t,i,null),h}static{this._expressionToRenderExpression=new Map}static async createRenderExpressions(e,t){const r=[];for(const i of e){const e=i.valueExpressionInfo;if(!e||u._expressionToRenderExpression.has(e.expression))continue;const n=(0,a.Ad)(e.expression,t.spatialReference);r.push(n),n.then((t=>u._expressionToRenderExpression.set(e.expression,t)))}r.length>0&&await Promise.all(r)}static evaluateOverrides(e,t,r,i,s,o){const a={$view:{scale:s?.scale}};for(const s of e){s.value&&"object"==typeof s.value&&(0,n.IB)(s.value)&&("Color"===s.propertyName||"StrokeColor"===s.propertyName)&&(s.value=h(s.value));const e=s.valueExpressionInfo;if(!e)continue;const l=u._expressionToRenderExpression.get(e.expression);l&&(s.value=(0,c.default)(l,t,a,r,o,i))}}static applyDictionaryTextOverrides(e,t,r,i,n="Normal"){if(e?.type)switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":case"CIMTextSymbol":{const s=e.symbolLayers;if(!s)return;for(const o of s)o&&"CIMVectorMarker"===o.type&&u.applyDictionaryTextOverrides(o,t,r,i,"CIMTextSymbol"===e.type?e.textCase:n)}break;case"CIMVectorMarker":{const n=e.markerGraphics;if(!n)return;for(const e of n)e&&u.applyDictionaryTextOverrides(e,t,r,i)}break;case"CIMMarkerGraphic":{const s=e.textString;if(s&&s.includes("[")){const o=(0,l.gQ)(s,r);e.textString=(0,l.FM)(t,o,i,n)}}}}static applyOverrides(e,t,r,i){if(e.primitiveName)for(const n of t)if(n.primitiveName===e.primitiveName){const t=(0,l.YF)(n.propertyName);if(i&&i.push({cim:e,nocapPropertyName:t,value:e[t]}),r){let t=!1;for(const i of r)i.primitiveName===e.primitiveName&&(t=!0);t||r.push(n)}null!=n.value&&(e[t]=n.value)}switch(e.type){case"CIMPointSymbol":case"CIMLineSymbol":case"CIMPolygonSymbol":if(e.effects)for(const n of e.effects)u.applyOverrides(n,t,r,i);if(e.symbolLayers)for(const n of e.symbolLayers)u.applyOverrides(n,t,r,i);break;case"CIMTextSymbol":break;case"CIMSolidStroke":case"CIMSolidFill":case"CIMVectorMarker":if(e.effects)for(const n of e.effects)u.applyOverrides(n,t,r,i);if("CIMVectorMarker"===e.type&&e.markerGraphics)for(const n of e.markerGraphics)u.applyOverrides(n,t,r,i),u.applyOverrides(n.symbol,t,r,i)}}static restoreOverrides(e){for(const t of e)t.cim[t.nocapPropertyName]=t.value}static buildOverrideKey(e){let t="";for(const r of e)void 0!==r.value&&(t+=`${r.primitiveName}${r.propertyName}${JSON.stringify(r.value)}`);return t}static toValue(e,t){if("DashTemplate"===e)return t.split(" ").map((e=>Number(e)));if("Color"===e){const e=new i.A(t).toRgba();return e[3]*=255,e}return t}}},22549:function(e,t,r){r.r(t),r.d(t,{CIMSymbolRasterizer:function(){return u}});var i=r(56053),n=r(97881),s=r(3846),o=r(52644),a=r(9427),l=r(73356),c=r(77234);const h=96/72;class u{constructor(e){this._spatialReference=e,this._imageDataCanvas=null,this._cimResourceManager=new n.A}get _canvas(){return this._imageDataCanvas||(this._imageDataCanvas=document.createElement("canvas")),this._imageDataCanvas}get resourceManager(){return this._cimResourceManager}async rasterizeCIMSymbolAsync(e,t,r,n,s,h,u,p,m,y){if(!e)return null;const{data:g}=e;if(!g||"CIMSymbolReference"!==g.type||!g.symbol)return null;const{symbol:d}=g;h||(h=(0,c.n5)(d));const w=await a.OverrideHelper.resolveSymbolOverrides(g,t,this._spatialReference,s,h,u,p),M=this._cimResourceManager,v=[];o.wp.fetchResources(w,M,v),o.wp.fetchFonts(w,M,v),v.length>0&&await Promise.all(v);const{width:x,height:b}=r;let C=f(h,x,b,n,y);const I=o.wp.getEnvelope(w,C,M);if(!I)return null;I.x===1/0&&(I.x=x+2),I.y===1/0&&(I.y=-b/2),I.width===-1/0&&(I.width=x),I.height===-1/0&&(I.height=b);let P=1,S=0,O=0;switch(d.type){case"CIMPointSymbol":case"CIMTextSymbol":{let e=1;I.width>x&&(e=x/I.width);let t=1;I.height>b&&(t=b/I.height),"preview"===n&&(I.width<x&&(e=x/I.width),I.height<b&&(t=b/I.height)),P=Math.min(e,t),S=I.x+I.width/2,O=I.y+I.height/2}break;case"CIMLineSymbol":if(y){O=I.y+I.height/2,S=I.x+I.width/2;const e=I.width-x,t=I.height-b;C={paths:(0,l.hs)(C.paths,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{(m||I.height>b)&&(P=b/I.height),O=I.y+I.height/2;const e=I.x*P+x/2,t=(I.x+I.width)*P+x/2,r=(0,i.Rg)(C)?C.paths:(0,i.Bi)(C)?C.rings:null;if(null===r)throw new Error("Bad geometry, can't rasterise symbol!");r[0][0][0]-=e/P,r[0][2][0]-=(t-x)/P}break;case"CIMPolygonSymbol":if(y){O=I.y+I.height/2,S=I.x+I.width/2;const e=I.width-x,t=I.height-b;C={paths:(0,l.hs)(C.rings,{xmin:-1*I.width/2+e,xmax:I.width/2-e,ymin:-1*I.height/2+t,ymax:I.height/2-t,width:I.width-2*e,height:I.height-2*t})}}else{S=I.x+I.width/2,O=I.y+I.height/2;const e=I.x*P+x/2,t=(I.x+I.width)*P+x/2,r=I.y*P+b/2,i=(I.y+I.height)*P+b/2,{rings:n}=C;e<0&&(n[0][0][0]-=e,n[0][3][0]-=e,n[0][4][0]-=e),r<0&&(n[0][0][1]+=r,n[0][1][1]+=r,n[0][4][1]+=r),t>x&&(n[0][1][0]-=t-x,n[0][2][0]-=t-x),i>b&&(n[0][2][1]+=i-b,n[0][3][1]+=i-b)}}const k={type:"cim",data:{type:"CIMSymbolReference",symbol:w}};return this.rasterize(k,x,b,S,O,P,h,1,C)}rasterize(e,t,r,i,n,o,a,l=0,u=null,p=window.devicePixelRatio||1){const{data:m}=e;if(!m||"CIMSymbolReference"!==m.type||!m.symbol)return null;const{symbol:y}=m,g=this._canvas,d=p*h;g.width=t*d,g.height=r*d,a||(a=(0,c.n5)(y)),u||(u=f(a,t,r,"legend")),g.width+=2*l,g.height+=2*l;const w=g.getContext("2d",{willReadFrequently:!0}),M=s.IT.createIdentity();return M.translate(-i,-n),M.scale(o*d,-o*d),M.translate(t*d/2+l,r*d/2+l),w.clearRect(0,0,g.width,g.height),new s.Rj(w,this._cimResourceManager,M,!0).drawSymbol(y,u),w.getImageData(0,0,g.width,g.height)}}function f(e,t,r,i,n){const s=-t/2+1,o=t/2-1,a=r/2-1,c=-r/2+1;if(n&&("esriGeometryPolygon"===e||"esriGeometryPolyline"===e)){const i=function(e,t,r,i){return"esriGeometryPolygon"===t?{rings:(0,l.Tl)((0,l.hs)(e.rings,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:"esriGeometryPolyline"===t?{paths:(0,l.Tl)((0,l.hs)(e.paths,{xmin:0,ymin:0,width:r,height:i}),-1*r/2,-1*i/2)}:null}(n,e,t,r);if(i)return i}switch(e){case"esriGeometryPoint":return{x:0,y:0};case"esriGeometryPolyline":return{paths:[[[s,0],[0,0],[o,0]]]};default:return"legend"===i?{rings:[[[s,a],[o,0],[o,c],[s,c],[s,a]]]}:{rings:[[[s,a],[o,a],[o,c],[s,c],[s,a]]]}}}},43996:function(e,t,r){r.d(t,{default:function(){return o}});var i=r(62991),n=r(80861),s=r(66220);function o(e,t,r,i,s,o){if(null==e)return null;const a=e.references("geometry")&&o?l(t,i,o):t,c=e.repurposeFeature(a,s);try{return e.evaluate(c,r)}catch(e){return n.A.getLogger("esri.views.2d.support.arcadeOnDemand").warn("Feature arcade evaluation failed:",e),null}}const a=new Map;function l(e,t,r){const{transform:o,hasZ:l,hasM:c}=r;a.has(t)||a.set(t,function(e){const t={};switch(e){case"esriGeometryPoint":return(e,r,i,n)=>(0,s.Tr)(r,t,e,i,n);case"esriGeometryPolygon":return(e,r,i,n)=>(0,s.$X)(r,t,e,i,n);case"esriGeometryPolyline":return(e,r,i,n)=>(0,s.P5)(r,t,e,i,n);case"esriGeometryMultipoint":return(e,r,i,n)=>(0,s.SW)(r,t,e,i,n);default:return n.A.getLogger("esri.views.2d.support.arcadeOnDemand").error(new i.A("mapview-arcade",`Unable to handle geometryType: ${e}`)),e=>e}}(t));const h=a.get(t)(e.geometry,o,l,c);return{...e,geometry:h}}},66220:function(e,t,r){r.d(t,{$X:function(){return R},B2:function(){return o},Gy:function(){return I},IE:function(){return s},P5:function(){return _},Q1:function(){return n},QE:function(){return S},SW:function(){return O},Tr:function(){return k},VV:function(){return i},wp:function(){return P}});r(56053);function i(e){return e?{originPosition:"upper-left"===e.originPosition?"upperLeft":"lower-left"===e.originPosition?"lowerLeft":e.originPosition,scale:e.tolerance?[e.tolerance,e.tolerance,1,1]:[1,1,1,1],translate:null!=e.extent?[e.extent.xmin,e.extent.ymax,e.extent.zmin??0,e.extent.mmin??0]:[0,0,0,0]}:null}function n(e){if(function(e){return"lowerLeft"===e.originPosition&&4===e.scale.length&&4===e.translate.length}(e))return e;const{originPosition:t,scale:r,translate:i}=e,n=r[0]??1,s=r[1]??1;return{originPosition:"lowerLeft",scale:[n,"lowerLeft"===t?s:-s,r[2]??1,r[3]??1],translate:[i[0]??0,i[1]??0,i[2]??0,i[3]??0]}}function s({scale:e,translate:t},r){return Math.round((r-t[0])/e[0])}function o({scale:e,translate:t},r){return Math.round((r-t[1])/e[1])}function a({scale:e,translate:t},r){return Math.round(((r??0)-t[2])/e[2])}function l({scale:e,translate:t},r){return r?Math.round((r-t[3])/e[3]):0}function c(e,t){return e&&t?p:e&&!t?u:!e&&t?f:h}const h=(e,t)=>{const r=[];if(!t.length)return null;const i=t[0];let n=s(e,i[0]),a=o(e,i[1]);r.push([n,a]);for(let i=1;i<t.length;i++){const[l,c]=t[i],h=s(e,l),u=o(e,c);h===n&&u===a||r.push([h-n,u-a]),n=h,a=u}return r},u=(e,t)=>{const r=[];if(!t.length)return null;const i=t[0];let n=s(e,i[0]),l=o(e,i[1]),c=a(e,i[2]);r.push([n,l,c]);for(let i=1;i<t.length;i++){const[h,u,f]=t[i],p=s(e,h),m=o(e,u),y=a(e,f);p===n&&m===l&&y===c||r.push([p-n,m-l,y]),n=p,l=m,c=y}return r},f=(e,t)=>{const r=[];if(!t.length)return null;const i=t[0];let n=s(e,i[0]),a=o(e,i[1]),c=l(e,i[2]);r.push([n,a,c]);for(let i=1;i<t.length;i++){const[h,u,f]=t[i],p=s(e,h),m=o(e,u),y=l(e,f);p===n&&m===a&&y===c||r.push([p-n,m-a,y]),n=p,a=m,c=y}return r},p=(e,t)=>{const r=[];if(!t.length)return null;const i=t[0];let n=s(e,i[0]),c=o(e,i[1]),h=a(e,i[2]),u=l(e,i[3]);r.push([n,c,h,u]);for(let i=1;i<t.length;i++){const[f,p,m,y]=t[i],g=s(e,f),d=o(e,p),w=a(e,m),M=l(e,y);g===n&&d===c&&w===h&&M===u||r.push([g-n,d-c,w,M]),n=g,c=d,h=w,u=M}return r};function m({scale:e,translate:t},r){return r*e[0]+t[0]}function y({scale:e,translate:t},r){return r*e[1]+t[1]}function g({scale:e,translate:t},r){return(r??0)*e[2]+t[2]}function d({scale:e,translate:t},r){return r?r*e[3]+t[3]:0}function w(e,t){return e&&t?b:e&&!t?v:!e&&t?x:M}const M=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const i=t[0];let n=m(e,i[0]),s=y(e,i[1]);r[0]=[n,s];const{scale:o,originPosition:a}=e,l=o[0],c="lowerLeft"===a?o[1]:-o[1];for(let e=1;e<t.length;e++){const[i,o]=t[e];n+=l*i,s+=c*o,r[e]=[n,s]}return r},v=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const i=t[0];let n=m(e,i[0]),s=y(e,i[1]);r[0]=[n,s,g(e,i[2])];const{scale:o,originPosition:a}=e,l=o[0],c="lowerLeft"===a?o[1]:-o[1];for(let i=1;i<t.length;i++){const[o,a,h]=t[i];n+=l*o,s+=c*a,r[i]=[n,s,g(e,h)]}return r},x=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const i=t[0];let n=m(e,i[0]),s=y(e,i[1]);r[0]=[n,s,d(e,i[2])];const{scale:o,originPosition:a}=e,l=o[0],c="lowerLeft"===a?o[1]:-o[1];for(let i=1;i<t.length;i++){const[o,a,h]=t[i];n+=l*o,s+=c*a,r[i]=[n,s,d(e,h)]}return r},b=(e,t)=>{const r=new Array(t.length);if(!t.length)return r;const i=t[0];let n=m(e,i[0]),s=y(e,i[1]);r[0]=[n,s,g(e,i[2]),d(e,i[3])];const{scale:o,originPosition:a}=e,l=o[0],c="lowerLeft"===a?o[1]:-o[1];for(let i=1;i<t.length;i++){const[o,a,h,u]=t[i];n+=l*o,s+=c*a,r[i]=[n,s,g(e,h),d(e,u)]}return r};function C(e,t,r){const i=new Array(r.length);for(let n=0;n<r.length;n++)i[n]=t(e,r[n]);return i}function I(e,t,r){const i=n(e);return t.x=s(i,r.x),t.y=o(i,r.y),null!=r.z&&(t.z=a(i,r.z)),null!=r.m&&(t.m=l(i,r.m)),t}function P(e,t,r){const i=function(e,t,r,i){const n=[],s=c(r,i);for(let r=0;r<t.length;r++){const i=s(e,t[r]);i&&i.length>=3&&n.push(i)}return n.length?n:null}(n(e),r.rings,r.hasZ,r.hasM);return i?(t.rings=i,t.hasZ=r.hasZ??!1,t.hasM=r.hasM??!1,t):null}function S(e,t,r){const i=function(e,t,r,i){const n=[],s=c(r,i);for(let r=0;r<t.length;r++){const i=s(e,t[r]);i&&i.length>=2&&n.push(i)}return n.length?n:null}(n(e),r.paths,r.hasZ,r.hasM);return i?(t.paths=i,t.hasZ=r.hasZ??!1,t.hasM=r.hasM??!1,t):null}function O(e,t,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=n(e);t.points=w(i,s)(o,r.points),t.hasZ=i,t.hasM=s}return t}function k(e,t,r,i=null!=r?.z,s=null!=r?.m){if(null==r)return t;const o=n(e);return t.x=m(o,r.x),t.y=y(o,r.y),i&&(t.z=g(o,r.z)),s&&(t.m=d(o,r.m)),t}function R(e,t,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=n(e);t.rings=C(o,w(i,s),r.rings),t.hasZ=i,t.hasM=s}return t}function _(e,t,r,i=r?.hasZ??!1,s=r?.hasM??!1){if(null!=r){const o=n(e);t.paths=C(o,w(i,s),r.paths),t.hasZ=i,t.hasM=s}return t}},71345:function(e,t,r){r.d(t,{A:function(){return n}});var i=r(14571);class n{constructor(e,t,r,n){this.transformedX=0,this.transformedY=0,this.center=(0,i.fA)(e,t),this.centerT=(0,i.vt)(),this.halfWidth=r/2,this.halfHeight=n/2,this.width=r,this.height=n}get x(){return this.center[0]}get y(){return this.center[1]}get blX(){return this.center[0]+this.halfWidth}get blY(){return this.center[1]+this.halfHeight}get trX(){return this.center[0]-this.halfWidth}get trY(){return this.center[1]-this.halfHeight}get xmin(){return this.x-this.halfWidth}get xmax(){return this.x+this.halfWidth}get ymin(){return this.y-this.halfHeight}get ymax(){return this.y+this.halfHeight}set x(e){this.center[0]=e}set y(e){this.center[1]=e}clone(){return new n(this.x,this.y,this.width,this.height)}serialize(e){return e.writeF32(this.center[0]),e.writeF32(this.center[1]),e.push(this.width),e.push(this.height),e}findCollisionDelta(e,t=4){const r=Math.abs(e.centerT[0]-this.centerT[0]),i=Math.abs(e.centerT[1]-this.centerT[1]),n=(e.halfWidth+this.halfWidth+t)/r,s=(e.halfHeight+this.halfHeight+t)/i,o=Math.min(n,s);return Math.log2(o)}extend(e){const t=Math.min(this.xmin,e.xmin),r=Math.min(this.ymin,e.ymin),i=Math.max(this.xmax,e.xmax)-t,n=Math.max(this.ymax,e.ymax)-r,s=t+i/2,o=r+n/2;this.width=i,this.height=n,this.halfWidth=i/2,this.halfHeight=n/2,this.x=s,this.y=o}static deserialize(e){const t=e.readF32(),r=e.readF32(),i=e.readInt32(),s=e.readInt32();return new n(t,r,i,s)}}},93796:function(e,t,r){r.d(t,{D:function(){return g},previewCIMSymbol:function(){return d}});var i=r(23572),n=r(52644),s=r(22549),o=r(9427),a=r(77234),l=r(21550),c=r(63602);const h=new s.CIMSymbolRasterizer(null),u=(0,i.PN)(l.CB.size),f=(0,i.PN)(l.CB.maxSize),p=(0,i.PN)(l.CB.lineWidth),m=1;async function y(e,t,r){const i=t?.size;let n=null!=i&&"object"==typeof i&&"width"in i?i.width:i,s=null!=i&&"object"==typeof i&&"height"in i?i.height:i;if(!n||!s)if("esriGeometryPolygon"===r)n=s=t.maxSize?Math.min(t.maxSize,u):u;else{const i=await g(e,t,r);i&&(n=i.width,s=i.height),"esriGeometryPolyline"===r&&(n=t.maxSize?Math.min(t.maxSize,p):p),n=null!=n&&isFinite(n)?Math.min(n,f):u,s=null!=s&&isFinite(s)?Math.max(Math.min(s,f),m):u}return"legend"===t.style&&"esriGeometryPolyline"===r&&(n=p),{width:n,height:s}}async function g(e,t={},r){const i=t.cimOptions||t;r??=i.geometryType||(0,a.n5)(e?.data?.symbol);const{feature:s,fieldMap:l,viewParams:c}=i,u=await o.OverrideHelper.resolveSymbolOverrides(e.data,s,null,l,r,null,c);if(!u)return null;(e=e.clone()).data={type:"CIMSymbolReference",symbol:u},e.data.primitiveOverrides=void 0;const f=[];return n.wp.fetchResources(u,h.resourceManager,f),n.wp.fetchFonts(u,h.resourceManager,f),f.length>0&&await Promise.all(f),n.wp.getEnvelope(u,null,h.resourceManager)}async function d(e,t={}){const{node:r,opacity:n,symbolConfig:s}=t,o=null!=s&&"object"==typeof s&&"isSquareFill"in s&&s.isSquareFill,l=t.cimOptions||t,u=l.geometryType||(0,a.n5)(e?.data?.symbol),f=await y(e,t,u),{feature:p,fieldMap:m}=l,g=t?.geometry||o||"esriGeometryPolygon"!==u?"preview":"legend";let d=f;const w=f;if(t?.geometry&&("esriGeometryPolygon"===u||"esriGeometryPolyline"===u)){const e=200;if((0,i.Lz)(f.width)<e||(0,i.Lz)(f.height)<e){const t=f.width>f.height?(0,i.PN)(e)*f.height/f.width:(0,i.PN)(e);d={width:f.width>f.height?(0,i.PN)(e):(0,i.PN)(e)*f.width/f.height,height:t}}}const M=await h.rasterizeCIMSymbolAsync(e,p,d,g,m,u,null,l.viewParams,l.allowScalingUp,t?.geometry?.toJSON());if(!M)return null;const{width:v,height:x}=M,b=document.createElement("canvas");b.width=v,b.height=x,b.getContext("2d").putImageData(M,0,0);const C=(0,i.Lz)(w.width),I=(0,i.Lz)(w.height),P=new Image(C,I);P.src=b.toDataURL(),P.ariaLabel=t.ariaLabel??null,P.alt=t.ariaLabel??"",null!=n&&(P.style.opacity=`${n}`);let S=P;if(null!=t.effectView){const e={shape:{type:"image",x:0,y:0,width:C,height:I,src:P.src},fill:null,stroke:null,offset:[0,0]};S=(0,c.fz)([[e]],[C,I],t)}return r&&S&&r.appendChild(S),S}},97881:function(e,t,r){r.d(t,{A:function(){return s}});var i=r(47111),n=r(73027);class s{constructor(){this._resourceMap=new Map,this._inFlightResourceMap=new Map,this.geometryEngine=null,this.geometryEnginePromise=null}destroy(){this._inFlightResourceMap.clear(),this._resourceMap.clear()}getResource(e){return this._resourceMap.get(e)??null}async fetchResource(e,t){const r=this._resourceMap.get(e);if(r)return{width:r.width,height:r.height};let i=this._inFlightResourceMap.get(e);return i?i.then((e=>({width:e.width,height:e.height}))):(i=(0,n.M5)(e,t),this._inFlightResourceMap.set(e,i),i.then((t=>(this._inFlightResourceMap.delete(e),this._resourceMap.set(e,t),{width:t.width,height:t.height})),(()=>({width:0,height:0}))))}deleteResource(e){this._inFlightResourceMap.delete(e),this._resourceMap.delete(e)}loadFont(e){return(0,i.Al)(e)}}}}]);