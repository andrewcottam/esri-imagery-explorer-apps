"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[8534],{347:function(e,t,n){n.d(t,{MY:function(){return f},Td:function(){return h},UT:function(){return m},e$:function(){return b},iW:function(){return g},qN:function(){return d}});var r=n(93814),i=n(47659),o=n(77896),s=n(88259),a=n(60936),l=n(31864);const u={initializeLayersFromClientData:async(e,t,n)=>{if(t||(t=[...e.layers,...e.tables].map((e=>e.graphTypeName))),0===t?.length)return;const r=new Map;for(const n of t)r.set(n,p(e,n));const i=await(0,s.fetchClientDataAtKeys)(e.dataManager.knowledgeGraph,Array.from(r.values()),{requestOptions:{signal:n?.signal}});for(const t of[...e.layers,...e.tables]){const n=t.objectType.name;if(null==n)continue;const r=i.get(p(e,n));if(r){const e=JSON.parse(r);null===e||"object"!=typeof e||e.hasOwnProperty("showLabels")||(e.showLabels=!1),t.read(e,{origin:"service"})}}}},p=(e,t)=>"knowledge-graph"===e.type?`${t}/Map`:`${t}/LinkChart/LinkChartSubLayer`;async function d(e,t,n){return u.initializeLayersFromClientData(e,t,n)}const c=["#4a0932","#b31515","#18382e","#a64f1b","#102432","#8c213f","#ed9310","#2c6954","#144d59","#ffc730","#75351e","#454f4b","#78b1c2","#191921","#8f8f82","#9be0c0","#dbb658","#87b051","#11495c","#c43541","#9c5596","#44498b","#ad9d63","#86afb3","#5c98ca","#b0bfa2","#73241f","#b86b53","#d9d78c","#3e756d","#f260a1","#a0d17d","#c27c30","#eb82eb","#ffdf3c","#ffb259","#ab52b3","#3cccb4","#0095ba","#d92b30"],y="#8f8f82";function h(e){return e<0||e>=c.length?new r.A(y):new r.A(c[e])}function m(e){const t=e.toArray();return new a.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",enable:!0,style:"solid",width:.75,color:t},{type:"CIMVectorMarker",enable:!0,size:6,markerPlacement:{type:"CIMMarkerPlacementOnLine",angleToLine:!0,relativeTo:"LineMiddle"},frame:{xmin:-10,ymin:-5,xmax:0,ymax:5},markerGraphics:[{type:"CIMMarkerGraphic",geometry:{rings:[[[-12,-3.47],[-12,3.6],[1.96,-.03],[-12,-3.47]]]},symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:t}]}}]}]}}})}function f(e){let t="ESRI__ID",n=4;for(const r of e)if(r.name){if("name"===r.name.toLowerCase()){t=r.name;break}r.name.toLowerCase().includes("name")?(t=r.name,n=2):"esriFieldTypeString"===r.fieldType&&n>3&&(t=r.name,n=3)}return t}function g(e,t,n){const r={color:[80,80,80],haloColor:[255,255,255],haloSize:.7,font:{size:10,weight:"normal"}},s=new i.A({labelExpressionInfo:new o.A({expression:"ESRI__ID"===n?`${t}`:`$feature.${n}`}),labelPlacement:"above-center",symbol:new l.A(r)}),a=new i.A({labelExpressionInfo:new o.A({expression:`'${t}' + IIf($feature.ESRI__AggregationCount>1, ' (' + $feature.ESRI__AggregationCount + ')', '')`}),labelPlacement:"center-along",labelPosition:"parallel",repeatLabel:!1,symbol:new l.A({...r,yoffset:"12px"})});return"entity"===e?[s]:[a]}function b(e,t,n){const r={color:[255,255,255],haloColor:[0,0,0],haloSize:.7,font:{size:10,weight:"bold"}},s="ESRI__ID"===n?`${e}`:`$feature.${n}`;return"point"===t?[new i.A({labelExpressionInfo:new o.A({expression:s}),labelPlacement:"above-center",symbol:new l.A(r)})]:"polyline"===t?[new i.A({labelExpressionInfo:new o.A({expression:s}),labelPlacement:"center-along",repeatLabel:!0,symbol:new l.A(r)})]:"polygon"===t?[new i.A({labelExpressionInfo:new o.A({expression:s}),labelPlacement:"always-horizontal",symbol:new l.A(r)})]:null}},12199:function(e,t,n){n.d(t,{k5:function(){return p},aq:function(){return u},Wq:function(){return d}});n(20857);var r=n(62991),i=(n(1912),n(65648),n(38648),n(11682),n(77692),n(75345),n(37549),n(1817));(0,i.O)()({none:"none",startAndEnd:"start-and-end",startOnly:"start-only"}),(0,i.O)()({absoluteValue:"absolute-value",multiplier:"multiplier"});const o=new Map([["basic-grid","basic-grid"],["geographic-organic-standard","geographic-organic-standard"],["hierarchical-bottom-to-top","hierarchical-bottom-to-top"],["hierarchical-top-to-bottom","hierarchical-bottom-to-top"],["organic-community","organic-community"],["organic-fusiform","organic-standard"],["organic-leaf-circle","organic-standard"],["organic-standard","organic-standard"],["radial-node-centric","radial-root-centric"],["radial-root-centric","radial-root-centric"],["tree-bottom-to-top","tree-left-to-right"],["tree-left-to-right","tree-left-to-right"],["tree-right-to-left","tree-left-to-right"],["tree-top-to-bottom","tree-left-to-right"],["chronological-mono-timeline","chronological-mono-timeline"],["chronological-multi-timeline","chronological-multi-timeline"]]);var s=n(88259),a=n(23783);n(60936),n(55736),n(31864);function l(e,t){const n=new Map;if(t.dataModel?.relationshipTypes)for(const e of t.dataModel.relationshipTypes)e.name&&n.set(e.name,[]);for(const t of e)n.has(t.typeName)&&n.get(t.typeName)?.push(t.id);return n}async function u(e,t,n){const r=[],i=l(e,t),o={},u=[];for(const[e,t]of i){if(t.length<1)continue;const n=`${e}_ids`;o[n]=t,u.push(`MATCH (n)-[r:${e}]->(m) WHERE id(r) in $${n} RETURN id(n), labels(n)[0], id(m), labels(m)[0]`)}if(0===u.length)return[];const p=u.join(" UNION "),d=new a.A({openCypherQuery:p,bindParameters:o}),c=(await(0,s.executeQueryStreaming)(t,d,n?.requestOptions)).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await c.read();if(e)break;for(const e of t)r.push({id:e[0],typeName:e[1]}),r.push({id:e[2],typeName:e[3]})}return r}const p=e=>o.get(e)??"radial-root-centric";function d(e){if(!e.spatialReference.isWGS84)throw new r.A("knowledge-graph:layer-support-utils","The utilsExtentToInBoundsRings function only supports WGS84 spatial references.");return e.clone().normalize().map((e=>[[e.xmin,e.ymin],[e.xmin,e.ymax],[e.xmax,e.ymax],[e.xmax,e.ymin],[e.xmin,e.ymin]]))}},23783:function(e,t,n){n.d(t,{A:function(){return u}});var r=n(82392),i=n(81482),o=(n(6273),n(80861),n(67498),n(26325)),s=n(44153),a=n(73783);let l=class extends a.A{constructor(e){super(e),this.openCypherQuery=""}};(0,r._)([(0,i.MZ)()],l.prototype,"openCypherQuery",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQuery")],l);let u=class extends l{constructor(e){super(e),this.bindParameters=null,this.bindGeometryQuantizationParameters=null,this.outputQuantizationParameters=null,this.outputSpatialReference=null,this.provenanceBehavior=null}};(0,r._)([(0,i.MZ)()],u.prototype,"bindParameters",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"bindGeometryQuantizationParameters",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"outputQuantizationParameters",void 0),(0,r._)([(0,i.MZ)({type:s.A})],u.prototype,"outputSpatialReference",void 0),(0,r._)([(0,i.MZ)()],u.prototype,"provenanceBehavior",void 0),u=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphQueryStreaming")],u)},28530:function(e,t,n){n.d(t,{A:function(){return l}});var r=n(82392),i=n(84977),o=n(81482),s=(n(6273),n(80861),n(67498),n(26325)),a=n(92450);let l=class extends i.A{constructor(e){super(e),this.path=[]}};(0,r._)([(0,o.MZ)({type:[a.A],json:{write:!0}})],l.prototype,"path",void 0),l=(0,r._)([(0,s.$)("esri.rest.knowledgeGraph.Path")],l)},37549:function(e,t,n){n.d(t,{$C:function(){return b},Hh:function(){return s},J:function(){return u},JT:function(){return l},Tu:function(){return f},Wg:function(){return g},Xq:function(){return T},aQ:function(){return p},i6:function(){return w},pM:function(){return m},tx:function(){return a},vJ:function(){return _}});var r=n(44764);let i,o=null;function s(){return i||(i=n.e(2933).then(n.bind(n,22933)).then((e=>e.l)).then((({default:e})=>e({locateFile:e=>(0,r.s)(`esri/libs/linkchartlayout/${e}`)}))).then((e=>{!function(e){o=e}(e)})),i)}var a,l,u,p,d;(d=a||(a={}))[d.None=0]="None",d[d.IsMovable=1]="IsMovable",d[d.IsGeographic=2]="IsGeographic",d[d.IsRoot=4]="IsRoot",d[d.IsOld=8]="IsOld",function(e){e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Canceled=2]="Canceled"}(l||(l={})),function(e){e[e.Regular=0]="Regular",e[e.Curved=1]="Curved",e[e.Recursive=2]="Recursive"}(u||(u={})),function(e){e[e.right=0]="right",e[e.left=1]="left",e[e.top=2]="top",e[e.bottom=3]="bottom"}(p||(p={}));const c={none:0,"start-only":1,"start-and-end":2};function y(e){const t={timeDirection:"right",timeBannerUTCOffsetInMinutes:0,eventsTicksVisualization:"start-and-end",showDurationLineForNonZeroDurationEntityEvents:!0,durationLineWidth:5,entityPositionAtDurationRatio:1,showNonZeroDurationIntervalBounds:!1,separateTimeOverlaps:!0,separateTimelineOverlaps:!0,moveFirstBends:!0,secondBendRatio:.3,lineSeparationMultiplier:1,spaceSeparatedLinesEvenly:!1,useBezierCurves:!1,separatedLineShapeRatio:0,...e?.toJSON()??{},eventsTicksVisualization:e?.eventsTicksVisualization??"start-and-end"};return{...t,timeDirection:{value:p[t.timeDirection]??p.right},eventsTicksVisualization:{value:c[t.eventsTicksVisualization]??c["start-and-end"]}}}function h(e,t,n,r,i,s){const a=n.length,u=i.length,p=Float64Array.BYTES_PER_ELEMENT,d=Uint32Array.BYTES_PER_ELEMENT,c=Uint8Array.BYTES_PER_ELEMENT,y=16+a*(c+2*p)+u*(2*d),h=o._malloc(y);try{const c=h+16-h%16,y=c+a*p,m=y+a*p,f=m+u*d,g=f+u*d,b=()=>[o.HEAPF64.subarray(c>>3,(c>>3)+a),o.HEAPF64.subarray(y>>3,(y>>3)+a),o.HEAPU32.subarray(m>>2,(m>>2)+u),o.HEAPU32.subarray(f>>2,(f>>2)+u),o.HEAPU8.subarray(g,g+a)],[_,T,w,I,M]=b();_.set(n),T.set(r),w.set(i),I.set(s),M.set(t);const E=e(a,g,c,y,u,m,f);let A=null,v=null;if(E.value===l.Success){const e=o.getLayoutLinksTypes(),t=o.getLayoutLinksVerticesEndIndices(),n=o.getLayoutLinksVertices(),r=o.countLayoutLinksVertices();!u||e&&t?r&&!n?E.value=l.Error:(A={types:new Uint8Array(o.HEAPU8.subarray(e,e+u)),vertexEndIndex:new Uint32Array(o.HEAPU32.subarray(t>>2,(t>>2)+u)),vertices:new Float64Array(o.HEAPF64.subarray(n>>3,(n>>3)+2*r))},v=o.getAuxiliaryGraphicElements()):E.value=l.Error}const[N,S,L,C,R]=b();return n.set(N),r.set(S),i.set(L),s.set(C),t.set(R),{status:E.value,links:A,graphics:v}}finally{o._free(h),o.cleanupLayout()}}var m,f,g,b,_,T,w,I,M;!function(e){e.getMinIdealEdgeLength=function(){return o.getMinIdealEdgeLength()},e.apply=function(e,t,n,r,i,s,a=2,l=1,u=-1){return h(((t,n,r,i,s,p,d)=>o.applyForceDirectedLayout(e,t,n,r,i,s,p,d,a,l,u)),t,n,r,i,s)}}(m||(m={})),function(e){e.apply=function(e,t,n,r,i,s,a=2,l=1,u=-1){return h(((t,n,r,i,s,p,d)=>o.applyCommunityLayout(e,t,n,r,i,s,p,d,a,l,u)),t,n,r,i,s)}}(f||(f={})),function(e){e.apply=function(e,t,n,r,i,s){return h(((t,n,r,i,s,a,l)=>o.applySimpleLayout(e,t,n,r,i,s,a,l)),t,n,r,i,s)}}(g||(g={})),function(e){e.apply=function(e,t,n,r,i,s){return h(((t,n,r,i,s,a,l)=>o.applyHierarchicalLayout(e,t,n,r,i,s,a,l)),t,n,r,i,s)}}(b||(b={})),function(e){e.apply=function(e,t,n,r,i,s){return h(((t,n,r,i,s,a,l)=>o.applyRadialTreeLayout(e,t,n,r,i,s,a,l)),t,n,r,i,s)}}(_||(_={})),function(e){e.apply=function(e,t,n,r,i,s){return h(((t,n,r,i,s,a,l)=>o.applySmartTreeLayout(e,t,n,r,i,s,a,l)),t,n,r,i,s)}}(T||(T={})),function(e){e.apply=function(e,t,n,r,i,s,a,u,p,d,c,m){return h(((t,n,r,a,u,h,f)=>{if(i.length!==t)return{value:l.Error};if(s.length!==t)return{value:l.Error};if(p.length!==u)return{value:l.Error};if(d.length!==u)return{value:l.Error};const g=Float64Array.BYTES_PER_ELEMENT,b=16,_=o._malloc(b+t*g),T=o._malloc(b+t*g),w=o._malloc(b+u*g),I=o._malloc(b+u*g),M=_+b-_%b,E=T+b-T%b,A=w+b-w%b,v=I+b-I%b;try{return o.HEAPF64.subarray(M>>3,(M>>3)+t).set(i),o.HEAPF64.subarray(E>>3,(E>>3)+t).set(s),o.HEAPF64.subarray(A>>3,(A>>3)+u).set(p),o.HEAPF64.subarray(v>>3,(v>>3)+u).set(d),o.applyChronologicalLayout(e,t,n,r,a,M,E,u,h,f,A,v,c,y(m))}finally{o._free(_),o._free(T),o._free(w),o._free(I)}}),t,n,r,a,u)}}(w||(w={})),function(e){e[e.Undirected=0]="Undirected",e[e.Directed=1]="Directed",e[e.Reversed=2]="Reversed"}(I||(I={})),function(e){e[e.ByCC_Raw=0]="ByCC_Raw",e[e.ByCC_NormalizeGlobally=1]="ByCC_NormalizeGlobally",e[e.ByCC_NormalizeByCC=2]="ByCC_NormalizeByCC"}(M||(M={}))},60097:function(e,t,n){n.d(t,{A:function(){return s}});var r=n(82392),i=(n(80861),n(6273),n(67498),n(62991),n(26325)),o=n(92450);let s=class extends o.A{constructor(e){super(e)}};s=(0,r._)([(0,i.$)("esri.rest.knowledgeGraph.ObjectValue")],s)},60105:function(e,t,n){n.d(t,{T:function(){return i}});var r=n(85747);const i={getObjectId:e=>e.objectId,getAttributes:e=>e.attributes,getAttribute:(e,t)=>e.attributes[t],cloneWithGeometry:(e,t)=>new r.Om(t,e.attributes,null,e.objectId),getGeometry:e=>e.geometry,getCentroid:(e,t)=>e.ensureCentroid(t)}},75345:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(56053),i=n(5525),o=n(85747),s=n(77692);class a{constructor(){this._featureLookup=new Map}static getInstance(){return a.instance||(a.instance=new a),a.instance}static resetInstance(){a.instance&&(a.instance=null)}deleteFromStore(e){e.forEach((e=>{this._featureLookup.delete(e)}))}readFromStoreByList(e){const t=[];return e.forEach((e=>{const n=this.readFromStoreById(e);n&&t.push(n)})),t}readFromStoreById(e){return this._featureLookup.get(e)??null}writeToStore(e,t,n){const a=[];return e.forEach((e=>{if(!e?.id)return;e.properties||(e.properties=[]);let l,u=null;if(n&&e.properties[n]&&(u=(0,i.Ux)(e.properties[n])),"originId"in e&&"destinationId"in e&&(e.properties[s.Cz]=e.originId,e.properties[s.KQ]=e.destinationId),e.properties[t]=e.id,e.id&&this._featureLookup.has(e.id)&&this._featureLookup.get(e.id).attributes){const i=this._featureLookup.get(e.id),s=JSON.parse(JSON.stringify(Object.assign(i.attributes,e.properties)));n&&e.properties[n]&&(s[n]=(0,r.rS)(e.properties[n])),l=new o.Om(u?JSON.parse(JSON.stringify(u)):i?.geometry?JSON.parse(JSON.stringify(i.geometry)):null,s,null,e.properties[t])}else l=new o.Om(u?JSON.parse(JSON.stringify(u)):null,e.properties,null,e.properties[t]);this._featureLookup.set(`${e.typeName?`${e.typeName}__${e.id}`:e.id}`,l),a.push(l)})),a}}},77159:function(e,t,n){n.d(t,{F0:function(){return a},Vx:function(){return p},e2:function(){return c},f:function(){return y}});var r=n(6273),i=n(15565),o=n(52557),s=n(51103);function a(e){return{renderer:{type:"simple",symbol:"esriGeometryPoint"===e||"esriGeometryMultipoint"===e?s.Cb:"esriGeometryPolyline"===e?s.yM:s.WR}}}const l=/^[_$a-zA-Z][_$a-zA-Z0-9]*$/;let u=1;function p(e,t){if((0,r.A)("esri-csp-restrictions"))return()=>({[t]:null,...e});try{let n=`this${d(t)} = null;`;for(const t in e)n+=`this${d(t)} = ${JSON.stringify(e[t])};`;const r=new Function(`\n      return class AttributesClass$${u++} {\n        constructor() {\n          ${n};\n        }\n      }\n    `)();return()=>new r}catch(n){return()=>({[t]:null,...e})}}function d(e){return l.test(e)?`.${e}`:`["${e}"]`}function c(e={}){return[{name:"New Feature",description:"",prototype:{attributes:(0,i.o8)(e)}}]}function y(e,t){return{analytics:{supportsCacheHint:!1},attachment:null,data:{isVersioned:!1,isBranchVersioned:!1,supportsAttachment:!1,supportsM:!1,supportsZ:e},metadata:{supportsAdvancedFieldProperties:!1},operations:{supportsCalculate:!1,supportsTruncate:!1,supportsValidateSql:!1,supportsAdd:t,supportsDelete:t,supportsEditing:t,supportsChangeTracking:!1,supportsQuery:!0,supportsQueryBins:!0,supportsQueryAnalytics:!1,supportsQueryAttachments:!1,supportsQueryTopFeatures:!1,supportsResizeAttachments:!1,supportsSync:!1,supportsUpdate:t,supportsExceedsLimitStatistics:!0,supportsAsyncConvert3D:!1},query:o.F,queryRelated:{supportsCount:!0,supportsOrderBy:!0,supportsPagination:!0,supportsCacheHint:!1},queryTopFeatures:{supportsCacheHint:!1},queryAttributeBins:o.P,editing:{supportsGeometryUpdate:t,supportsGlobalId:!1,supportsReturnServiceEditsInSourceSpatialReference:!1,supportsRollbackOnFailure:!1,supportsUpdateWithoutM:!1,supportsUploadWithItemId:!1,supportsDeleteByAnonymous:!1,supportsDeleteByOthers:!1,supportsUpdateByAnonymous:!1,supportsUpdateByOthers:!1,supportsAsyncApplyEdits:!1,zDefault:void 0}}}},77692:function(e,t,n){n.d(t,{BL:function(){return l},Cz:function(){return i},KQ:function(){return o},M1:function(){return a},T1:function(){return s},dr:function(){return r}});const r="ESRI__ID",i="ESRI__OriginID",o="ESRI__DestID",s="ESRI__LayoutGeometry",a="ESRI__AggregationCount",l="LC.ESRI__IsSpatial"},80211:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(82392),i=n(81482),o=(n(6273),n(80861),n(67498),n(26325)),s=n(92450);let a=class extends s.A{constructor(e){super(e),this.typeName=null,this.id=null}};(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"typeName",void 0),(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],a.prototype,"id",void 0),a=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.GraphNamedObject")],a)},81114:function(e,t,n){n.d(t,{A:function(){return l}});var r=n(82392),i=n(81482),o=(n(6273),n(80861),n(67498),n(26325)),s=n(1912),a=n(80211);let l=class extends a.A{constructor(e){super(e),this.layoutGeometry=null}};(0,r._)([(0,i.MZ)({type:s.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.Entity")],l)},83441:function(e,t,n){n.d(t,{P:function(){return I}});var r=n(82392),i=n(73783),o=n(62991),s=n(80861),a=n(80294),l=n(37623),u=n(80189),p=n(81482),d=(n(6273),n(67498),n(26325)),c=n(8e3),y=n(65648),h=n(34008),m=n(67488),f=n(77692),g=n(75345),b=n(12199),_=n(88259),T=n(23783),w=n(33432);let I=class extends i.A{constructor(e){super(e),this._processingCacheUpdatesLookup=new Map,this.knowledgeGraph=null,this.inclusionModeDefinition={generateAllSublayers:!0,namedTypeDefinitions:new Map},this.entityTypeNames=new Set,this.relationshipTypeNames=new Set,this.geographicLookup=new Map,this.sublayerCaches=new Map,this.nodeConnectionsLookup=new Map,this.relationshipConnectionsLookup=new Map,this.memberIdTypeLookup=new Map;const t=new Map;e.knowledgeGraph.dataModel.entityTypes?.forEach((n=>{n.name&&(t.set(n.name,"entity"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.entityTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.knowledgeGraph.dataModel.relationshipTypes?.forEach((n=>{n.name&&(t.set(n.name,"relationship"),this._processingCacheUpdatesLookup.set(n.name,[]),e.inclusionModeDefinition&&!e.inclusionModeDefinition?.generateAllSublayers||this.relationshipTypeNames.add(n.name),n.properties?.forEach((e=>{e.geometryType&&"esriGeometryNull"!==e.geometryType&&this.geographicLookup.set(n.name,{name:e.name??"",geometryType:e.geometryType})})))})),e.inclusionModeDefinition?.namedTypeDefinitions.forEach(((n,r)=>{if("entity"===t.get(r))this.entityTypeNames.add(r);else{if("relationship"!==t.get(r))return s.A.getLogger(this).warn(`A named type, ${r}, was in the inclusion list that wasn't in the data model and will be removed`),void e.inclusionModeDefinition?.namedTypeDefinitions.delete(r);this.relationshipTypeNames.add(r)}const i=new Map;n.members?.forEach((e=>{(0,a.tE)(this.memberIdTypeLookup,e.id,(()=>new Set)).add(r);const t=this.getById(e.id);t&&i.set(e.id,t)})),this.sublayerCaches.set(r,i)}))}addToLayer(e){e.forEach((({typeName:e,id:t})=>{if(!this.inclusionModeDefinition)throw new o.A("knowledge-graph:layer-data-manager","You cannot add to a layer's exclusion list if it was not created with an exclusion list originally");if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){if(this.inclusionModeDefinition.namedTypeDefinitions.has(e)){const n=this.inclusionModeDefinition.namedTypeDefinitions.get(e);n.members||(n.members=new Map),n.members.set(t,{id:t}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}else{const n=new Map;n.set(t,{id:t}),this.inclusionModeDefinition.namedTypeDefinitions.set(e,{useAllData:!1,members:n}),(0,a.tE)(this.memberIdTypeLookup,t,(()=>new Set)).add(e)}}))}getById(e){return g.A.getInstance().readFromStoreById(e)}async getData(e,t,n){if(t.objectType.name&&this.inclusionModeDefinition?.namedTypeDefinitions&&this.inclusionModeDefinition.namedTypeDefinitions.size>0&&!this.inclusionModeDefinition.namedTypeDefinitions.has(t.objectType.name))return[];let r;if(r=e||new w.A({where:"1=1",outFields:["*"]}),"link-chart"===t.parentCompositeLayer.type){const e=t.parentCompositeLayer,n=this._processingCacheUpdatesLookup.get(t.objectType.name??""),i=r.outFields;i&&1===i.length&&i[0]===f.dr&&"1=1"===r.where||await Promise.all(n??[]);const o=this.sublayerCaches.has(t.objectType.name??"")?Array.from(this.sublayerCaches.get(t.objectType.name)?.values()):[],s=[];return o.forEach((n=>{if(this.relationshipTypeNames.has(t.objectType.name)){n.geometry=e.relationshipLinkChartDiagramLookup.get(n.attributes[t.objectIdField]);const r=this.memberIdTypeLookup.get(n.attributes[f.Cz]),i=this.memberIdTypeLookup.get(n.attributes[f.KQ]),o=this._isEndEntitySpatial(r,n,f.Cz),s=this._isEndEntitySpatial(i,n,f.KQ);n.attributes[f.BL]=Number(o&&s)}else{n.geometry=e.entityLinkChartDiagramLookup.get(n.attributes[t.objectIdField]);const r=this.geographicLookup.get(t.objectType.name);r&&n.attributes[r.name]?n.attributes[f.BL]=1:n.attributes[f.BL]=0}n.attributes[f.T1]=n.geometry,s.push(n)})),s}return this.retrieveDataFromService(r,t,n)}async getConnectedRecordIds(e,t,n){const r=[];let i="";const o=this._getNamedTypeIdMapFromNodeIds(e);if(t&&0!==t?.length){for(const e of t)i=i+e+"|";i=i.slice(0,-1)}const s={},a=[];for(const[e,n]of o){const r=`${e}_ids`;s[r]=n,t&&0!==t?.length?a.push(`MATCH (n:${e}) WHERE id(n) IN $${r} WITH n MATCH (n)-[r:${i}]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`):a.push(`MATCH (n:${e}) WHERE id(n) IN $${r} WITH n MATCH (n)-[r]-(m) RETURN id(r), type(r), id(m), labels(m)[0]`)}if(!a.length)return r;const l=a.join(" UNION "),u=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:l,bindParameters:s}),{signal:n?.signal})).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await u.read();if(e)break;for(let e=0;e<t.length;e++){const n=t[e];r.push({id:n[0],typeName:n[1]}),r.push({id:n[2],typeName:n[3]})}}return r}async getRelationshipsBetweenNodes(e,t,n){const r=this._getNamedTypeIdMapFromNodeIds(e);if(0===r.size)return[];const i={relationshipExclusionIds:t,possibleConnectionEntityIds:e},o=[];for(const[e,t]of r.entries()){const n=`${e}_ids`;i[n]=t,o.push(`MATCH (n:${e}) WHERE id(n) IN $${n} WITH n MATCH (n)-[r]->(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const s=o.join(" UNION "),a=[],l=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:s,bindParameters:i}),{signal:n?.signal})).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await l.read();if(e)break;for(let e=0;e<t.length;e++){const n=t[e];a.push({id:n[0],typeName:n[1]})}}return a}async getRelationshipsFromNodes(e,t,n,r){const i=this._getNamedTypeIdMapFromNodeIds(e);if(0===i.size||0===t.length)return[];const o={relationshipExclusionIds:n,possibleConnectionEntityIds:t},s=[];for(const[e,t]of i.entries()){const n=`${e}_ids`;o[n]=t,s.push(`MATCH (n:${e}) WHERE id(n) IN $${n} WITH n MATCH (n)-[r]-(m) WHERE id(m) IN $possibleConnectionEntityIds AND NOT id(r) IN $relationshipExclusionIds RETURN id(r), type(r)`)}const a=s.join(" UNION "),l=new Map,u=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,new T.A({openCypherQuery:a,bindParameters:o}),{signal:r?.signal})).resultRowsStream.getReader();for(;;){const{done:e,value:t}=await u.read();if(e)break;for(let e=0;e<t.length;e++){const n=t[e];let r=l.get(n[1]);r||(r=new Set,l.set(n[1],r)),r.add(n[0])}}const p=[];for(const[e,t]of l)for(const n of t)p.push({id:n,typeName:e});return p}async refreshCacheContent(e,t,n,r=!0,i){const s=g.A.getInstance(),u=[],p=new Map,d=new Map;this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&d.set(e.name,e)})),this.knowledgeGraph.dataModel.relationshipTypes?.forEach((e=>{e.name&&d.set(e.name,e)})),e||this.inclusionModeDefinition?e?e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const t of this.memberIdTypeLookup.get(e))p.has(t)?p.get(t)?.push(e):p.set(t,[e])})):this.inclusionModeDefinition?.namedTypeDefinitions?.forEach(((e,t)=>{e.useAllData?p.set(t,null):e.members&&e.members.forEach((e=>{p.has(t)&&null!==p.get(t)?p.get(t)?.push(e.id):p.set(t,[e.id])}))})):(this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&p.set(e.name,null)})),this.knowledgeGraph.dataModel.entityTypes?.forEach((e=>{e.name&&p.set(e.name,null)})));for(const[e,l]of p){const p=new Set(l),c=new Promise(((u,c)=>{(async()=>{const u=new Set,c=[];let y,h="",m=!1;if(t||d.get(e)?.properties?.forEach((e=>{e.name&&u.add(e.name)})),n&&this.geographicLookup.has(e)){const t=this.geographicLookup.get(e)?.name;t&&u.add(t)}if(this.entityTypeNames.has(e))h=`MATCH (n:${e}) ${l?"WHERE id(n) IN $ids ":""}return ID(n)`,u.forEach((e=>{h+=`, n.${e}`,c.push(e)}));else{if(!this.relationshipTypeNames.has(e))throw new o.A("knowledge-graph:layer-data-manager",`The graph type of ${e} could not be determined. Was this type set in the KG data model and inclusion definition?`);m=!0,h=`MATCH ()-[n:${e}]->() ${l?"WHERE id(n) IN $ids ":""}return ID(n), id(startNode(n)), id(endNode(n))`,u.forEach((e=>{h+=`, n.${e}`,c.push(e)}))}y=new T.A(l?{openCypherQuery:h,bindParameters:{ids:l}}:{openCypherQuery:h});const g=(await(0,_.executeQueryStreaming)(this.knowledgeGraph,y,{signal:i?.signal})).resultRowsStream.getReader();for(;;){const{done:t,value:n}=await g.read();if(t)break;const i=[];for(let e=0;e<n.length;e++){const t=n[e];let r=0,o=0;const s={properties:{}};for(s.id=t[r],r++,o++,m&&(s.originId=t[r],r++,o++,s.destinationId=t[r],r++,o++,(0,a.tE)(this.nodeConnectionsLookup,s.originId,(()=>new Set)).add(s.id),(0,a.tE)(this.nodeConnectionsLookup,s.destinationId,(()=>new Set)).add(s.id),(0,a.tE)(this.relationshipConnectionsLookup,s.id,(()=>[s.originId,s.destinationId])));r<t.length;r++)s.properties[c[r-o]]=t[r];p.delete(s.id),i.push(s)}const o=s.writeToStore(i,f.dr,this.geographicLookup.get(e)?.name);this.sublayerCaches.has(e)||this.sublayerCaches.set(e,new Map),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.has(e)&&this.inclusionModeDefinition?.namedTypeDefinitions.set(e,{useAllData:!1,members:new Map}),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members&&(this.inclusionModeDefinition.namedTypeDefinitions.get(e).members=new Map);const l=this.sublayerCaches.get(e);o.forEach((t=>{l?.set(t.attributes[f.dr],t),r&&!this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.has(t.attributes[f.dr])&&(this.inclusionModeDefinition?.namedTypeDefinitions.get(e).members.set(t.attributes[f.dr],{id:t.attributes[f.dr]}),(0,a.tE)(this.memberIdTypeLookup,t.attributes[f.dr],(()=>new Set)).add(e))}))}const b=this.inclusionModeDefinition?.namedTypeDefinitions.get(e);if(b)for(const e of p)b.members?.delete(e)})().then((()=>{u(null)})).catch((e=>{"AbortError"===e.name?u(null):c(e)}))}));u.push(c),this._processingCacheUpdatesLookup.get(e)?.push(c)}if(await Promise.all(u),i?.signal?.aborted)throw(0,l.NK)()}removeFromLayer(e){const t=new Set,n=new Set(e.map((e=>e.id)));for(const n of e)t.add(n.typeName),1===this.memberIdTypeLookup.get(n.id)?.size?this.memberIdTypeLookup.delete(n.id):this.memberIdTypeLookup.get(n.id)?.delete(n.typeName),this.inclusionModeDefinition?.namedTypeDefinitions.forEach(((e,t)=>{t===n.typeName&&e.members?.has(n.id)&&e.members.delete(n.id)}));t.forEach((e=>{this.sublayerCaches.get(e)?.forEach(((t,r)=>{n.has(r)&&this.sublayerCaches.get(e)?.delete(r)}))}))}async retrieveDataFromService(e,t,n){const r=g.A.getInstance(),i=new Set,s=[];let a,l="",p=[];const d="relationship"===t.graphType,w=this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData,I=t.parentCompositeLayer.sublayerIdsCache.get(t.objectType.name);let M=!w&&I?Array.from(I).sort():null;if(this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData)this.inclusionModeDefinition?.namedTypeDefinitions?.get(t.objectType.name)?.useAllData&&null!=e.objectIds&&(M=e.objectIds);else if(null!=e.objectIds&&M&&M.length>0){const t=e.objectIds;e.objectIds=M.filter((e=>t.includes(e)))}else if(null!=e.objectIds)M=e.objectIds;else{if(this.inclusionModeDefinition?.namedTypeDefinitions.has(t.objectType.name)&&(!this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members||this.inclusionModeDefinition.namedTypeDefinitions.get(t.objectType.name)?.members?.size<1))return e.objectIds=[],[];e.objectIds=M}if(null!=e.outFields){const n=e.outFields;n.includes("*")?t.fields.forEach((e=>{i.add(e.name)})):n.forEach((e=>{e!==f.dr&&e!==t.geometryFieldName&&i.add(e)}))}if(null!=e.geometry){const n=e.geometry;let r;const p=t.parentCompositeLayer.dataManager.knowledgeGraph.serviceDefinition,f=p?.spatialReference,g=p?.serviceCapabilities?.geometryCapabilities;let _=g?.geometryMaxBoundingRectangleSizeX,w=g?.geometryMaxBoundingRectangleSizeY;if("point"===n.type){let e=n;e.spatialReference?.isWGS84||(await(0,h.initializeProjection)(e.spatialReference,m.KK),e=(0,h.project)(e,m.KK)),r=new c.A({spatialReference:m.KK,xmin:e.x-1e-4,ymin:e.y-1e-4,xmax:e.x+1e-4,ymax:e.y+1e-4})}else n?.extent?.spatialReference&&!n.spatialReference?.isWGS84?(await(0,h.initializeProjection)(n.extent.spatialReference,m.KK),r=(0,h.project)(n.extent,m.KK)):r=n.extent;if(_&&w&&f){if(4326!==f.wkid){const e=new c.A({spatialReference:f,xmax:_,ymax:w}),t=(0,h.project)(e,m.KK);_=t.xmax,w=t.ymax}if(r.xmax-r.xmin>_)throw new o.A("knowledge-graph:layer-data-manager",`Extent x bounds should be within ${_}° latitude, limit exceeded`);if(r.ymax-r.ymin>w)throw new o.A("knowledge-graph:layer-data-manager",`Extent y bounds should be within ${w}° longitude, limit exceeded`)}if(null!=e.where&&"1=1"!==e.where){const n=await(0,u.GP)(e.where.toUpperCase(),t.fieldsIndex);t.fields.forEach((e=>{n.fieldNames.includes(e.name)&&i.add(e.name)}))}l=d?`Match ()-[n:${t.objectType.name}]->() WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n), id(startNode(r)), id(endNode(r))`:`Match (n:${t.objectType.name}) WHERE esri.graph.ST_Intersects($param_filter_geom, n.${t.geometryFieldName}) return ID(n)`,t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{l+=`, n.${e}`,s.push(e)})),a=new T.A({openCypherQuery:l,bindParameters:{param_filter_geom:new y.A({rings:(0,b.Wq)(r)})}})}else{let n="";if(null!=e.where&&"1=1"!==e.where){const r=await(0,u.GP)(e.where,t.fieldsIndex);t.fields.forEach((e=>{r.fieldNames.includes(e.name)&&i.add(e.name)}));const o=new Set(["column-reference","string","number","binary-expression"]),s=new Set(["=","<","<=","<>",">",">=","AND","OR","LIKE"]);let a=!1;const l=e=>{if("column-reference"===e.type)return`n.${e.column}`;if("string"===e.type)return`'${e.value}'`;if("number"===e.type)return`${e.value}`;if("binary-expression"===e.type&&o.has(e.left.type)&&o.has(e.right.type)&&s.has(e.operator))return`${l(e.left)} ${e.operator} ${l(e.right)}`;if("binary-expression"===e.type&&"LIKE"===e.operator){let t="";if("function"===e.left.type&&"column-reference"===e.left.args.value[0].type)t+=`lower(n.${e.left.args.value[0].column})`;else{if("column-reference"!==e.left.type)return a=!0,"";t+=`lower(n.${e.left.column})`}if(t+=" CONTAINS (","string"!==e.right.type)return a=!0,"";{let n=e.right.value;"%"===n.charAt(0)&&(n=n.slice(1)),"%"===n.charAt(n.length-1)&&(n=n.slice(0,-1)),t+=`'${n.toLowerCase()}')`}return t}return a=!0,""};n=l(r.parseTree),a&&(n="")}let r="";r=d?`Match ()-[n:${t.objectType.name}]->()`:`Match (n:${t.objectType.name})`;let o=!1;M&&(o=!0,r+=" WHERE ID(n) IN $ids"),n&&(r+=o?" AND":" WHERE",r+=` ${n}`),r+=" return ID(n)",d&&(r+=", id(startNode(n)), id(endNode(n))"),e.returnGeometry&&t.geometryFieldName&&i.add(t.geometryFieldName),i.forEach((e=>{r+=`, n.${e}`,s.push(e)})),a=new T.A(M?{openCypherQuery:r,bindParameters:{ids:M}}:{openCypherQuery:r})}const E=(await(0,_.executeQueryStreaming)(t.parentCompositeLayer.dataManager.knowledgeGraph,a,n)).resultRowsStream.getReader();for(;;){const{done:e,value:n}=await E.read();if(e)break;const i=[];for(let e=0;e<n.length;e++){const t=n[e];let r=0,o=0;const a={properties:{}};for(a.id=t[r],r++,o++,d&&(a.originId=t[r],r++,o++,a.destinationId=t[r],r++,o++);r<t.length;r++)a.properties[s[r-o]]=t[r];i.push(a)}p=p.concat(r.writeToStore(i,f.dr,t.parentCompositeLayer.dataManager.geographicLookup.get(t.objectType.name)?.name))}return p}_isEndEntitySpatial(e,t,n){for(const r of e??[])if(this.entityTypeNames.has(r)){const e=this.geographicLookup.get(r),i=e&&this.sublayerCaches.get(r)?.get(t.attributes[n]);if(e&&i?.attributes[e.name])return!0}return!1}_getNamedTypeIdMapFromNodeIds(e){const t=new Map;return e.forEach((e=>{if(this.memberIdTypeLookup.has(e))for(const n of this.memberIdTypeLookup.get(e)){if(!this.entityTypeNames.has(n))return;t.has(n)?t.get(n)?.push(e):t.set(n,[e])}})),t}};(0,r._)([(0,p.MZ)()],I.prototype,"knowledgeGraph",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"inclusionModeDefinition",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"entityTypeNames",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"relationshipTypeNames",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"geographicLookup",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"sublayerCaches",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"nodeConnectionsLookup",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"relationshipConnectionsLookup",void 0),(0,r._)([(0,p.MZ)()],I.prototype,"memberIdTypeLookup",void 0),I=(0,r._)([(0,d.$)("esri.layers.knowledgeGraph.KnowledgeGraphLayerDataManager")],I)},86309:function(e,t,n){n.d(t,{cZ:function(){return F},XW:function(){return G},fe:function(){return j}});var r,i,o=n(38116),s=n(62991),a=n(80294),l=(n(5525),n(88358)),u=n(44153);class p{constructor(){this.version="",this.queryResult=new d}}class d{constructor(){this.featureResult=new c}}class c{constructor(){this.objectIdFieldName="",this.uniqueIdField=new y,this.globalIdFieldName="",this.geohashFieldName="",this.geometryProperties=new h,this.geometryType=null,this.spatialReference=new u.A,this.exceededTransferLimit=!1,this.hasZ=!1,this.hasM=!1,this.transform=new m,this.fields=[],this.fieldNameToAttributeIndexMap={},this.values=[],this.features=[],this.geometryFields=[]}}class y{constructor(){this.name="",this.isSystemMaintained=!1}}class h{constructor(){this.shapeAreaFieldName="",this.shapeLengthFieldName="",this.units=""}}class m{constructor(){this.quantizeOriginPosition="upperLeft",this.scale=new f,this.translate=new g}}class f{constructor(){this.xScale=0,this.yScale=0,this.mScale=0,this.zScale=0}}class g{constructor(){this.xTranslate=0,this.yTranslate=0,this.mTranslate=0,this.zTranslate=0}}class b{constructor(){this.name="",this.fieldType="esriFieldTypeString",this.alias="",this.sqlType="sqlTypeVarchar",this.domain="",this.defaultValue=""}}class _{constructor(){this.attributes=[],this.compressedGeometry=new T,this.centroid=new T,this.aggregateGeometries=[]}}class T{constructor(){this.geometryType=null,this.lengths=[],this.coords=[]}}(i=r||(r={})).ELEMENTUID="ELEMENTUID",i.TYPENAME="TYPENAME";const w=[r.ELEMENTUID,r.TYPENAME];var I,M;!function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME"}(I||(I={})),function(e){e[e.ELEMENTUID=0]="ELEMENTUID",e[e.TYPENAME=1]="TYPENAME",e[e.FROMUID=2]="FROMUID",e[e.TOUID=3]="TOUID"}(M||(M={}));var E,A,v,N,S=n(24780),L=n(13949);function C(e){const t=new p;t.version=e.version;const n=e.get_query_result();if(0!==n.results_type.value)throw new Error("Got a non-feature collection type");const r=n.get_feature_result(),i=t.queryResult.featureResult;i.objectIdFieldName=r.objectid_field_name,i.exceededTransferLimit=r.exceeded_transfer_limit,i.hasM=r.has_m,i.hasZ=r.has_z,i.geometryType=L.bV[r.geometry_type.value],i.globalIdFieldName=r.globalid_field_name,i.geohashFieldName=r.geohash_field_name;const o=i.uniqueIdField,s=r.unique_id_field;o.name=s.name,o.isSystemMaintained=s.isSystemMaintained;const a=i.geometryProperties,l=r.geometry_properties;a.shapeAreaFieldName=l.shapeAreaFieldName,a.shapeLengthFieldName=l.shapeLengthFieldName,a.units=l.units;const u=i.spatialReference,d=r.spatial_reference;u.wkid=d.wkid,u.latestWkid=d.latestWkid,u.vcsWkid=d.vcsWkid,u.latestVcsWkid=d.latestVcsWkid,u.wkt=d.wkt,i.transform=x(r.transform);const c=i.fields,y=i.fieldNameToAttributeIndexMap,h=r.fields,m=h.size();for(let e=0;e<m;e++){const t=h.get(e),n=D(t);c.push(n),y[n.name]=e,t.delete()}h.delete();const f=i.values,g=r.values_count();for(let e=0;e<g;e++)f.push(r.get_value_at(e));const b=i.features,T=r.features,I=T.size();if(I>0)for(const e of w)if(void 0===y[e])throw new Error(`Feature collection missing required attribute: ${e}`);for(let e=0;e<I;e++){const t=new _,n=T.get(e),r=t.attributes,i=n.attributes_count();for(let e=0;e<i;e++)r.push(n.get_attribute_at(e));const o=n.get_compressed_geometry();o&&(t.compressedGeometry=R(o),t.centroid=R(n.get_centroid()));const s=t.aggregateGeometries,a=n.aggregate_geometries,l=a.size();for(let e=0;e<l;e++){const t=a.get(e),n=R(t);s.push(n),t.delete()}a.delete(),b.push(t),n.delete()}T.delete();const M=i.geometryFields,E=r.geometry_fields,A=E.size();for(let e=0;e<A;e++){const t=E.get(e),n=k(t);M.push(n),t.delete()}return E.delete(),t}function R(e){const t=new T;t.geometryType=L.bV[e.geometry_type.value];const n=[],r=[];for(let t=0;t<e.lengths.length;t++)n.push(e.lengths[t]);for(let t=0;t<e.coords.length;t++)r.push(e.coords[t]);return t.lengths=n,t.coords=r,t}function D(e){const t=new b;return t.name=e.name,t.alias=e.alias,t.fieldType=L.r5[e.field_type.value],t.sqlType=v[e.sql_type.value],t.domain=e.domain,t.defaultValue=e.default_value,t}function k(e){const t=D(e);return t.geometryType=L.bV[e.geometry_type.value],t}function x(e){const t=new m;t.quantizeOriginPosition=A[e.quantizeOriginPosition.value];const n=t.scale,r=e.scale;n.xScale=r.xScale,n.yScale=r.yScale,n.mScale=r.mScale,n.zScale=r.zScale;const i=t.translate,o=e.translate;return i.xTranslate=o.xTranslate,i.yTranslate=o.yTranslate,i.mTranslate=o.mTranslate,i.zTranslate=o.zTranslate,t}async function F(e,t){t??=!1;const n={generateAllSublayers:t,namedTypeDefinitions:new Map};return await async function(e){const t=await(0,o.A)(e,{responseType:"array-buffer"}),n=await t.data;return async function(e){const t=new((await(0,S.I)()).MapOfObjectIdentifierSetsDecoder),n=t.decode(new Uint8Array(e)),r=new Map;if(0!==n.error_code)throw new s.A("knowledge-graph:layer-support-utils",n.error_message);const i=t.get_map_of_identifier_sets(),o=i.keys,a=o.size();for(let e=0;e<a;e++){const t=o.get(e),n=i.query_identifier_set(t),a=[];if(n.id_array_type.value===N.GLOBALID_ARRAY){const e=n.get_globalid_array(),t=e.count();for(let n=0;n<t;n++)a.push(e.get_globalid_at(n))}else if(n.id_array_type.value===N.IDENTIFIER_ARRAY){const e=n.get_identifier_array(),t=e.count();for(let n=0;n<t;n++)a.push(e.get_identifier_at(n).toString())}else if(n.id_array_type.value===N.STRING_ARRAY){const e=n.get_string_array(),t=e.count();for(let n=0;n<t;n++)a.push(e.get_string_at(n))}else{if(n.id_array_type.value!==N.OID_ARRAY)throw new s.A("knowledge-graph:layer-support-utils","Tried to encode an unexpected ID Array type.");{const e=n.get_oid_array(),t=e.count();for(let n=0;n<t;n++)a.push(e.get_objectid_at(n).toString())}}r.set(t,a)}return t.delete(),r}(new Uint8Array(n))}(e).then((e=>{!function(e,t){for(const[n,r]of e){const e=(0,a.tE)(t.namedTypeDefinitions,n,(()=>({useAllData:!1,members:new Map})));for(const t of r)e.members.has(t)||e.members.set(t,{id:t})}}(e,n)})),n}async function j(e){const t=await(0,S.I)(),n=new t.MapOfObjectIdentifierSets;!function(e,t,n){for(const[r,i]of n.namedTypeDefinitions){if(!i.members||i.useAllData)continue;const n=i.members.keys();let o=!1,s=!0;const a=new t.ObjectIdArray,l=new t.StringArray,u=new t.GlobalIdArray,p=new t.IdentifierArray,d=new t.ObjectIdentifierSet;for(const e of n)s&&(o=!isNaN(Number(e)),s=!1),o?a.add_objectid(Number(e)):(l.add_string(e),u.add_globalid(e)),p.add_identifier(e);d.set_oid_array(a),d.set_string_array(l),d.set_globalid_array(u),d.set_identifier_array(p),a.delete(),l.delete(),u.delete(),p.delete(),e.put_identifier_set(r,d),d.delete()}}(n,t,e);const r=new t.MapOfObjectIdentifierSetsEncoder;try{r.set_map_of_identifier_sets(n),r.encode();const e=r.get_encoding_result();if(0!==e.error.error_code)throw new s.A("knowledge-graph:layer-support-utils",e.error.error_message);const t=structuredClone(e.get_byte_buffer());return r.delete(),t}finally{n.delete()}}async function O(e){const t=await(0,o.A)(e,{responseType:"array-buffer"});return async function(e){const t=new((await(0,S.I)()).FeatureCollectionDecoder),n=t.decode(new Uint8Array(e));if(0!==n.error_code)throw new s.A("knowledge-graph:layer-support-utils",n.error_message);const r=t.get_feature_collection(),i=C(r);return t.delete(),i}(await t.data)}function q(e,t){if(!e?.queryResult?.featureResult)return t;const n=e.queryResult.featureResult.fieldNameToAttributeIndexMap;for(const i of e.queryResult.featureResult.features){const e=i.attributes[n[r.TYPENAME]],o=(0,a.tE)(t.namedTypeDefinitions,e,(()=>({useAllData:!1,members:new Map}))),s=i.attributes[n[r.ELEMENTUID]];if(i.compressedGeometry?.coords?.length>0){let e=i.compressedGeometry.lengths;"esriGeometryPoint"===i.compressedGeometry.geometryType&&(e=[]),o.members.set(s,{id:s,linkChartLocation:new l.A(e,i.compressedGeometry.coords)})}else o.members.set(s,{id:s})}return t}!function(e){e[e.featureResult=0]="featureResult",e[e.countResult=1]="countResult",e[e.idsResult=2]="idsResult"}(E||(E={})),function(e){e[e.upperLeft=0]="upperLeft",e[e.lowerLeft=1]="lowerLeft"}(A||(A={})),function(e){e[e.sqlTypeBigInt=0]="sqlTypeBigInt",e[e.sqlTypeBinary=1]="sqlTypeBinary",e[e.sqlTypeBit=2]="sqlTypeBit",e[e.sqlTypeChar=3]="sqlTypeChar",e[e.sqlTypeDate=4]="sqlTypeDate",e[e.sqlTypeDecimal=5]="sqlTypeDecimal",e[e.sqlTypeDouble=6]="sqlTypeDouble",e[e.sqlTypeFloat=7]="sqlTypeFloat",e[e.sqlTypeGeometry=8]="sqlTypeGeometry",e[e.sqlTypeGUID=9]="sqlTypeGUID",e[e.sqlTypeInteger=10]="sqlTypeInteger",e[e.sqlTypeLongNVarchar=11]="sqlTypeLongNVarchar",e[e.sqlTypeLongVarbinary=12]="sqlTypeLongVarbinary",e[e.sqlTypeLongVarchar=13]="sqlTypeLongVarchar",e[e.sqlTypeNChar=14]="sqlTypeNChar",e[e.sqlTypeNVarChar=15]="sqlTypeNVarChar",e[e.sqlTypeOther=16]="sqlTypeOther",e[e.sqlTypeReal=17]="sqlTypeReal",e[e.sqlTypeSmallInt=18]="sqlTypeSmallInt",e[e.sqlTypeSqlXml=19]="sqlTypeSqlXml",e[e.sqlTypeTime=20]="sqlTypeTime",e[e.sqlTypeTimestamp=21]="sqlTypeTimestamp",e[e.sqlTypeTimestamp2=22]="sqlTypeTimestamp2",e[e.sqlTypeTinyInt=23]="sqlTypeTinyInt",e[e.sqlTypeVarbinary=24]="sqlTypeVarbinary",e[e.sqlTypeVarchar=25]="sqlTypeVarchar"}(v||(v={})),function(e){e[e.OID_ARRAY=0]="OID_ARRAY",e[e.GLOBALID_ARRAY=1]="GLOBALID_ARRAY",e[e.STRING_ARRAY=2]="STRING_ARRAY",e[e.IDENTIFIER_ARRAY=3]="IDENTIFIER_ARRAY"}(N||(N={}));const G={fetchAndConvertSerializedLinkChart:e=>async function(e){const t=[],n={generateAllSublayers:!1,namedTypeDefinitions:new Map};return e.entitiesUrl&&t.push(O(e.entitiesUrl).then((e=>{q(e,n)}))),e.relationshipsUrl&&t.push(O(e.relationshipsUrl).then((e=>{q(e,n)}))),await Promise.all(t),n}(e)}},91582:function(e,t,n){n.d(t,{A:function(){return h}});var r=n(3223),i=n(62991),o=n(57888),s=n(80861),a=n(46373),l=n(2532),u=n(5525),p=n(64411),d=n(84880),c=n(60105);const y=(0,a.vt)();class h{constructor(e){this.geometryInfo=e,this._boundsStore=new p.F,this._featuresById=new Map,this._usedMemory=0,this.events=new o.A,this.featureAdapter=c.T}get usedMemory(){return this._usedMemory}get geometryType(){return this.geometryInfo.geometryType}get hasM(){return this.geometryInfo.hasM}get hasZ(){return this.geometryInfo.hasZ}get numFeatures(){return this._featuresById.size}get fullBounds(){return this._boundsStore.fullBounds}get storeStatistics(){let e=0;return this._featuresById.forEach((t=>{null!=t.geometry&&t.geometry.coords&&(e+=t.geometry.coords.length)})),{featureCount:this._featuresById.size,vertexCount:e/(this.hasZ?this.hasM?4:3:this.hasM?3:2)}}getFullExtent(e){if(null==this.fullBounds)return null;const[t,n,r,i]=this.fullBounds;return{xmin:t,ymin:n,xmax:r,ymax:i,spatialReference:(0,d.ag)(e)}}add(e){this._add(e),this._emitChanged()}addMany(e){for(const t of e)this._add(t);this._emitChanged()}upsertMany(e){const t=e.map((e=>this._upsert(e)));return this._emitChanged(),t.filter(r.Ru)}clear(){this._featuresById.clear(),this._boundsStore.clear(),this._emitChanged(),this._usedMemory=0}removeById(e){const t=this._featuresById.get(e);return t?(this._remove(t),this._emitChanged(),t):null}removeManyById(e){this._boundsStore.invalidateIndex();for(const t of e){const e=this._featuresById.get(t);e&&this._remove(e)}this._emitChanged()}forEachBounds(e,t){for(const n of e){const e=this._boundsStore.get(n.objectId);e&&t((0,a.Jt)(y,e))}}getFeature(e){return this._featuresById.get(e)}has(e){return this._featuresById.has(e)}forEach(e){this._featuresById.forEach((t=>e(t)))}forEachInBounds(e,t){this._boundsStore.forEachInBounds(e,(e=>{t(this._featuresById.get(e))}))}_emitChanged(){this.events.emit("changed",void 0)}_add(e){if(!e)return;const t=e.objectId;if(null==t)return void s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e}));const n=this._featuresById.get(t);let r;if(n?(e.displayId=n.displayId,r=this._boundsStore.get(t),this._boundsStore.delete(t),this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0):null!=this.onFeatureAdd&&this.onFeatureAdd(e),!e.geometry?.coords?.length)return this._boundsStore.set(t,null),void this._featuresById.set(t,e);r=(0,u.jQ)(null!=r?r:(0,l.vt)(),e.geometry,this.geometryInfo.hasZ,this.geometryInfo.hasM),null!=r&&this._boundsStore.set(t,r),this._featuresById.set(t,e),this._usedMemory+=this.estimateFeatureUsedMemory?.(e)??0}_upsert(e){const t=e?.objectId;if(null==t)return s.A.getLogger("esri.layers.graphics.data.FeatureStore").error(new i.A("featurestore:invalid-feature","feature id is missing",{feature:e})),null;const n=this._featuresById.get(t);if(!n)return this._add(e),e;this._usedMemory-=this.estimateFeatureUsedMemory?.(n)??0;const{geometry:r,attributes:o}=e;for(const e in o)n.attributes[e]=o[e];return r&&(n.geometry=r,this._boundsStore.set(t,(0,u.jQ)((0,l.vt)(),r,this.geometryInfo.hasZ,this.geometryInfo.hasM)??null)),this._usedMemory+=this.estimateFeatureUsedMemory?.(n)??0,n}_remove(e){null!=this.onFeatureRemove&&this.onFeatureRemove(e);const t=e.objectId;return this._boundsStore.delete(t),this._featuresById.delete(t),this._usedMemory-=this.estimateFeatureUsedMemory?.(e)??0,e}}},92450:function(e,t,n){n.d(t,{A:function(){return a}});var r=n(82392),i=n(84977),o=n(81482),s=(n(6273),n(80861),n(67498),n(26325));let a=class extends i.A{constructor(e){super(e),this.properties=null}};(0,r._)([(0,o.MZ)({json:{write:!0}})],a.prototype,"properties",void 0),a=(0,r._)([(0,s.$)("esri.rest.knowledgeGraph.GraphObject")],a)},95324:function(e,t,n){n.d(t,{A:function(){return l}});var r=n(82392),i=n(81482),o=(n(6273),n(80861),n(67498),n(26325)),s=n(38648),a=n(80211);let l=class extends a.A{constructor(e){super(e),this.originId=null,this.destinationId=null,this.layoutGeometry=null}};(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"originId",void 0),(0,r._)([(0,i.MZ)({type:String,json:{write:!0}})],l.prototype,"destinationId",void 0),(0,r._)([(0,i.MZ)({type:s.A,json:{write:!0}})],l.prototype,"layoutGeometry",void 0),l=(0,r._)([(0,o.$)("esri.rest.knowledgeGraph.Relationship")],l)},98496:function(e,t,n){n.d(t,{A:function(){return ne}});var r=n(82392),i=n(20879),o=n(15565),s=n(80861),a=n(67214),l=(n(73462),n(81482)),u=(n(6273),n(26325)),p=n(48524),d=n(91101),c=n(8e3),y=n(1912),h=n(65648),m=n(38648),f=n(34008),g=n(44153),b=n(67488),_=n(54483),T=n(45449),w=n(91582),I=n(73461),M=n(77159),E=n(77692);n(67498);const A=(0,n(83693).p)(),v=e=>{let t=class extends e{constructor(){super(...arguments),this.fields=[],this.fieldsIndex=null}};return(0,r._)([(0,l.MZ)(A.fields)],t.prototype,"fields",void 0),(0,r._)([(0,l.MZ)(A.fieldsIndex)],t.prototype,"fieldsIndex",void 0),t=(0,r._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayerBase")],t),t};var N=n(347),S=n(20923),L=n(92008),C=n(23091),R=n(71519),D=n(87917),k=n(51177),x=n(22111),F=n(2960),j=n(9014),O=n(46190),q=n(45352),G=n(46227),$=n(47659),Z=n(6488),P=n(72523),B=n(79645),U=n(29221),Q=n(44695),z=n(74704),H=n(33432),V=n(95610),W=n(54866),J=n(15331);function K(e){if(!e.json)return e;e.json.write=Y(e.json.write);const t=e.json.origins;if(!t)return e;let n;for(n in t){const e=t[n];e&&(e.write=Y(e.write))}return e}function Y(e){return"object"==typeof e&&e?(!1!==e.enabled&&(e.overridePolicy=function(e){const{target:t,writer:n,overridePolicy:r,...i}=e;return function(e,t){const n=ee.call(this,e,t);return n.enabled?{...i,...n}:n}}(e)),e):!0===e?X():e}function X(){return{overridePolicy:ee}}function ee(e,t){const n=!!this.geometryType;let r={enabled:n};return n&&(r={...r,...te.call(this,e,t)}),r}function te(e,t){return{ignoreOrigin:this.originIdOf(t)>d.Gr.DEFAULTS}}let ne=class extends(v((0,L.FJ)((0,R.J)((0,C.F)((0,S.dM)((0,D.fY)((0,F.e)((0,x.j)((0,k.J)((0,a.P)(T.A))))))))))){constructor(e){super(e),this.blendMode="normal",this.capabilities=(0,M.f)(!1,!0),this.charts=null,this.definitionExpression=null,this.displayField="",this.displayFilterEnabled=!0,this.displayFilterInfo=null,this.effect=null,this.elevationInfo=null,this.featureEffect=null,this.graphType=null,this.labelsVisible=!0,this.layerType=null,this.legendEnabled=!0,this.maxScale=0,this.minScale=0,this.objectIdField=E.dr,this.objectType=null,this.opacity=1,this.orderBy=null,this.parent=null,this.parentCompositeLayer=null,this.persistenceEnabled=!0,this.popupEnabled=!0,this.popupTemplate=null,this.refreshInterval=0,this.source={openPorts:()=>this.load().then((()=>{const e=new MessageChannel;return new J.A(e.port1,{channel:e,client:{queryFeatures:(e,t={})=>{const n=H.A.fromJSON(e);return this.queryFeaturesJSON(n,t)}}}),[e.port2]}))},this.type="knowledge-graph-sublayer",this.useViewTime=!0,this.visible=!0}get userHasUpdateItemPrivileges(){return!!this.parent?.userHasUpdateItemPrivileges}get defaultPopupTemplate(){return this.createPopupTemplate()}set featureReduction(e){const t=this._normalizeFeatureReduction(e);this._set("featureReduction",t)}get fields(){const e=[];return this.objectType?.properties?.forEach((t=>{const n="esriFieldTypeOID"===t.fieldType?"esriFieldTypeInteger":t.fieldType;e.push(q.A.fromJSON({name:t.name,type:n,alias:t.alias,defaultValue:t.defaultValue,editable:t.editable,nullable:t.nullable}))})),e.push(q.A.fromJSON({name:this.objectIdField,type:"esriFieldTypeString",alias:this.objectIdField,editable:!1}),q.A.fromJSON({name:E.M1,type:"esriFieldTypeInteger",alias:E.M1,editable:!1}),q.A.fromJSON({name:E.BL,type:"esriFieldTypeInteger",alias:E.BL,editable:!1})),e}get geometryType(){if("link-chart"===this.parentCompositeLayer?.type)return"relationship"===this.graphType?"polyline":"point";const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.geometryType;return t&&"esriGeometryNull"!==t?_.gy.fromJSON(t):null}get geometryFieldName(){if("link-chart"===this.parentCompositeLayer?.type)return E.T1;const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name);return e?.name??null}get graphTypeName(){return this.objectType?.name}get hasM(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasM??!1}get hasZ(){const e=this.parentCompositeLayer?.dataManager.geographicLookup.get(this.objectType?.name),t=e?.name,n=t?this.objectType?.properties?.[t]:null;return n?.hasZ??!1}set labelingInfo(e){this._set("labelingInfo",e)}get labelingInfo(){if(this._isOverridden("labelingInfo"))return this._get("labelingInfo");if(!this.objectType||!this.parentCompositeLayer||!this.graphTypeName)return null;const e=this.objectType.properties?(0,N.MY)(this.objectType.properties):"ESRI__ID";return"link-chart"===this.parentCompositeLayer.type?(0,N.iW)(this.graphType,this.graphTypeName,e):(0,N.e$)(this.graphTypeName,this.geometryType,e)}set renderer(e){(0,G.yp)(e,this.fieldsIndex),this._set("renderer",e)}get renderer(){if(this._isOverridden("renderer"))return this._get("renderer");const e=this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel,t=[...e?.entityTypes??[],...e?.relationshipTypes??[]].map((e=>e.name)).indexOf(this.graphTypeName),n=(0,N.Td)(t);if("link-chart"===this.parentCompositeLayer?.type){if("relationship"===this.graphType)return new B.A({type:"simple",symbol:(0,N.UT)(n)});const e=(0,U.r)((0,M.F0)(_.gy.toJSON("point")).renderer);return(0,W.dt)(e.symbol,n),e}const r=(0,U.r)((0,M.F0)(_.gy.toJSON(this.geometryType)).renderer);return(0,W.dt)(r.symbol,n),r}get spatialReference(){return this.parentCompositeLayer?.dataManager?.knowledgeGraph?.dataModel?.spatialReference??g.A.WGS84}set timeInfo(e){this._set("timeInfo",e)}get title(){return this._isOverridden("title")?this._get("title"):this.graphTypeName}set title(e){this._set("title",e)}writeTitle(e,t){t.title=e??"Layer"}createPopupTemplate(e){return(0,V.tn)(this,e)}createQuery(){return new H.A({where:"1=1",outFields:["*"]})}getField(e){return this.fieldsIndex.get(e)}getFieldDomain(e,t){return null}async queryFeatures(e,t){await this.load();const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e),i=z.A.fromJSON(await r.executeQuery(n.toJSON(),t?.signal));return i.features.forEach((e=>{e.sourceLayer=this})),i}async queryFeaturesJSON(e,t){await this.load();const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return await r.executeQuery(n.toJSON(),t?.signal)}async queryFeatureCount(e,t){await this.load();const{resolvedQuery:n,queryEngine:r}=await this._setupQueryObjects(e);return r.executeQueryForCount(n.toJSON(),t?.signal)}async queryExtent(e={},t){await this.load();const n={...e,returnGeometry:!0},{resolvedQuery:r,queryEngine:i}=await this._setupQueryObjects(n),o=await i.executeQueryForExtent(r.toJSON(),t?.signal);let s;return s=null!=o.extent?.xmin&&null!=o.extent?.xmax&&null!=o.extent?.ymin&&null!=o.extent?.ymax?new c.A(o.extent):new c.A,{count:o.count,extent:s}}async queryObjectIds(e,t){await this.load();const n=H.A.from(e);let r;if("link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)r=this._cachedQueryEngine;else{const e=await this.parentCompositeLayer.dataManager.getData(n,this,t);r=this.loadQueryEngine(e)}return await r.executeQueryForIds(n.toJSON(),t?.signal)}loadQueryEngine(e){const t=new w.A({geometryType:_.gy.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ}),n=new I.do({fieldsIndex:this.fieldsIndex.toJSON(),geometryType:_.gy.toJSON(this.geometryType),hasM:this.hasM,hasZ:this.hasZ,featureIdInfo:{type:"object-id",fieldName:this.objectIdField},spatialReference:this.spatialReference.toJSON(),timeInfo:this.timeInfo?.toJSON(),featureStore:t});return n.featureStore.addMany(e),n}async refreshCachedQueryEngine(){const e=await this.parentCompositeLayer.dataManager.getData(new H.A({where:"1=1",outFields:[E.dr]}),this);this._cachedQueryEngine=this.loadQueryEngine(e)}load(e){return this.addResolvingPromise(this.parent.load(e).then((()=>(0,G.sv)(this.timeInfo,this.fieldsIndex)))),Promise.resolve(this)}async _setupQueryObjects(e,t){const n=H.A.from(e),r=n.geometry;if(r&&!r.spatialReference?.isWGS84&&(await(0,f.initializeProjection)(r.spatialReference,b.KK),n.geometry=(0,f.project)(r instanceof h.A||r instanceof m.A||r instanceof y.A?r:r.extent,b.KK)),"link-chart"===this.parentCompositeLayer.type&&this._cachedQueryEngine)return{resolvedQuery:n,queryEngine:this._cachedQueryEngine};const i=await this.parentCompositeLayer.dataManager.getData(n,this,t);return{resolvedQuery:n,queryEngine:this.loadQueryEngine(i)}}};(0,r._)([(0,l.MZ)(K((0,o.o8)(S.sU)))],ne.prototype,"blendMode",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"capabilities",void 0),(0,r._)([(0,l.MZ)({readOnly:!0})],ne.prototype,"userHasUpdateItemPrivileges",null),(0,r._)([(0,l.MZ)({json:{origins:{"web-scene":{write:!1}},write:X()}})],ne.prototype,"charts",void 0),(0,r._)([(0,l.MZ)({readOnly:!0})],ne.prototype,"defaultPopupTemplate",null),(0,r._)([(0,l.MZ)({type:String,json:{origins:{service:{read:!1}},name:"layerDefinition.definitionExpression",write:{ignoreOrigin:!0}}})],ne.prototype,"definitionExpression",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"displayField",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(L.Dp)))],ne.prototype,"displayFilterEnabled",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(L.KV)))],ne.prototype,"displayFilterInfo",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(S.LF)))],ne.prototype,"effect",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"elevationInfo",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(C.Y)))],ne.prototype,"featureEffect",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(O.d)))],ne.prototype,"featureReduction",null),(0,r._)([(0,l.MZ)()],ne.prototype,"fields",null),(0,r._)([(0,l.MZ)()],ne.prototype,"geometryType",null),(0,r._)([(0,l.MZ)()],ne.prototype,"geometryFieldName",null),(0,r._)([(0,l.MZ)({type:["entity","relationship"],nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],ne.prototype,"graphType",void 0),(0,r._)([(0,l.MZ)({type:String,nonNullable:!0,json:{write:{isRequired:!0,ignoreOrigin:!0}}})],ne.prototype,"graphTypeName",null),(0,r._)([(0,l.MZ)()],ne.prototype,"hasM",null),(0,r._)([(0,l.MZ)()],ne.prototype,"hasZ",null),(0,r._)([(0,l.MZ)({type:String,json:{origins:{service:{read:!1},"portal-item":{read:!1}},write:{ignoreOrigin:!0}}})],ne.prototype,"id",void 0),(0,r._)([(0,l.MZ)({type:Boolean,value:!0,nonNullable:!0,json:{name:"showLabels",default:!1,write:{overridePolicy(){return{enabled:!!this.geometryType,alwaysWriteDefaults:!0,ignoreOrigin:!0}}}}})],ne.prototype,"labelsVisible",void 0),(0,r._)([(0,l.MZ)({type:[$.A],json:{name:"layerDefinition.drawingInfo.labelingInfo",read:function(e,t,n){const r=[["ESRI__AGGREGATION_COUNT",E.M1],["ESRI__ORIGIN_ID",E.Cz],["ESRI__DESTINATION_ID",E.KQ],["ESRI__LAYOUT_GEOMETRY",E.T1]];try{for(const t of e)for(const[e,n]of r)t.labelExpression=t.labelExpression?.replaceAll(e,n),t.labelExpressionInfo?.expression&&(t.labelExpressionInfo.expression=t.labelExpressionInfo.expression.replaceAll(e,n))}catch(e){s.A.getLogger(this).warn("Error updating labelingInfo",e)}return(0,Z.w)(e,t,n)},write:X()}})],ne.prototype,"labelingInfo",null),(0,r._)([(0,l.MZ)({readOnly:!0,json:{read:!1,write:{writer(e,t){switch(this.parentCompositeLayer?.type){case"link-chart":t.layerType="LinkChartSubLayer";break;case"knowledge-graph":t.layerType=this.geometryType?"KnowledgeGraphSubLayer":"KnowledgeGraphSubTable"}},isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],ne.prototype,"layerType",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(j.fV)))],ne.prototype,"legendEnabled",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(j.hG)))],ne.prototype,"maxScale",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(j.hn)))],ne.prototype,"minScale",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"objectIdField",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"objectType",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(j.ke)))],ne.prototype,"opacity",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(D.ne)))],ne.prototype,"orderBy",void 0),(0,r._)([(0,l.MZ)({clonable:!1})],ne.prototype,"parent",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"parentCompositeLayer",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(j.M6)))],ne.prototype,"popupEnabled",void 0),(0,r._)([(0,l.MZ)({type:i.A,json:{name:"popupInfo",write:{ignoreOrigin:!0}}})],ne.prototype,"popupTemplate",void 0),(0,r._)([(0,l.MZ)({type:Number,json:{write:{overridePolicy:te}}})],ne.prototype,"refreshInterval",void 0),(0,r._)([(0,l.MZ)({types:Q.Hg,json:{name:"layerDefinition.drawingInfo.renderer",write:X()}})],ne.prototype,"renderer",null),(0,r._)([(0,l.MZ)()],ne.prototype,"source",void 0),(0,r._)([(0,l.MZ)()],ne.prototype,"spatialReference",null),(0,r._)([(0,l.MZ)({type:P.A,json:{name:"layerDefinition.timeInfo",write:!0,origins:{"web-document":{name:"layerDefinition.timeInfo",read:!0,write:!0},"portal-item":{name:"layerDefinition.timeInfo",read:!0,write:!0}}}})],ne.prototype,"timeInfo",null),(0,r._)([(0,l.MZ)({type:String,json:{write:{isRequired:!0,ignoreOrigin:!0,writerEnsuresNonNull:!0}}})],ne.prototype,"title",null),(0,r._)([(0,p.K)("title")],ne.prototype,"writeTitle",null),(0,r._)([(0,l.MZ)({json:{read:!1}})],ne.prototype,"type",void 0),(0,r._)([(0,l.MZ)(K((0,o.o8)(F.B)))],ne.prototype,"useViewTime",void 0),(0,r._)([(0,l.MZ)({type:Boolean,json:{name:"visibility",write:X()}})],ne.prototype,"visible",void 0),ne=(0,r._)([(0,u.$)("esri.layers.knowledgeGraph.KnowledgeGraphSublayer")],ne)}}]);