"use strict";(self.webpackChunkimagery_explorer_apps=self.webpackChunkimagery_explorer_apps||[]).push([[1942],{932:function(t,e,n){n.d(e,{Y7:function(){return A},HS:function(){return S},mm:function(){return E},A:function(){return $},k2:function(){return F},ZA:function(){return x},E8:function(){return w},hF:function(){return g},C5:function(){return _},uK:function(){return v},Pi:function(){return b}});var r=n(82392),i=(n(6273),n(80861)),s=n(21332),o=n(15871);function c(t,e,n){const r=e.split("\n");for(const e of r)if(e.trim().length){{let e="";null!=n&&(e+=`/*id:${n??"000"}*/   `),t.body+=e.padEnd(14)}t.body+=" ".repeat(t.indent)+e+"\n"}}class u{write(t){for(const e of t.rootOutputNodes())t.shouldPruneOutputNode(e)||(e.variableName=this._write(t,e.node));return t}_createVarName(t,e){let n="";return"boolean"!=typeof e&&"number"!=typeof e&&e.debugInfo.name&&(n=`${e.debugInfo.name}_`),`${n}v${t.varCount++}`}_write(t,e,n=!1){if("number"==typeof e)return e.toString();if("boolean"==typeof e)return e.toString();let r=t.getEmit(e);if(r)return r;switch(e.shaderType){case"scope-node":r=this._writeScopeNode(t,e);break;case"primitive-node":r=this._writePrimitiveNode(t,e,n);break;case"function-node":r=this._writeFunctionNode(t,e);break;case"property-access-node":r=this._writePropertyAccessNode(t,e);break;case"property-access-2d-node":r=this._writePropertyAccess2DNode(t,e);break;case"text-node":r=e.text;break;case"block-node":r=this._writeBlockNode(t,e);break;case"condition-node":r=this._writeConditionNode(t,e)}return t.setEmit(e,r),r}_writeScopeNode(t,e){const n=new e.child.constructor;n.setDebugName(e.debugInfo.name);const r=this._write(t,n,!0);return c(t,`{ /*ScopeStart: ${e.uid} ${e.debugInfo.name}*/`),t.indent+=2,c(t,`${r} = ${this._write(t,e.child)};`),t.indent-=2,c(t,`} /*ScopeEnd: ${e.uid} ${e.debugInfo.name}*/`),r}_writeConditionNode(t,e){const n=new e.ifTrue.constructor,r=this._write(t,n,!0);c(t,`if (${this._write(t,e.condition)}) {`),t.indent+=2;const i=t.createSubgraphContext(),s=this._write(i,e.ifTrue);if(t.body+=i.body,s&&c(t,`${r} = ${s};`),t.indent-=2,c(t,"}"),e.ifFalse){c(t,"else {"),t.indent+=2;const n=t.createSubgraphContext(),i=this._write(n,e.ifFalse);t.body+=n.body,i&&c(t,`${r} = ${i};`),t.indent-=2,c(t,"}")}return r}_writeBlockNode(t,e){const{captureList:n,generator:r,returnType:i}=e,s={};for(const e in n){if(!n[e])continue;const r=this._write(t,n[e]);s[e]=r}const o=new i,u=this._write(t,o,!0);if(s.out=u,e.subgraph){const n=t.createSubgraphContext(),r=this._write(n,e.subgraph.child),i=n.body;s.subgraph={varName:r,body:i}}const a=r(s);return c(t,"{\n"),t.indent+=2,c(t,a),t.indent-=2,c(t,"}\n"),u}_writePropertyAccessNode(t,e){const n=this._write(t,e.target);return"string"==typeof e.property&&e.property.includes("[")?`${n}${e.property}`:"string"!=typeof e.property?`${n}[${this._write(t,e.property)}]`:`${n}.${e.property}`}_writePropertyAccess2DNode(t,e){return`${this._write(t,e.target)}[${this._write(t,e.x)}][${this._write(t,e.y)}]`}_writeFunctionNode(t,e){const n=e.returnType.type;if(e.isInfix){const[r,i]=e.children.map((e=>this._write(t,e))),s=this._createVarName(t,e);return c(t,`${n.padEnd(5)} ${s} = ${r} ${e.token} ${i};`,e.uid),s}const r=e.children.map((e=>this._write(t,e))).join(", "),i=this._createVarName(t,e);return c(t,`${n.padEnd(5)} ${i} = ${e.token}(${r});`,e.uid),i}_writePrimitiveNode(t,e,n=!1){const r=t.getInput(e);if(r)return r.isUsed=!0,r.variableName;const i=1===e.children.length&&e.children[0]?.type===e.type;if(!e.isMutable&&(e.isImplicit||i))return this._write(t,e.children[0]);const s=this._createVarName(t,e);if(n)return c(t,`${e.type.padEnd(5)} ${s};`,e.uid),s;const o=!e.debugInfo.name&&!e.isMutable;if(o&&"float"===e.type&&"number"==typeof e.children[0])return Number.isInteger(e.children[0])?e.children[0].toFixed(1):e.children[0].toString();if(o&&"int"===e.type&&"number"==typeof e.children[0]&&Number.isInteger(e.children[0]))return e.children[0].toString();const u=e.children.map((e=>this._write(t,e))).join(", ");return"array"===e.type?(c(t,`${e.type.padEnd(5)} ${s} = [${u}];`,e.uid),s):o?`${e.type}(${u})`:(c(t,`${e.type.padEnd(5)} ${s} = ${e.type}(${u});`,e.uid),s)}}var a=n(82484);class h{constructor(t,e,n){this.variableName=t,this.variableInputType=e,this.node=n,this.type="shader-input",this.isUsed=!1}clone(){return new h(this.variableName,this.variableInputType,(0,a.vA)(this.node))}}class d{constructor(t,e,n){this.outVariableName=t,this.outVariableType=e,this.node=n,this.type="shader-output"}clone(){const t=new d(this.outVariableName,this.outVariableType,(0,a.vA)(this.node));return t.variableName=this.variableName,t}}class l{static createVertex(t,e,n,r,i,s){const o=[];for(const e in t){const r=t[e],i=n.get(e);i?o.push(new h(i,"builtin",r)):o.push(new h("a_"+e,"in",r))}for(const t of r){const e=t.uniformHydrated;o.push(new h(t.uniformName,"uniform",e))}const c=[];for(const t in e){const n=e[t];"glPosition"===t?c.push(new d("gl_Position","builtin",n)):"glPointSize"===t?c.push(new d("gl_PointSize","builtin",n)):c.push(new d("v_"+t,"out",n))}return new l(o,c,i,s)}static createFragment(t,e,n,r,i,s){const o=[],c=Array.from(i.rootOutputNodes());for(const e in t){const r=t[e],i=n.get(e);if(i){o.push(new h(i,"builtin",r));continue}const s=c.find((t=>t.node===r));s&&o.push(new h(s.outVariableName,"in",r))}for(const t of r){const e=t.uniformHydrated;o.push(new h(t.uniformName,"uniform",e))}const u=[];for(const t in e){const r=e[t],i=n.get(t);"discard"===t?u.push(new d(null,"discard",r)):i?u.push(new d(i,"builtin",r)):u.push(new d(t,"out",r))}return new l(o,u,s)}constructor(t,e,n,r){this.type="shader-graph-context",this.indent=0,this.body="",this.varCount=0,this._inputShaderTypesByNodeUid=new Map,this._nodeEmitMap=new Map;for(const e of t)this._inputShaderTypesByNodeUid.set(e.node.uid,e);this._outputShaderTypes=e,this._transformFeedbackBindings=n,this._transformFeedbackNames=new Set(n.map((t=>"v_"+t.propertyKey))),this._usedInFragmentShader=r}shouldPruneOutputNode(t){return!!this._usedInFragmentShader&&"builtin"!==t.outVariableType&&!this._transformFeedbackNames.has(t.outVariableName)&&!this._usedInFragmentShader.has(t.node.uid)}setEmit(t,e){this._nodeEmitMap.set(t.uid,e)}getEmit(t){return this._nodeEmitMap.get(t.uid)}inputs(){return this._inputShaderTypesByNodeUid.values()}getInput(t){return this._inputShaderTypesByNodeUid.get(t.uid)}*rootOutputNodes(){for(const t of this._outputShaderTypes)yield t}*nodes(){const t=[];for(const e of this._outputShaderTypes.values())t.push(e.node);for(;t.length;){const e=t.pop();"number"!=typeof e&&"boolean"!=typeof e&&t.push(...e.children.filter(Boolean)),yield e}}*nodesOfTypeOrFunction(){for(const t of this.nodes())"number"!=typeof t&&"boolean"!=typeof t&&(yield t)}createSubgraphContext(){const t=this.clone();return t.body="",t.indent=this.indent+2,t._nodeEmitMap=new Map(this._nodeEmitMap),t}clone(){const t=new l([],this._outputShaderTypes,this._transformFeedbackBindings,this._usedInFragmentShader);return t._inputShaderTypesByNodeUid=this._inputShaderTypesByNodeUid,t.indent=this.indent,t.body=this.body,t.varCount=this.varCount,t._nodeEmitMap=this._nodeEmitMap,t}insertVertexShader(t){t.vertex.code.add(""),this._insertInputs(t,"vertex"),t.vertex.code.add(""),t.vertex.code.add("// OUTPUTS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this.rootOutputNodes()){const n="builtin"===e.outVariableType;this.shouldPruneOutputNode(e)||(n?t.vertex.code.add(`// ${e.outVariableType.padEnd(7)} ${e.node.type.padEnd(9)} ${e.outVariableName};`):t.vertex.code.add(`${e.outVariableType.padEnd(10)} ${e.node.type.padEnd(9)} ${e.outVariableName};`))}t.vertex.code.add(""),t.vertex.code.add("void main() {"),t.vertex.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())this.shouldPruneOutputNode(e)||t.vertex.code.add(`  ${e.outVariableName} = ${e.variableName};`);t.vertex.code.add("}")}insertFragmentShader(t){this._insertInputs(t,"fragment"),t.fragment.code.add(""),t.fragment.code.add("// OUTPUTS: "),t.fragment.code.add("// --------------------------------------------------------- ");let e=0;for(const n of this.rootOutputNodes())"builtin"===n.outVariableType?t.fragment.code.add(`// ${n.outVariableType.padEnd(7)} ${n.node.type.padEnd(9)} ${n.outVariableName};`):t.outputs.add(n.outVariableName,n.node.type,e++);t.fragment.code.add(""),t.fragment.code.add("void main() {"),t.fragment.code.add("  "+this.body.split("\n").join("\n  "));for(const e of this.rootOutputNodes())"discard"===e.outVariableType?(t.fragment.code.add("  // TODO: Should ensure codegen for discard appears first in fragment shader"),t.fragment.code.add(`  if (${e.variableName}) {`),t.fragment.code.add("    discard;"),t.fragment.code.add("  }"),t.fragment.code.add("  ")):t.fragment.code.add(`  ${e.outVariableName} = ${e.variableName};`);t.fragment.code.add("}")}_insertInputs(t,e){t[e].code.add("// INPUTS: "),t[e].code.add("// --------------------------------------------------------- ");for(const n of this.inputs())n.isUsed&&"builtin"!==n.variableInputType&&("array"===n.node.type?t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.elementType.type.padEnd(9)} ${n.variableName}[${n.node.size}];`):"array-2d"===n.node.type?t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.elementType.type.padEnd(9)} ${n.variableName}[${n.node.size}]; // Emulated 2D Array. Not supported by ES3.0`):t[e].code.add(`${n.variableInputType.padEnd(10)} ${n.node.type.padEnd(9)} ${n.variableName};`))}}var p=n(44636),f=n(43398);function m(t){return new t}function y(t,e,n){const r=t.constructor[e]??[];t.constructor.hasOwnProperty(e)||Object.defineProperty(t.constructor,e,{value:r.slice()}),t.constructor[e].push(n)}function _(t,e){return(n,r)=>{y(n,"locations",{typeCtor:e,propertyKey:r,parameterIndex:null,index:t})}}const g=t=>(e,n,r)=>{y(e,"inputs",{inputCtor:t,propertyKey:n,parameterIndex:r})},b=t=>(e,n)=>{y(e,"uniforms",{typeCtor:t,propertyKey:n})},v=t=>(e,n)=>{y(e,"options",{typeCtor:t,propertyKey:n})},w=(t,e)=>{y(t,"defines",{propertyKey:e})};const T=(t,e)=>(n,r)=>{n.constructor.builtins.push({builtin:t,propertyKey:r,typeCtor:e})};class x{static{this.builtins=[]}}(0,r._)([T("gl_VertexID",o.Ai)],x.prototype,"glVertexID",void 0);class A{}class S{static{this.builtins=[]}}(0,r._)([T("gl_FragCoord",o.Zb)],S.prototype,"glFragCoord",void 0),(0,r._)([T("gl_PointCoord",o.ZY)],S.prototype,"glPointCoord",void 0);class E{}(0,r._)([(t=>(e,n)=>{y(e,"builtins",{builtin:t,propertyKey:n})})("gl_FragDepth")],E.prototype,"glFragDepth",void 0);class F{constructor(){this.type="uniform-group"}get _uniforms(){return this.constructor.uniforms??[]}}class ${constructor(){this.logShader=!1,this.computeAttributes={}}get vertexInput(){const t=this._shaderModuleClass.inputs.findLast((t=>"vertex"===t.propertyKey&&0===t.parameterIndex));if(!t)throw new Error("Unable to find vertex input parameter");return t}get computeInput(){return this._shaderModuleClass.inputs.findLast((t=>"vertex"===t.propertyKey&&1===t.parameterIndex))}get fragmentInput(){const t=this._shaderModuleClass.inputs.findLast((t=>"fragment"===t.propertyKey));if(!t)throw new Error("Unable to find fragment input parameter");return t}get transformFeedbackBindings(){return this.fragmentInput.inputCtor.transformFeedbackBindings??[]}get locations(){return[...this.vertexInput.inputCtor.locations,...this.computeInput?.inputCtor.locations??[]]}get locationsMap(){const t=new Map,e=new Set;for(const n of this.locations)e.has(n.index)?i.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.GraphShaderModule").warnOnce("mapview-rendering",`Unable to assigned attribute ${n.propertyKey} to ${n.index}. Index already in use`,{locationsMap:t}):(t.set(n.propertyKey,n.index),e.add(n.index));return t}get locationInfo(){if(!this._locationInfo){const t=this.locationsMap,e=Array.from(t.entries()).map((([t,e])=>`${t}.${e}`)).join("."),n=(0,s.Wm)(e),r=this.computeAttributes;this._locationInfo={hash:n,stringHash:e,locations:t,computeAttributeMap:r}}return this._locationInfo}get renamedLocationsMap(){const t=new Map;for(const e of this.locations)t.set("a_"+e.propertyKey,e.index);return t}get optionPropertyKeys(){if(!this._optionPropertyKeys){const t=new Set;for(const e of this._options)t.add(e.propertyKey);this._optionPropertyKeys=t}return this._optionPropertyKeys}get _shaderModuleClass(){return this.constructor}get _defines(){return this._shaderModuleClass.defines??[]}get _options(){return this._shaderModuleClass.options??[]}get _uniforms(){return this._shaderModuleClass.uniforms??[]}getProgram(t,e,n,r){try{const{vertex:i,fragment:s,uniformBindings:o}=this._generateShaders(t,e,n,r);return new p.K(i,s,this.renamedLocationsMap,this.locationInfo,o,this.transformFeedbackBindings)}catch(t){return new p.K("","",this.renamedLocationsMap,this.locationInfo,[],this.transformFeedbackBindings)}}getDebugUniformClassInfo(t){const e=this._options.find((e=>e.propertyKey===t));if(e)return{type:"option",className:e.typeCtor};const n=this._uniforms.find((e=>e.propertyKey===t));if(!n)throw new Error(`Unable to find uniform class type for property: ${t}`);return{type:"required",className:n.typeCtor}}getShaderKey(t,e,n,r){const i=Object.keys(t).map((e=>`${e}.${t[e]}`)).join("."),s=Object.keys(n).map((t=>`${t}.${n[t]}`)).join("."),o=Object.keys(r).map((t=>`${t}.${r[t]}`)).join("."),c=Object.keys(e).filter((t=>this.optionPropertyKeys.has(t)&&e[t])).join(".");return`${this.type}.${i}.${s}.${o}.${c}`}_generateShaders(t,e,n,r){const i=[];this._setDefines(n),this._setOptionalUniforms(i,e),this._setRequiredUniforms(i);const s=this._hydrateVertexInput(r),o=this._injectPackPrecisionFactor(s,t),c=this._hydrateComputeInput(),h=c&&this._injectComputePackPrecisionFactor(c,t),d=this.vertex(o,h),p=this._hydrateFragmentInput(d),f=this.fragment(p),m=new Set;for(const t in f){const e=f[t];(0,a.rz)(m,e)}const y=this._getVertexInputBuiltins(),_=l.createVertex({...s,...c},d,y,i,this.transformFeedbackBindings,m);(new u).write(_);const g=this._getFragmentInputBuiltins(f);g.set("glPointCoord","gl_PointCoord");const b=l.createFragment(p,f,g,i,_,this.transformFeedbackBindings);(new u).write(b);const v=this._createShaderBuilder(_,b),w=v.generate("vertex"),T=v.generate("fragment");return this.logShader,{vertex:w,fragment:T,uniformBindings:i}}_setDefines(t){for(const e in t)this[e]=t[e]}_setOptionalUniforms(t,e){for(const n of this._options)e[n.propertyKey]?this[n.propertyKey]=this._hydrateUniformGroup(t,n):this[n.propertyKey]=null}_setRequiredUniforms(t){for(const e of this._uniforms)this[e.propertyKey]=this._hydrateUniformGroup(t,e)}_hydrateUniformGroup(t,e){const n=new(0,e.typeCtor);for(const r of n._uniforms??[]){const i=m(r.typeCtor),s=`u_${e.propertyKey}_${r.propertyKey}`,o=i.type,c=[e.propertyKey,r.propertyKey].join(".");if("type"in r.typeCtor&&"array"===r.typeCtor.type){const e=i;t.push({shaderModulePath:c,uniformName:s,uniformType:o,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:i})}else if("type"in r.typeCtor&&"array-2d"===r.typeCtor.type){const e=i;t.push({shaderModulePath:c,uniformName:s,uniformType:o,uniformArrayLength:e.size,uniformArrayElementType:e.elementType.type,uniformHydrated:i})}else t.push({shaderModulePath:c,uniformName:s,uniformType:o,uniformHydrated:i});n[r.propertyKey]=i}return n}_hydrateVertexInput(t){const e=this.vertexInput.inputCtor,n=e.locations.reduce(((e,n)=>!1===t[n.propertyKey]?e:{...e,[n.propertyKey]:m(n.typeCtor)}),{});for(const{propertyKey:t,typeCtor:r}of e.builtins){const e=m(r);n[t]=e}return n}_hydrateComputeInput(){return null==this.computeInput?null:this.computeInput.inputCtor.locations.reduce(((t,e)=>({...t,[e.propertyKey]:m(e.typeCtor)})),{})}_injectPackPrecisionFactor(t,e){const n={};for(const r in t){const i=t[r],s=e[r];if(s){if("float"!==i.type&&"vec2"!==i.type&&"vec3"!==i.type&&"vec4"!==i.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${i.type}`);n[r]=i.divide(new o.nt(s))}else n[r]=i}return n}_injectComputePackPrecisionFactor(t,e){const n={},r=new Map;for(const t in this.computeAttributes)for(const e of this.computeAttributes[t]??[])r.set(e,t);for(const i in t){const s=t[i],c=r.get(i);if(!c)continue;const u=e[c];if(u){if("float"!==s.type&&"vec2"!==s.type&&"vec3"!==s.type&&"vec4"!==s.type)throw new Error(`InternalError: packPrecisionFactor requires GenType, but found ${s.type}`);n[i]=s.divide(new o.nt(u))}else n[i]=s}return n}_hydrateFragmentInput(t){const e={};for(const n in t)e[n]=t[n];for(const{propertyKey:t,typeCtor:n}of S.builtins){const r=m(n);e[t]=r}return e}_getVertexInputBuiltins(){const t=this.vertexInput.inputCtor,e=new Map;for(const{builtin:n,propertyKey:r}of t.builtins)e.set(r,n);return e}_getFragmentInputBuiltins(t){const e=t.constructor,n=new Map;for(const t of e.builtins??[])n.set(t.propertyKey,t.builtin);return n}_createShaderBuilder(t,e){const n=new f.N5;return this._insertDebugInfo(n),t.insertVertexShader(n),e.insertFragmentShader(n),n}_insertDebugInfo(t){t.vertex.code.add("// DEFINES: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._defines)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`);t.vertex.code.add(""),t.vertex.code.add("// OPTIONS: "),t.vertex.code.add("// --------------------------------------------------------- ");for(const e of this._options)this[e.propertyKey]?t.vertex.code.add(`//   ${e.propertyKey}: true`):t.vertex.code.add(`//   ${e.propertyKey}: false`)}}},15871:function(t,e,n){n.d(e,{$5:function(){return Tt},$I:function(){return V},$T:function(){return pe},AU:function(){return te},Ai:function(){return L},Bw:function(){return Ht},Cq:function(){return O},Ec:function(){return vt},F8:function(){return ie},FM:function(){return gt},Gb:function(){return lt},HQ:function(){return It},I8:function(){return Et},Io:function(){return jt},L0:function(){return se},LC:function(){return bt},LI:function(){return ne},MM:function(){return xt},Ml:function(){return ae},My:function(){return T},Ny:function(){return z},Om:function(){return zt},PM:function(){return ue},Qr:function(){return at},RI:function(){return Vt},RZ:function(){return ce},Rm:function(){return Xt},S8:function(){return Jt},Sj:function(){return ft},T9:function(){return qt},TF:function(){return oe},Tk:function(){return ot},U:function(){return K},US:function(){return le},Uo:function(){return Ft},Wh:function(){return H},Xe:function(){return wt},YN:function(){return Nt},ZY:function(){return E},Zb:function(){return $},Zc:function(){return Y},_S:function(){return re},_i:function(){return x},aX:function(){return At},eB:function(){return F},eR:function(){return q},fV:function(){return X},gn:function(){return Ot},hC:function(){return _t},j1:function(){return ct},jc:function(){return Gt},jh:function(){return Zt},jk:function(){return Wt},ln:function(){return W},lw:function(){return ut},mk:function(){return Ut},n7:function(){return ee},nP:function(){return de},nf:function(){return mt},nt:function(){return S},oN:function(){return Kt},om:function(){return st},or:function(){return St},p6:function(){return Yt},pu:function(){return yt},qE:function(){return Lt},qR:function(){return Dt},rY:function(){return Bt},rf:function(){return Pt},tn:function(){return $t},w0:function(){return Z},wH:function(){return pt},x:function(){return D},yH:function(){return Ct},yI:function(){return kt},ym:function(){return he},z7:function(){return A},ze:function(){return it},zi:function(){return Qt}});var r,i,s,o,c,u,a,h,d,l,p,f,m,y,_=n(82392),g=n(82484);function b(t){return new Proxy(t,{get(e,n){if("constructor"===n)return new Proxy(e.constructor,{construct:(t,e,n)=>b(new t(...e))});if(n in e)return e[n];if("string"==typeof n){const e=function(t){const e=[["float","vec2","vec3","vec4"],["int","ivec2","ivec3","ivec4"],["uint","uvec2","uvec3","uvec4"],["bool","bvec2","bvec3","bvec4"]];for(const n of e)if(n.includes(t))return n.map((t=>G[t]));throw new Error("Unable to find type family")}(t.type);return Q(t,n,e[n.length-1])}}})}function v(t){return new Proxy(t,{construct:(t,e,n)=>b(new t(...e))})}class w extends Error{}let T=class extends g.vL{static{r=this}static{this.type="array"}constructor(t,e){super(),this.elementType=t,this.size=e,this.children=[],this.type="array"}clone(){const t=new r(this.elementType,this.size);return super.cloneInto(t),t}get(t,e){const n=new L(t),r=null!=e?new L(e):null;return null!=r?J(this,n,r,function(t){switch(t.type){case"bool":case"bvec2":case"bvec3":case"bvec4":return D;case"float":case"vec2":case"vec3":case"vec4":return S;case"int":case"ivec2":case"ivec3":case"ivec4":return L;case"uint":case"uvec2":case"uvec3":case"uvec4":return I;default:throw new Error("Unable to handle type")}}(this.elementType.constructor)):Q(this,n,this.elementType.constructor)}last(){return this.get(this.size-1)}first(){return this.get(0)}findIndex(t,e,n){return function(t,e,n=0,r=t.size){const i=new L(n).setMutable().setDebugName("FindIndexIterator"),s=e(t.get(i)).setDebugName("FindIndexPredicate"),o=st({iter:i},L,s,(({out:t,iter:e,subgraph:n})=>`\n${t} = -1;\n\nfor (; ${e} < ${r}; ${e}++) {\n\n${n.body}\n\n  if (${n.varName}) {\n    ${t} = ${e};\n    break;\n  }\n\n}\n`)).setDebugName("FindIndexBlock");return o}(this,t,e,n)}glslFindIndex(t,e,n){return function(t,e,n=0,r=t.size){const i=st({array:t},L,null,(({out:t,array:i})=>`\n${t} = -1;\nfor (int i = ${n}; i < ${r}; i++) {\n  bool condition;\n  ${e({array:i,i:"i",out:"condition"})}\n  if (condition) {\n    ${t} = i;\n    break;\n  }\n}\n`)).setDebugName("GlslFindIndexBlock");return i}(this,t,e,n)}static ofType(t,e){const n={construct:(n,i)=>new r(new t,e)};return new Proxy(r,n)}};T=r=(0,_._)([function(t){return new Proxy(t,{construct:(t,e,n)=>function(t){return new Proxy(t,{get(e,n){if(n in e)return e[n];if("string"==typeof n){const e=parseInt(n,10);if(!isNaN(e))return Q(t,`[${e}]`,t.elementType.constructor)}}})}(new t(...e))})}],T);class x extends g.vL{static{this.type="array-2d"}constructor(t,e,n,r=!1){super(),this.elementType=t,this.xSize=e,this.ySize=n,this.isRowMajor=r,this.children=[],this.type="array-2d"}clone(){const t=new x(this.elementType,this.xSize,this.ySize,this.isRowMajor);return super.cloneInto(t),t}get size(){return this.xSize*this.ySize}get(t,e){return this.isRowMajor?this._getRowMajor(t,e):this._getColumnMajor(t,e)}_getColumnMajor(t,e){const n=new L(t);return Q(this,new L(e).add(n.multiply(this.xSize)),this.elementType.constructor)}_getRowMajor(t,e){const n=new L(t),r=new L(e);return Q(this,n.add(r.multiply(this.ySize)),this.elementType.constructor)}static ofType(t,e,n,r=!1){return new Proxy(T,{construct:(i,s)=>new x(new t,e,n,r)})}}class A extends g.vL{constructor(){super(...arguments),this.type="sampler2D",this.children=[]}static{this.type="sampler2D"}clone(){const t=new A;return t.children=this.children.map(g.vA),super.cloneInto(t),t}}class S extends g.vL{static{this.type="float"}constructor(t){super(),this.type="float",this.children=[t]}clone(){const t=new S((0,g.vA)(this.children[0]));return super.cloneInto(t),t}multiply(t){return ut(this,"number"==typeof t?P(t,S):t)}divide(t){return at(this,"number"==typeof t?P(t,S):t)}add(t){return ht(this,"number"==typeof t?P(t,S):t)}subtract(t){return dt(this,"number"==typeof t?P(t,S):t)}}let E=class extends g.vL{static{i=this}static{this.type="vec2"}constructor(t,e){super(),this.type="vec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new i((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}get 0(){return Q(this,"[0]",S)}get 1(){return Q(this,"[1]",S)}get 2(){throw new w}get 3(){throw new w}multiply(t){return ut(this,"number"==typeof t?P(t,S):t)}divide(t){return at(this,"number"==typeof t?P(t,S):t)}add(t){return ht(this,"number"==typeof t?P(t,S):t)}subtract(t){return dt(this,"number"==typeof t?P(t,S):t)}};E=i=(0,_._)([v],E);let F=class extends g.vL{static{s=this}static{this.type="vec3"}constructor(t,e,n){super(),this.type="vec3",this.children=[t,e,n].filter((t=>null!=t))}get 0(){return Q(this,"[0]",S)}get 1(){return Q(this,"[1]",S)}get 2(){return Q(this,"[2]",S)}get 3(){throw new w}clone(){const t=new s((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}multiply(t){return ut(this,"number"==typeof t?P(t,S):t)}divide(t){return at(this,"number"==typeof t?P(t,S):t)}add(t){return ht(this,"number"==typeof t?P(t,S):t)}subtract(t){return dt(this,"number"==typeof t?P(t,S):t)}};F=s=(0,_._)([v],F);let $=class extends g.vL{static{o=this}static{this.type="vec4"}constructor(t,e,n,r){super(),this.type="vec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new o((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}get 0(){return Q(this,"[0]",S)}get 1(){return Q(this,"[1]",S)}get 2(){return Q(this,"[2]",S)}get 3(){return Q(this,"[3]",S)}multiply(t){return ut(this,"number"==typeof t?P(t,S):t)}divide(t){return at(this,"number"==typeof t?P(t,S):t)}add(t){return ht(this,"number"==typeof t?P(t,S):t)}subtract(t){return dt(this,"number"==typeof t?P(t,S):t)}};$=o=(0,_._)([v],$);let I=class extends g.vL{static{c=this}static{this.type="uint"}constructor(t){super(),this.type="uint",this.children=[t]}clone(){const t=new c((0,g.vA)(this.children[0]));return super.cloneInto(t),t}};I=c=(0,_._)([v],I);let N=class extends g.vL{static{u=this}static{this.type="uvec2"}constructor(t,e){super(),this.type="uvec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new u((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};N=u=(0,_._)([v],N);let R=class extends g.vL{static{a=this}static{this.type="uvec3"}constructor(t,e,n){super(),this.type="uvec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new a((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};R=a=(0,_._)([v],R);let M=class extends g.vL{static{h=this}static{this.type="uvec4"}constructor(t,e,n,r){super(),this.type="uvec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new h((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};M=h=(0,_._)([v],M);class D extends g.vL{static{this.type="bool"}constructor(t){super(),this.type="bool",this.children=[t]}and(t){return Ft(this,t)}or(t){return St(this,t)}xor(t){return Et(this,t)}clone(){const t=new D((0,g.vA)(this.children[0]));return super.cloneInto(t),t}}let C=class extends g.vL{static{d=this}static{this.type="bvec2"}constructor(t,e){super(),this.type="bvec2",this.children=[t,e].filter((t=>null!=t))}all(){return Rt(this)}any(){return Mt(this)}clone(){const t=new d((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};C=d=(0,_._)([v],C);let B=class extends g.vL{static{l=this}static{this.type="bvec3"}constructor(t,e,n){super(),this.type="bvec3",this.children=[t,e,n].filter((t=>null!=t))}all(){return Rt(this)}any(){return Mt(this)}clone(){const t=new l((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};function P(t,e){return"number"==typeof t?new e(t):t}B=l=(0,_._)([v],B);let U=class extends g.vL{static{p=this}static{this.type="bvec4"}constructor(t,e,n,r){super(),this.type="bvec4",this.children=[t,e,n,r].filter((t=>null!=t))}all(){return Rt(this)}any(){return Mt(this)}clone(){const t=new p((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};U=p=(0,_._)([v],U);class L extends g.vL{static{this.type="int"}constructor(t){super(),this.type="int",this.children=[t]}multiply(t){return ut(this,P(t,L))}add(t){return ht(this,P(t,L))}subtract(t){return dt(this,P(t,L))}divide(t){return at(this,P(t,L))}clone(){const t=new L((0,g.vA)(this.children[0]));return super.cloneInto(t),t}}let O=class extends g.vL{static{f=this}static{this.type="ivec2"}constructor(t,e){super(),this.type="ivec2",this.children=[t,e].filter((t=>null!=t))}clone(){const t=new f((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]));return super.cloneInto(t),t}};O=f=(0,_._)([v],O);let k=class extends g.vL{static{m=this}static{this.type="ivec3"}constructor(t,e,n){super(),this.type="ivec3",this.children=[t,e,n].filter((t=>null!=t))}clone(){const t=new m((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]));return super.cloneInto(t),t}};k=m=(0,_._)([v],k);let j=class extends g.vL{static{y=this}static{this.type="ivec4"}constructor(t,e,n,r){super(),this.type="ivec4",this.children=[t,e,n,r].filter((t=>null!=t))}clone(){const t=new y((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}};j=y=(0,_._)([v],j);class z extends g.vL{static{this.type="mat2"}constructor(t,e,n,r){super(),this.type="mat2",this.children=[t,e,n,r]}clone(){const t=new z((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]));return super.cloneInto(t),t}get(t,e){return J(this,new L(t),new L(e),S)}multiply(t){return ut(this,t)}}class K extends g.vL{static{this.type="mat3"}static identity(){return new K(1,0,0,0,1,0,0,0,1)}static fromRotation(t){const e=ie(t),n=Ot(t);return new K(n,e,0,it(e),n,0,0,0,1)}constructor(t,e,n,r,i,s,o,c,u){super(),this.type="mat3",this.children=[t,e,n,r,i,s,o,c,u]}add(t){return ht(this,t)}multiply(t){return ut(this,t)}get(t,e){return J(this,new L(t),new L(e),S)}clone(){const t=new K((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]),(0,g.vA)(this.children[4]),(0,g.vA)(this.children[5]),(0,g.vA)(this.children[6]),(0,g.vA)(this.children[7]),(0,g.vA)(this.children[8]));return super.cloneInto(t),t}}class V extends g.vL{static{this.type="mat4"}static identity(){return new V(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)}constructor(t,e,n,r,i,s,o,c,u,a,h,d,l,p,f,m){super(),this.type="mat4",this.children=[t,e,n,r,i,s,o,c,u,a,h,d,l,p,f,m]}static fromColumns(t,e,n,r){return new V(t.x,t.y,t.z,t.w,e.x,e.y,e.z,e.w,n.x,n.y,n.z,n.w,r.x,r.y,r.z,r.w)}multiply(t){return ut(this,t)}get(t,e){return J(this,new L(t),new L(e),S)}clone(){const t=new V((0,g.vA)(this.children[0]),(0,g.vA)(this.children[1]),(0,g.vA)(this.children[2]),(0,g.vA)(this.children[3]),(0,g.vA)(this.children[4]),(0,g.vA)(this.children[5]),(0,g.vA)(this.children[6]),(0,g.vA)(this.children[7]),(0,g.vA)(this.children[8]),(0,g.vA)(this.children[9]),(0,g.vA)(this.children[10]),(0,g.vA)(this.children[11]),(0,g.vA)(this.children[12]),(0,g.vA)(this.children[13]),(0,g.vA)(this.children[14]),(0,g.vA)(this.children[15]));return super.cloneInto(t),t}}const G={float:S,vec2:E,vec3:F,vec4:$,int:L,ivec2:O,ivec3:k,ivec4:j,uint:I,uvec2:N,uvec3:R,uvec4:M,bool:D,bvec2:C,bvec3:B,bvec4:U},H=(...t)=>new L(...t),X=(...t)=>new S(...t),Y=(...t)=>new E(...t),q=(...t)=>new F(...t),W=(...t)=>new $(...t),Z=(...t)=>new K(...t);function Q(t,e,n){const r=new n(new g.zg(e,t,n));return r.isImplicit=!0,r}function J(t,e,n,r){const i=new r(new g.ff(e,n,t,r));return i.isImplicit=!0,i}function tt(t,e,n,r=null){if(r){const i=new r,s=new r(new g.aw(t,[e,n],!0,!1,i));return s.isImplicit=!0,s}if("float"===e.type||"int"===e.type){const r=new n.constructor(new g.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}if(("mat2"===e.type||"mat3"===e.type||"mat4"===e.type)&&"float"!==n.type){const r=new n.constructor(new g.aw(t,[e,n],!0,!1,n.constructor));return r.isImplicit=!0,r}const i=new e.constructor(new g.aw(t,[e,n],!0,!1,e.constructor));return i.isImplicit=!0,i}function et(t,e,n=e.constructor){const r=new n(new g.aw(t,[e],!1,!1,n));return r.isImplicit=!0,r}function nt(t,e,n,r=e.constructor){const i=new r(new g.aw(t,[e,n],!1,!1,r));return i.isImplicit=!0,i}function rt(t,e,n,r,i=e.constructor){const s=new i(new g.aw(t,[e,n,r],!1,!1,i));return s.isImplicit=!0,s}function it(t){return ut(t,X(-1))}function st(t,e,n,r){return new e(new g.rR(t,e,n,r))}function ot(t,e,n){const r="function"==typeof e?e():e,i="function"==typeof n?n():n,s=new r.constructor(new g.XL(t,r,i));return s.isImplicit=!0,s}function ct(...t){const e=t.map((([t,e])=>"function"==typeof e?[t,e()]:[t,e])),n=e[0][1].constructor,r=e.findIndex((t=>!0===t[0]));if(-1===r)throw new Error("A cond must have a fallthrough case with `true`/; ");const i=e.slice(0,r),s=e[r][1],o=new n(i.reduceRight(((t,e)=>ot(e[0],e[1],t)),s));return o.isImplicit=!0,o}function ut(t,e){return tt("*",t,e)}function at(t,e){return tt("/",t,e)}function ht(t,e){return tt("+",t,e)}function dt(t,e){return tt("-",t,e)}function lt(t,e){return tt("%",t,e)}function pt(t,e){return tt("<<",t,e)}function ft(t,e){return tt(">>",t,e)}function mt(t,e){return tt("&",t,e)}function yt(t,e){return tt("|",t,e)}function _t(t,e){return tt("^",t,e)}function gt(t){return et("~",t)}function bt(t,e){return tt("==",t,e,D)}function vt(t,e){return tt("!=",t,e,D)}function wt(t,e){return tt("<",t,e,D)}function Tt(t,e){return tt("<=",t,e,D)}function xt(t,e){return tt(">",t,e,D)}function At(t,e){return tt(">=",t,e,D)}function St(...t){return t.length<=1?t[0]:t.slice(1).reduce(((t,e)=>function(t,e){return tt("||",t,e,D)}(t,e)),t[0])}function Et(...t){return t.length<=1?t[0]:t.slice(1).reduce(((t,e)=>function(t,e){return tt("^^",t,e,D)}(t,e)),t[0])}function Ft(...t){return t.length<=1?t[0]:t.slice(1).reduce(((t,e)=>function(t,e){return tt("&&",t,e,D)}(t,e)),t[0])}function $t(t){return et("abs",t)}function It(t){return et("acos",t)}function Nt(t){return et("acosh",t)}function Rt(t){return et("all",t,D)}function Mt(t){return et("any",t,D)}function Dt(t){return et("asin",t)}function Ct(t){return et("asinh",t)}function Bt(t,e){return null==e?et("atan",t):nt("atan",t,e,t.constructor)}function Pt(t){return et("atanh",t)}function Ut(t){return et("ceil",t)}function Lt(t,e,n){return rt("clamp",t,e,n,t.constructor)}function Ot(t){return et("cos",t)}function kt(t){return et("cosh",t)}function jt(t,e){return nt("distance",t,e,S)}function zt(t,e){return nt("dot",t,e,S)}function Kt(t){return et("exp",t)}function Vt(t){return et("floor",t)}function Gt(t){return et("fract",t)}function Ht(t){return et("length",t,S)}function Xt(t){return et("log",t)}function Yt(t){return et("log2",t)}function qt(t,e){return nt("max",t,e)}function Wt(t,e){return nt("min",t,e)}function Zt(t,e,n){return rt("mix",t,e,n)}function Qt(t,e){return nt("mod",t,e)}function Jt(t){return et("normalize",t)}function te(t){return"bool"===t.type?et("!",t):et("not",t)}function ee(t,e){return nt("pow",t,e)}function ne(t){return et("round",t)}function re(t){return et("sign",t)}function ie(t){return et("sin",t)}function se(t){return et("sinh",t)}function oe(t,e,n){return rt("smoothstep",t,e,n)}function ce(t){return et("sqrt",t)}function ue(t,e){return nt("step",t,e,e.constructor)}function ae(t){return et("tan",t)}function he(t){return et("tanh",t)}function de(t,e,n){return rt("texelFetch",t,e,n,$)}function le(t,e){return nt("texture",t,e,$)}function pe(t,e){const{initialValue:n,xRange:r,yRange:i,callback:s}=e,[o,c]=r,[u,a]=i,h=new L(0).setMutable().setDebugName("iterX"),d=new L(0).setMutable().setDebugName("iterY"),l=n.setMutable().setDebugName("accumulator"),p=s(l,t.get(h,d),h,d).setDebugName("callback"),f=st({iterX:h,iterY:d,accumulator:l},n.constructor,p,(({out:t,iterX:e,iterY:n,accumulator:r,subgraph:i})=>`\nfor (${n} = ${u}; ${n} < ${a}; ${n}++) {\n  for (${e} = ${o}; ${e} < ${c}; ${e}++) {\n\n  ${i.body}\n\n  ${r} = ${i.varName};\n  }\n}\n${t} = ${r};\n`)).setDebugName("reduce2DBody");return f}},41820:function(t,e,n){var r,i;n.d(e,{N:function(){return r},Y:function(){return i}}),function(t){t[t.AnimatedFill=0]="AnimatedFill",t[t.AnimatedLine=1]="AnimatedLine",t[t.AnimatedMarker=2]="AnimatedMarker",t[t.AnimatedMarkerShift=3]="AnimatedMarkerShift",t[t.Bitmap=4]="Bitmap",t[t.Blend=5]="Blend",t[t.ComplexFill=6]="ComplexFill",t[t.ComplexOutlineFill=7]="ComplexOutlineFill",t[t.DotDensity=8]="DotDensity",t[t.Fill=9]="Fill",t[t.GradientFill=10]="GradientFill",t[t.GradientStroke=11]="GradientStroke",t[t.Grid=12]="Grid",t[t.Heatmap=13]="Heatmap",t[t.Label=14]="Label",t[t.Line=15]="Line",t[t.Magnifier=16]="Magnifier",t[t.Marker=17]="Marker",t[t.OutlineFill=18]="OutlineFill",t[t.Overlay=19]="Overlay",t[t.PatternFill=20]="PatternFill",t[t.PatternOutlineFill=21]="PatternOutlineFill",t[t.PieChart=22]="PieChart",t[t.Test=23]="Test",t[t.Text=24]="Text",t[t.TexturedLine=25]="TexturedLine",t[t.VideoScreen=26]="VideoScreen"}(r||(r={})),function(t){t[t.RasterColorizer=0]="RasterColorizer",t[t.RasterProcessor=1]="RasterProcessor",t[t.Aspect=2]="Aspect",t[t.BandArithmetic=3]="BandArithmetic",t[t.ColormapToRGB=4]="ColormapToRGB",t[t.CompositeBand=5]="CompositeBand",t[t.ComputeChange=6]="ComputeChange",t[t.ContrastBrightness=7]="ContrastBrightness",t[t.Convolution=8]="Convolution",t[t.Curvature=9]="Curvature",t[t.ExtractBand=10]="ExtractBand",t[t.Grayscale=11]="Grayscale",t[t.Hillshade=12]="Hillshade",t[t.Local=13]="Local",t[t.Mask=14]="Mask",t[t.NDVI=15]="NDVI",t[t.Remap=16]="Remap",t[t.Reproject=17]="Reproject",t[t.ShadedRelief=18]="ShadedRelief",t[t.Slope=19]="Slope",t[t.Statistics=20]="Statistics",t[t.Stretch=21]="Stretch"}(i||(i={}))},43398:function(t,e,n){n.d(e,{N5:function(){return u}});var r=n(62991),i=(n(6273),n(80861)),s=n(78455);const o=()=>i.A.getLogger("esri.views.3d.webgl-engine.core.shaderModules.shaderBuilder");class c{constructor(){this._includedModules=new Map}include(t,e){this._includedModules.has(t)?this._includedModules.get(t):(this._includedModules.set(t,e),t(this.builder,e))}}class u extends c{constructor(){super(...arguments),this.vertex=new l,this.fragment=new l,this.attributes=new p,this.varyings=new f,this.extensions=new m,this.outputs=new y}get fragmentUniforms(){return this.fragment.uniforms.entries}get builder(){return this}generate(t,e=!1){const n=this.extensions.generateSource(t),r=this.attributes.generateSource(t),i=this.varyings.generateSource(t),s="vertex"===t?this.vertex:this.fragment,o=s.uniforms.generateSource(),c=s.code.generateSource(),u=s.main.generateSource(e),a="vertex"===t?b:g,h=s.constants.generateSource(),d=this.outputs.generateSource(t);return`#version 300 es\n${n.join("\n")}\n${a}\n${h.join("\n")}\n${o.join("\n")}\n${r.join("\n")}\n${i.join("\n")}\n${d.join("\n")}\n${c.join("\n")}\n${u.join("\n")}`}generateBind(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Bind];n&&e.set(t.name,n)})),this.fragment.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Bind];n&&e.set(t.name,n)}));const n=Array.from(e.values()),r=n.length;return e=>{for(let i=0;i<r;++i)n[i](t,e)}}generateBindPass(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Pass];n&&e.set(t.name,n)})),this.fragment.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Pass];n&&e.set(t.name,n)}));const n=Array.from(e.values()),r=n.length;return(e,i)=>{for(let s=0;s<r;++s)n[s](t,e,i)}}generateBindDraw(t){const e=new Map;this.vertex.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Draw];n&&e.set(t.name,n)})),this.fragment.uniforms.entries.forEach((t=>{const n=t.bind[s.c.Draw];n&&e.set(t.name,n)}));const n=Array.from(e.values()),r=n.length;return(e,i,s)=>{for(let o=0;o<r;++o)n[o](t,s,e,i)}}}class a{constructor(t){this._stage=t,this._entries=new Map}add(...t){for(const e of t)this._add(e);return this._stage}get(t){return this._entries.get(t)}_add(t){if(null!=t){if(this._entries.has(t.name)&&!this._entries.get(t.name).equals(t))throw new r.A("shaderbuilder:duplicate-uniform",`Duplicate uniform name ${t.name} for different uniform type`);this._entries.set(t.name,t)}else o().error(`Trying to add null Uniform from ${(new Error).stack}.`)}generateSource(){return Array.from(this._entries.values()).map((({name:t,arraySize:e,type:n})=>null!=e?`uniform ${n} ${t}[${e}];`:`uniform ${n} ${t};`))}get entries(){return Array.from(this._entries.values())}}class h{constructor(t){this._stage=t,this._bodies=new Array}add(t){return this._bodies.push(t),this._stage}generateSource(t){if(this._bodies.length>0)return[`void main() {\n ${this._bodies.join("\n")||""} \n}`];if(t)throw new r.A("shaderbuilder:missing-main","Shader does not contain main function body.");return[]}}class d{constructor(t){this._stage=t,this._entries=new Array}add(t){return this._entries.push(t),this._stage}generateSource(){return this._entries}}class l extends c{constructor(){super(...arguments),this.uniforms=new a(this),this.main=new h(this),this.code=new d(this),this.constants=new _(this)}get builder(){return this}}class p{constructor(){this._entries=new Array}add(t,e){this._entries.push([t,e])}generateSource(t){return"fragment"===t?[]:this._entries.map((t=>`in ${t[1]} ${t[0]};`))}}class f{constructor(){this._entries=new Map}add(t,e,n){this._entries.has(t)?o().warn(`Ignoring duplicate varying ${e} ${t}`):this._entries.set(t,{type:e,invariant:n?.invariant??!1})}generateSource(t){const e=new Array;return this._entries.forEach(((n,r)=>e.push((n.invariant&&"vertex"===t?"invariant ":"")+("vertex"===t?"out":"in")+` ${n.type} ${r};`))),e}}class m{constructor(){this._entries=new Set}add(t){this._entries.add(t)}generateSource(t){const e="vertex"===t?m.ALLOWLIST_VERTEX:m.ALLOWLIST_FRAGMENT;return Array.from(this._entries).filter((t=>e.includes(t))).map((t=>`#extension ${t} : enable`))}static{this.ALLOWLIST_FRAGMENT=["GL_EXT_shader_texture_lod","GL_OES_standard_derivatives"]}static{this.ALLOWLIST_VERTEX=[]}}class y{constructor(){this._entries=new Map}add(t,e,n=0){const r=this._entries.get(n);r?.name!==t||r?.type!==e?this._entries.set(n,{name:t,type:e}):o().warn(`Fragment shader output location ${n} occupied`)}static{this.DEFAULT_TYPE="vec4"}static{this.DEFAULT_NAME="fragColor"}generateSource(t){if("vertex"===t)return[];0===this._entries.size&&this._entries.set(0,{name:y.DEFAULT_NAME,type:y.DEFAULT_TYPE});const e=new Array;return this._entries.forEach(((t,n)=>e.push(`layout(location = ${n}) out ${t.type} ${t.name};`))),e}}class _{constructor(t){this._stage=t,this._entries=new Set}add(t,e,n){let r="ERROR_CONSTRUCTOR_STRING";switch(e){case"float":r=_._numberToFloatStr(n);break;case"int":r=_._numberToIntStr(n);break;case"bool":r=n.toString();break;case"vec2":r=`vec2(${_._numberToFloatStr(n[0])},                            ${_._numberToFloatStr(n[1])})`;break;case"vec3":r=`vec3(${_._numberToFloatStr(n[0])},                            ${_._numberToFloatStr(n[1])},                            ${_._numberToFloatStr(n[2])})`;break;case"vec4":r=`vec4(${_._numberToFloatStr(n[0])},                            ${_._numberToFloatStr(n[1])},                            ${_._numberToFloatStr(n[2])},                            ${_._numberToFloatStr(n[3])})`;break;case"ivec2":r=`ivec2(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])})`;break;case"ivec3":r=`ivec3(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])},                             ${_._numberToIntStr(n[2])})`;break;case"ivec4":r=`ivec4(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])},                             ${_._numberToIntStr(n[2])},                             ${_._numberToIntStr(n[3])})`;break;case"uvec2":r=`uvec2(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])})`;break;case"uvec3":r=`uvec3(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])},                             ${_._numberToIntStr(n[2])})`;break;case"uvec4":r=`uvec4(${_._numberToIntStr(n[0])},                             ${_._numberToIntStr(n[1])},                             ${_._numberToIntStr(n[2])},                             ${_._numberToIntStr(n[3])})`;break;case"mat2":case"mat3":case"mat4":r=`${e}(${Array.prototype.map.call(n,(t=>_._numberToFloatStr(t))).join(", ")})`}return this._entries.add(`const ${e} ${t} = ${r};`),this._stage}static _numberToIntStr(t){return t.toFixed(0)}static _numberToFloatStr(t){return Number.isInteger(t)?t.toFixed(1):t.toString()}generateSource(){return Array.from(this._entries)}}const g="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n  precision highp int;\n  precision highp sampler2D;\n  precision highp usampler2D;\n  precision highp sampler2DArray;\n  precision highp sampler2DShadow;\n#else\n  precision mediump float;\n  precision mediump int;\n  precision mediump sampler2D;\n  precision mediump usampler2D;\n  precision mediump sampler2DArray;\n  precision mediump sampler2DShadow;\n#endif",b="precision highp float;\n precision highp sampler2D;\n precision highp usampler2D;\n precision highp sampler2DArray;\n precision highp sampler2DShadow;\n\n\n invariant gl_Position;\n "},44636:function(t,e,n){n.d(e,{K:function(){return d}});var r=n(62991),i=n(80861),s=n(21750),o=(n(6273),n(67498),n(63103),n(68716),n(49214),n(19980)),c=(n(36442),n(22497)),u=n(88416);function a(t,e,n){const r=new u.R(e.width,e.height);return r.dataType=e.dataType,e.depth&&(r.depth=e.depth),e.flipped&&(r.flipped=e.flipped),e.hasMipmap&&(r.hasMipmap=e.hasMipmap),r.internalFormat=e.internalFormat,e.isImmutable&&(r.isImmutable=e.isImmutable),e.isOpaque&&(r.isOpaque=e.isOpaque),e.maxAnisotropy&&(r.maxAnisotropy=e.maxAnisotropy),r.pixelFormat=e.pixelFormat,e.preMultiplyAlpha&&(r.preMultiplyAlpha=e.preMultiplyAlpha),e.samplingMode&&(r.samplingMode=e.samplingMode),e.target&&(r.target=e.target),r.uniform=e.uniform,e.unpackAlignment&&(r.unpackAlignment=e.unpackAlignment),e.wrapMode&&(r.wrapMode=e.wrapMode),new c.g(t,r,n)}function h(t,e,n){const s=e.length;if(s!==n){const o=new r.A("Invalid Uniform",`Invalid length, expected ${n} but got ${s}`,{uniformName:t,values:e});i.A.getLogger("esri.views.2d.engine.webgl.shaderGraph.typed.TypedShaderProgram").errorOnce(o)}}class d{constructor(t,e,n,r,i,s){this._program=null,this._vao=null,this._temporaryTextures=[],this.vertexShader=t,this.fragmentShader=e,this._locations=n,this._locationInfo=r,this._uniformBindings=i,this._transformFeedbackBindings=s}destroy(){this._program&&this._program.dispose(),this.cleanupTemporaryTextures()}get locations(){return this._locations}get locationInfo(){return this._locationInfo}setUniforms(t){this._uniforms=t}cleanupTemporaryTextures(){for(const t of this._temporaryTextures)t.dispose();this._temporaryTextures=[]}bind(t){const e=this._uniforms;if(!this._program){const e=new Map;for(const[t,n]of this._locations)e.set(t,n);const n=[];for(const t of this._transformFeedbackBindings??[]){const{index:e,propertyKey:r}=t;n[e]=`v_${r}`}this._program=new o.B(t,this.vertexShader,this.fragmentShader,e,new Map,n)}const n=this._program;t.useProgram(n);for(const r of this._uniformBindings){const{shaderModulePath:i,uniformName:o,uniformType:c,uniformArrayLength:u}=r,d=(0,s.wc)(i,e);if(null==d){if("sampler2D"===c)continue;throw new Error(`Failed to find uniform value for ${i}`)}switch("array"===c||"array-2d"===c?r.uniformArrayElementType:c){case"sampler2D":{const{unit:e,texture:r}=d;if(n.setUniform1i(o,e),"type"in r)t.bindTexture(r,e);else{const n=a(t,r.descriptor,r.data);t.bindTexture(n,e)}break}case"int":if(!u){n.setUniform1i(o,d);break}h(r.uniformName,d,u),n.setUniform1iv(o,d);break;case"float":if(!u){n.setUniform1f(o,d);break}h(r.uniformName,d,u),n.setUniform1fv(o,d);break;case"vec2":if(!u){n.setUniform2f(o,d[0],d[1]);break}h(r.uniformName,d,u),n.setUniform2fv(o,d.flat());break;case"vec3":if(!u){n.setUniform3f(o,d[0],d[1],d[2]);break}h(r.uniformName,d,u),n.setUniform3fv(o,d.flat());break;case"vec4":if(!u){n.setUniform4f(o,d[0],d[1],d[2],d[3]);break}h(r.uniformName,d,u),n.setUniform4fv(o,d.flat());break;case"mat3":n.setUniformMatrix3fv(o,d);break;case"mat4":n.setUniformMatrix4fv(o,d);break;default:throw new Error(`Unable to set uniform for type ${c}`)}}}}},49214:function(t,e,n){n.d(e,{H:function(){return d}});n(6273);var r=n(80861),i=n(57725),s=n(89325),o=n(63103),c=n(68716),u=n(36442),a=n(53386),h=n(22497);class d{constructor(t,e,n){if(this._context=t,this._glName=null,this._colorAttachments=new Map,this._depthStencilBuffer=null,this._depthStencilTexture=null,this._initialized=!1,t.instanceCounter.increment(c.vt.FramebufferObject,this),null!=e){const n=l(e)?e:new h.g(t,e);this._colorAttachments.set(c.r6,n),this._validateTextureDescriptor(n.descriptor),this._validateColorAttachmentPoint(c.r6)}if(null!=n)if(function(t){return l(t)||function(t){return p(t)===u.d.TextureDescriptor}(t)}(n))this._depthStencilTexture=l(n)?n:new h.g(t,n),this._validateTextureDescriptor(this._depthStencilTexture.descriptor);else{const e=function(t){return p(t)===u.d.Renderbuffer}(n)?n:new a.l(t,n);this._depthStencilBuffer=e,this._validateRenderbufferDescriptor(e.descriptor)}}dispose(){const{_colorAttachments:t,_glName:e}=this;if(0===t.size&&!this._depthStencilBuffer&&!this._depthStencilTexture&&!e)return;const{_context:n}=this,r=n.getBoundFramebufferObject();t.forEach(((t,e)=>this.detachColorTexture(e)?.dispose())),this.detachDepthStencilBuffer()?.dispose(),this.detachDepthStencilTexture()?.dispose(),n.gl.deleteFramebuffer(e),this._glName=null,n.bindFramebuffer(r===this?null:r),n.instanceCounter.decrement(c.vt.FramebufferObject,this)}get glName(){return this._glName}get colorTexture(){return this._colorAttachments.get(c.r6)}get depthStencil(){return this._depthStencilTexture||this._depthStencilBuffer}get depthStencilTexture(){return this._depthStencilTexture}get width(){const t=this._colorAttachments.get(c.r6)??this._depthStencilTexture??this._depthStencilBuffer;return t?.descriptor?.width??0}get height(){const t=this._colorAttachments.get(c.r6)??this._depthStencilTexture??this._depthStencilBuffer;return t?.descriptor?.height??0}get usedMemory(){return[...this._colorAttachments].reduce(((t,[e,n])=>t+n.usedMemory),this.depthStencil?.usedMemory??0)}static{this._MAX_COLOR_ATTACHMENTS=-1}getColorTexture(t){const e=this._colorAttachments.get(t);return e&&l(e)?e:null}get colorAttachments(){return[...this._colorAttachments.keys()]}attachColorTexture(t,e=c.r6){if(!t)return;this._validateColorAttachmentPoint(e);const{descriptor:n}=t;this._validateTextureDescriptor(n),this.detachColorTexture(e)?.dispose(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,e)),this._colorAttachments.set(e,t)}detachColorTexture(t=c.r6){const e=this._colorAttachments.get(t);if(e)return this._initialized&&this._context.temporaryBindFramebufferObject(this,(()=>{this._framebufferTexture2D(null,t)})),this._colorAttachments.delete(t),e}setColorTextureTarget(t,e=c.r6,n=0){const r=this._colorAttachments.get(e);r&&(t===c.Ap.TEXTURE_2D_ARRAY?this._framebufferTextureLayer(r.glName,e,c.R.FRAMEBUFFER,0,n):this._framebufferTexture2D(r.glName,e,t,c.R.FRAMEBUFFER,0))}attachDepthStencil(t){if(t)switch(t.type){case u.d.Texture:return this._attachDepthStencilTexture(t);case u.d.Renderbuffer:return this._attachDepthStencilBuffer(t)}}_attachDepthStencilTexture(t){if(null==t)return;const{descriptor:e}=t,{pixelFormat:n,dataType:r}=e;(n===c.j7.DEPTH_STENCIL||n===c.j7.DEPTH_COMPONENT)&&!(n===c.j7.DEPTH_STENCIL&&r!==c.ld.UNSIGNED_INT_24_8||n===c.j7.DEPTH_COMPONENT&&r!==c.ld.UNSIGNED_INT&&r!==c.ld.UNSIGNED_SHORT)&&(this._validateTextureDescriptor(e),this._disposeDepthStencilAttachments(),this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(t.glName,y(n))),this._depthStencilTexture?.dispose(),this._depthStencilTexture=t)}detachDepthStencilTexture(){const t=this._depthStencilTexture;return t&&this._initialized&&this._context.temporaryBindFramebufferObject(this,(()=>{this._framebufferTexture2D(null,y(t.descriptor.pixelFormat))})),this._depthStencilTexture=null,t}_attachDepthStencilBuffer(t){if(null==t)return;const e=t.descriptor;if(this._validateRenderbufferDescriptor(e),this._disposeDepthStencilAttachments(),this._initialized){this._context.bindFramebuffer(this);const{gl:n}=this._context,r=this._getGLAttachmentPoint(e);n.framebufferRenderbuffer(c.R.FRAMEBUFFER,r,n.RENDERBUFFER,t.glName)}this._depthStencilBuffer=t}detachDepthStencilBuffer(){const t=this._depthStencilBuffer;if(t&&this._initialized){const{_context:e}=this,n=e.getBoundFramebufferObject();e.bindFramebuffer(this);const{gl:r}=e,i=this._getGLAttachmentPoint(t.descriptor);r.framebufferRenderbuffer(c.R.FRAMEBUFFER,i,r.RENDERBUFFER,null),e.bindFramebuffer(n)}return this._depthStencilBuffer=null,t}invalidateAttachments(t){const{_context:e}=this;e.temporaryBindFramebufferObject(this,(()=>e.gl.invalidateFramebuffer(c.R.FRAMEBUFFER,t)),!0)}copyToTexture(t,e,n,r,i,s,o){const u=o.descriptor;o.descriptor.target,c.Ap.TEXTURE_2D,null==u?.width||null==u?.height||t+n>this.width||e+r>this.height||i+n>u.width||u.height;const a=this._context,d=a.bindTexture(o,h.g.TEXTURE_UNIT_FOR_UPDATES);a.setActiveTexture(h.g.TEXTURE_UNIT_FOR_UPDATES),a.bindFramebuffer(this),a.gl.copyTexSubImage2D(c.Ap.TEXTURE_2D,0,i,s,t,e,n,r),a.bindTexture(d,h.g.TEXTURE_UNIT_FOR_UPDATES)}readPixels(t,e,n,r,i,s,o){this._context.bindFramebuffer(this),this._context.gl.readPixels(t,e,n,r,i,s,o)}async readPixelsAsync(t,e,n,r,i,o,u){const{gl:a}=this._context,h=s.g.createPixelPack(this._context,c._U.STREAM_READ,u.byteLength);this._context.bindBuffer(h);const d=this._context.getBoundFramebufferObject();this._context.bindFramebuffer(this),a.readPixels(t,e,n,r,i,o,0),this._context.unbindBuffer(c.NZ.PIXEL_PACK_BUFFER),this._context.bindFramebuffer(d),await h.getSubDataAsync(u),h.dispose()}resize(t,e){if(this.width===t&&this.height===e)return;const n={width:t,height:e};f(n,this._context.parameters.maxTextureSize),this._colorAttachments.forEach((t=>t.resize(n.width,n.height))),this._depthStencilTexture?.resize(n.width,n.height),this._initialized&&(f(n,this._context.parameters.maxRenderbufferSize),this._depthStencilBuffer?.resize(n.width,n.height),this._context.getBoundFramebufferObject()===this&&this._context.bindFramebuffer(null),this._initialized=!1)}initializeAndBind(t=c.R.FRAMEBUFFER){const{gl:e}=this._context;if(this._initialized)return void e.bindFramebuffer(t,this.glName);this._glName&&e.deleteFramebuffer(this._glName);const n=e.createFramebuffer();if(e.bindFramebuffer(t,n),this._colorAttachments.forEach(((e,n)=>{const r=m(e);r===c.Ap.TEXTURE_2D_ARRAY?this._framebufferTextureLayer(e.glName,n,t,0,0):this._framebufferTexture2D(e.glName,n,r,t)})),this._depthStencilBuffer){const n=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);e.framebufferRenderbuffer(t,n,e.RENDERBUFFER,this._depthStencilBuffer.glName)}else if(this._depthStencilTexture){const e=y(this._depthStencilTexture.descriptor.pixelFormat);this._framebufferTexture2D(this._depthStencilTexture.glName,e,m(this._depthStencilTexture),t)}(0,o.en)()&&(e.checkFramebufferStatus(t),e.FRAMEBUFFER_COMPLETE),this._glName=n,this._initialized=!0}_framebufferTexture2D(t,e=c.r6,n=c.Ap.TEXTURE_2D,r=c.R.FRAMEBUFFER,i=0){this._context.gl.framebufferTexture2D(r,e,n,t,i)}_framebufferTextureLayer(t,e=c.r6,n=c.R.FRAMEBUFFER,r=0,i=0){this._context.gl.framebufferTextureLayer(n,e,t,r,i)}_disposeDepthStencilAttachments(){const t=this._context.gl;if(this._depthStencilBuffer){if(this._initialized){this._context.bindFramebuffer(this);const e=this._getGLAttachmentPoint(this._depthStencilBuffer.descriptor);t.framebufferRenderbuffer(c.R.FRAMEBUFFER,e,t.RENDERBUFFER,null)}this._depthStencilBuffer=(0,i.WD)(this._depthStencilBuffer)}this._depthStencilTexture&&(this._initialized&&(this._context.bindFramebuffer(this),this._framebufferTexture2D(null,y(this._depthStencilTexture.descriptor.pixelFormat))),this._depthStencilTexture=(0,i.WD)(this._depthStencilTexture))}_validateTextureDescriptor(t){t.target!==c.Ap.TEXTURE_2D&&t.target!==c.Ap.TEXTURE_CUBE_MAP&&(t.target,c.Ap.TEXTURE_2D_ARRAY),f(t,this._context.parameters.maxTextureSize),this._validateBufferDimensions(t)}_validateRenderbufferDescriptor(t){f(t,this._context.parameters.maxRenderbufferSize),this._validateBufferDimensions(t)}_validateBufferDimensions(t){t.width<=0&&(t.width=this.width),t.height<=0&&(t.height=this.height),this.width>0&&this.height>0&&this.width===t.width&&(this.height,t.height)}_getGLAttachmentPoint(t){switch(t.internalFormat){case c.SB.DEPTH_COMPONENT16:case c.SB.DEPTH_COMPONENT24:case c.SB.DEPTH_COMPONENT32F:return c.xL;case c.iE.DEPTH24_STENCIL8:case c.iE.DEPTH32F_STENCIL8:return c.nI;case c.Xo.STENCIL_INDEX8:return c.uH}}_validateColorAttachmentPoint(t){if(-1===d._MAX_COLOR_ATTACHMENTS){const{gl:t}=this._context;d._MAX_COLOR_ATTACHMENTS=t.getParameter(t.MAX_COLOR_ATTACHMENTS)}const e=t-c.r6;e+1>d._MAX_COLOR_ATTACHMENTS&&r.A.getLogger("esri.views.webgl.FrameBufferObject").error("esri.FrameBufferObject",`illegal attachment point for color attachment: ${e+1}. Implementation supports up to ${d._MAX_COLOR_ATTACHMENTS} color attachments`)}}function l(t){return p(t)===u.d.Texture}function p(t){return null!=t&&"type"in t?t.type:null}function f(t,e){const n=Math.max(t.width,t.height);if(n>e){r.A.getLogger("esri.views.webgl.FramebufferObject").warnOnce(`Resizing FBO attachment size ${t.width}x${t.height} to device limit ${e}`);const i=e/n;return t.width=Math.round(t.width*i),t.height=Math.round(t.height*i),!1}return!0}function m(t){return t.descriptor.target===c.Ap.TEXTURE_CUBE_MAP?c.Ap.TEXTURE_CUBE_MAP_POSITIVE_X:t.descriptor.target===c.Ap.TEXTURE_2D_ARRAY?c.Ap.TEXTURE_2D_ARRAY:c.Ap.TEXTURE_2D}function y(t){return t===c.j7.DEPTH_COMPONENT?c.xL:c.nI}},53386:function(t,e,n){n.d(e,{l:function(){return o}});var r=n(68716),i=n(36442),s=n(85939);class o{constructor(t,e){this._context=t,this._descriptor=e,this.type=i.d.Renderbuffer,this._context.instanceCounter.increment(r.vt.Renderbuffer,this);const n=this._context.gl;this.glName=n.createRenderbuffer(),this._context.bindRenderbuffer(this);const{width:s,height:o,internalFormat:c,multisampled:u}=e;u?n.renderbufferStorageMultisample(n.RENDERBUFFER,this.samples,c,s,o):n.renderbufferStorage(n.RENDERBUFFER,c,s,o),this._context.bindRenderbuffer(null)}get descriptor(){return this._descriptor}get samples(){const t=this._descriptor.samples,e=this._context.parameters.maxSamples;return t?Math.min(t,e):e}get usedMemory(){return(0,s.e)(this._descriptor)}resize(t,e){const n=this._descriptor;if(n.width===t&&n.height===e)return;n.width=t,n.height=e;const r=this._context.gl;this._context.bindRenderbuffer(this),n.multisampled?r.renderbufferStorageMultisample(r.RENDERBUFFER,this.samples,n.internalFormat,n.width,n.height):r.renderbufferStorage(r.RENDERBUFFER,n.internalFormat,n.width,n.height),this._context.bindRenderbuffer(null)}dispose(){this._context&&(this._context.gl.deleteRenderbuffer(this.glName),this._context.instanceCounter.decrement(r.vt.Renderbuffer,this),this._context=null)}}},53764:function(t,e,n){n.d(e,{j:function(){return i}});var r=n(57122);class i{constructor(){this.drawPhase=r.S5.MAP|r.S5.HITTEST|r.S5.HIGHLIGHT|r.S5.DEBUG}startup(){}shutdown(t){}}},78455:function(t,e,n){var r;n.d(e,{c:function(){return r}}),function(t){t[t.Bind=0]="Bind",t[t.Pass=1]="Pass",t[t.Draw=2]="Draw"}(r||(r={}))},82484:function(t,e,n){function r(t,e){const n=[];for(n.push(e);n.length;){const e=n.pop();if("object"==typeof e&&!t.has(e.uid)){t.add(e.uid);for(const t of e.children)n.push(t)}}}n.d(e,{Cc:function(){return c},XL:function(){return h},aw:function(){return l},ff:function(){return a},rR:function(){return d},rz:function(){return r},vA:function(){return s},vL:function(){return o},zg:function(){return u}});class i{constructor(){this.uid=i.NodeCount++,this._debugName=null,this._isMutable=!1,this.isImplicit=!1}static{this.NodeCount=0}get isMutable(){return this._isMutable}setMutable(){return this._isMutable=!0,this}setDebugName(t){return t=function(t){return t.split(" ").map(((t,e)=>e>0?t.charAt(0).toUpperCase()+t.slice(1):t)).join("")}(t),this._debugName=t,this.isImplicit&&this.children[0]instanceof i&&this.children[0].setDebugName(t),this}get debugInfo(){return{name:this._debugName??""}}cloneInto(t){t._debugName=this._debugName,t._isMutable=this._isMutable,t.isImplicit=this.isImplicit,t.uid=this.uid}}function s(t){return"object"==typeof t?t.clone():t}class o extends i{constructor(){super(...arguments),this.shaderType="primitive-node"}}class c extends i{constructor(t){super(),this.child=t,this.shaderType="scope-node"}get children(){return[this.child]}clone(){const t=new c(s(this.child));return this.cloneInto(t),t}}class u extends i{constructor(t,e,n){super(),this.property=t,this.target=e,this.returnType=n,this.shaderType="property-access-node"}get children(){const t=[this.target];return"string"!=typeof this.property&&t.push(this.property),t}clone(){const t=new u(this.property,s(this.target),this.returnType);return this.cloneInto(t),t}}class a extends i{constructor(t,e,n,r){super(),this.x=t,this.y=e,this.target=n,this.returnType=r,this.shaderType="property-access-2d-node"}get children(){return[this.target,this.x,this.y]}clone(){const t=new a(this.x,this.y,s(this.target),this.returnType);return this.cloneInto(t),t}}class h extends i{constructor(t,e,n){super(),this.condition=t,this.ifTrue=e,this.ifFalse=n,this.shaderType="condition-node"}get children(){return[this.condition,this.ifTrue,this.ifFalse]}clone(){const t=s(this.ifTrue),e=this.ifFalse?s(this.ifFalse):null,n=new h(this.condition,t,e);return this.cloneInto(n),n}}class d extends i{constructor(t,e,n,r){super(),this.captureList=t,this.returnType=e,this.generator=r,this.shaderType="block-node",n&&(this.subgraph=new c(n))}get children(){return Object.keys(this.captureList).map((t=>this.captureList[t])).concat(this.subgraph??[])}clone(){const t={};for(const e in this.captureList)t[e]=s(this.captureList[e]);const e=new d(t,this.returnType,this.subgraph?s(this.subgraph.child):this.subgraph,this.generator);return this.cloneInto(e),e}}class l extends i{constructor(t,e,n,r,i,s=!1){super(),this.token=t,this._children=e,this.isInfix=n,this.isPropertyAccess=r,this.returnType=i,this.isTernary=s,this.shaderType="function-node"}get children(){return this._children}clone(){const t=new l(this.token,this._children.map(s),this.isInfix,this.isPropertyAccess,this.returnType,this.isTernary);return this.cloneInto(t),t}}},85939:function(t,e,n){n.d(e,{e:function(){return s},q:function(){return i}});var r=n(73360);class i{constructor(t,e=0,n=e){this.internalFormat=t,this.width=e,this.height=n,this.multisampled=!1,this.samples=1}}function s(t){return t.width<=0||t.height<=0||null==t.internalFormat?0:t.width*t.height*(0,r.IB)(t.internalFormat)}}}]);